import{j as e,r as f,R as Oe}from"./index-CKmtg2Kd.js";import{u as O,a as G,b as Y,c as Ge,C as Ue}from"./Canvas-B9SZncmZ.js";import{s as I,r as M,d as W,a as Ze}from"./PasswordGate-Bi-1MXrx.js";const me=t=>t.trim()?t.split(`
`).filter(s=>s.trim()!=="").map(s=>s.split("	")):[],be=["#000000","#ffffff","#cccccc","#ff0000","#00ff00","#0000ff","#ffff00","#ff00ff","#00ffff","#ffa500","#800080"],Je=[{id:"select",label:"선택",icon:"👆"},{id:"text",label:"텍스트",icon:"📝"},{id:"checkbox",label:"체크",icon:"☑️"},{id:"image",label:"이미지",icon:"🖼️"},{id:"pen",label:"필기",icon:"✏️"},{id:"eraser",label:"지우개",icon:"🧽"}],H=t=>t&&typeof t.hasCheckbox<"u",Ve=t=>t&&typeof t.src<"u",Xe=t=>t&&"cellType"in t&&t.cellType==="cell",ue=(t,l)=>{var s,r,o;if(!t||!H(t))return"#000000";switch(l){case"text":return((s=t.textStyle)==null?void 0:s.color)||"#000000";case"background":return((r=t.boxStyle)==null?void 0:r.backgroundColor)||"transparent";case"border":return((o=t.boxStyle)==null?void 0:o.borderColor)||"#000000";default:return"#000000"}},_e=(t,l)=>{const s=[...t,...l];return Math.max(...s.map(r=>r.zIndex||0))},Ke=(t,l)=>{const s=[...t,...l];return Math.min(...s.map(r=>r.zIndex||0))},Ye=(t,l,s)=>{const o=[...l,...s].filter(d=>(d.zIndex||0)>t);return o.length===0?null:Math.min(...o.map(d=>d.zIndex||0))},qe=(t,l,s)=>{const o=[...l,...s].filter(d=>(d.zIndex||0)<t);return o.length===0?null:Math.max(...o.map(d=>d.zIndex||0))},ge=t=>{const l=me(t);if(l.length===0)return{rows:0,cols:0};const s=l.length,r=Math.max(...l.map(o=>o.length));return{rows:s,cols:r}},Qe=t=>t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable||t.closest("input, textarea, [contenteditable]")!==null,et=t=>t.hasAttribute("data-canvas-container")||t.tabIndex===0&&t.tagName==="DIV",tt=({currentTool:t,onToolSelect:l,onCreateText:s,onCreateCheckbox:r,onCreateImage:o})=>{const d=x=>{switch(x){case"select":l("select");break;case"text":s();break;case"checkbox":r();break;case"image":o();break;case"pen":case"eraser":l(x);break}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"⚡"})," 메인 도구"]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Je.map(x=>e.jsxs("button",{onClick:()=>d(x.id),className:`p-3 rounded-lg flex flex-col items-center gap-1 transition-all duration-200 border-2
              ${t===x.id?"bg-blue-500 text-white border-blue-600 shadow-lg scale-105":"bg-slate-50 hover:bg-slate-100 text-slate-700 border-slate-200 hover:border-slate-300"}`,children:[e.jsx("span",{className:"text-2xl",children:x.icon}),e.jsx("span",{className:"text-xs font-medium",children:x.label})]},x.id))})]})},st=({isExpanded:t,onToggle:l,excelPasteData:s,showPreview:r,safeSettings:o,onDataChange:d,onPreviewToggle:x,onCreateCells:j,onDeleteCellGroups:v,updateSettings:g})=>{const m=ge(s),n=i=>{d(i);const a=new CustomEvent("excel-preview-update",{detail:{data:i,show:!!i.trim()}});window.dispatchEvent(a)};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("button",{onClick:l,className:"w-full p-4 flex items-center justify-between text-sm font-bold text-slate-700 hover:bg-slate-50 rounded-t-xl transition-colors",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"📊"})," 엑셀 데이터 입력"]}),e.jsx("span",{className:`text-slate-400 transition-transform duration-200 ${t?"rotate-180":""}`,children:"▼"})]}),t&&e.jsxs("div",{className:"p-4 border-t border-slate-200 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"데이터 붙여넣기"}),e.jsx("textarea",{value:s,onChange:i=>n(i.target.value),onFocus:i=>i.stopPropagation(),onClick:i=>i.stopPropagation(),placeholder:"엑셀에서 복사한 데이터를 붙여넣으세요...",className:"w-full px-3 py-2 border border-slate-300 rounded-lg text-xs resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:s?`${m.rows}행 × ${m.cols}열`:"데이터 없음"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"X 좌표"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>g("admin",{excelPasteSettings:{...o.admin.excelPasteSettings,startPosition:{...o.admin.excelPasteSettings.startPosition,x:Math.max(0,o.admin.excelPasteSettings.startPosition.x-10)}}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs font-mono",children:"◀"}),e.jsx("input",{type:"number",value:o.admin.excelPasteSettings.startPosition.x,onChange:i=>g("admin",{excelPasteSettings:{...o.admin.excelPasteSettings,startPosition:{...o.admin.excelPasteSettings.startPosition,x:parseInt(i.target.value)||0}}}),onFocus:i=>i.stopPropagation(),onClick:i=>i.stopPropagation(),className:"w-16 px-1 py-1 border border-slate-300 rounded text-xs text-center"}),e.jsx("button",{onClick:()=>g("admin",{excelPasteSettings:{...o.admin.excelPasteSettings,startPosition:{...o.admin.excelPasteSettings.startPosition,x:o.admin.excelPasteSettings.startPosition.x+10}}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs font-mono",children:"▶"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"Y 좌표"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>g("admin",{excelPasteSettings:{...o.admin.excelPasteSettings,startPosition:{...o.admin.excelPasteSettings.startPosition,y:Math.max(0,o.admin.excelPasteSettings.startPosition.y-10)}}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs font-mono",children:"▲"}),e.jsx("input",{type:"number",value:o.admin.excelPasteSettings.startPosition.y,onChange:i=>g("admin",{excelPasteSettings:{...o.admin.excelPasteSettings,startPosition:{...o.admin.excelPasteSettings.startPosition,y:parseInt(i.target.value)||0}}}),onFocus:i=>i.stopPropagation(),onClick:i=>i.stopPropagation(),className:"w-16 px-1 py-1 border border-slate-300 rounded text-xs text-center"}),e.jsx("button",{onClick:()=>g("admin",{excelPasteSettings:{...o.admin.excelPasteSettings,startPosition:{...o.admin.excelPasteSettings.startPosition,y:o.admin.excelPasteSettings.startPosition.y+10}}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs font-mono",children:"▼"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"셀 너비"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>g("admin",{excelPasteSettings:{...o.admin.excelPasteSettings,cellWidth:Math.max(20,o.admin.excelPasteSettings.cellWidth-1)}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"◀"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded",children:[o.admin.excelPasteSettings.cellWidth,"px"]}),e.jsx("button",{onClick:()=>g("admin",{excelPasteSettings:{...o.admin.excelPasteSettings,cellWidth:Math.min(300,o.admin.excelPasteSettings.cellWidth+1)}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"▶"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"셀 높이"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>g("admin",{excelPasteSettings:{...o.admin.excelPasteSettings,cellHeight:Math.max(20,o.admin.excelPasteSettings.cellHeight-1)}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"▲"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded",children:[o.admin.excelPasteSettings.cellHeight,"px"]}),e.jsx("button",{onClick:()=>g("admin",{excelPasteSettings:{...o.admin.excelPasteSettings,cellHeight:Math.min(100,o.admin.excelPasteSettings.cellHeight+1)}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"▼"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:j,disabled:!s.trim(),className:"flex-1 px-4 py-2 bg-green-500 hover:bg-green-600 disabled:bg-gray-300 text-white rounded-lg text-sm font-medium transition-colors",children:"📋 셀 생성"}),e.jsxs("button",{onClick:x,disabled:!s.trim(),className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white rounded-lg text-sm font-medium transition-colors",children:["👁️ ",r?"숨김":"미리보기"]})]}),e.jsx("button",{onClick:v,className:"w-full px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm font-medium transition-colors",title:"생성된 모든 엑셀 셀 그룹을 삭제합니다",children:"🗑️ 엑셀 셀 그룹 삭제"})]})]})]})},nt=({colorMode:t,currentColor:l,onColorModeChange:s,onColorSelect:r,showTransparent:o=!1})=>e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"색상"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 mb-3",children:[e.jsx("button",{onClick:()=>s("text"),className:`px-2 py-2 rounded text-xs transition-colors ${t==="text"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"텍스트"}),e.jsx("button",{onClick:()=>s("background"),className:`px-2 py-2 rounded text-xs transition-colors ${t==="background"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"배경"}),e.jsx("button",{onClick:()=>s("border"),className:`px-2 py-2 rounded text-xs transition-colors ${t==="border"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"테두리"})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[o&&e.jsx("button",{onClick:()=>r("transparent"),className:`w-8 h-8 rounded border-2 transition-all ${l==="transparent"?"border-blue-500 border-2 shadow-md":"border-slate-300 hover:border-slate-400"}`,style:{backgroundColor:"white",backgroundImage:"linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(-45deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(-45deg, transparent 75%, #ccc 75%)",backgroundSize:"8px 8px",backgroundPosition:"0 0, 0 4px, 4px -4px, -4px 0px"},title:"투명"}),be.map((d,x)=>{const j=l===d;return e.jsx("button",{onClick:()=>r(d),className:`w-8 h-8 rounded border-2 transition-all ${j?"border-blue-500 border-2 shadow-md":"border-slate-300 hover:border-slate-400"}`,style:{backgroundColor:d},title:d},x)})]})]}),lt=({onDuplicate:t,onDelete:l,onBringToFront:s,onBringForward:r,onSendBackward:o,onSendToBack:d})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:t,className:"flex-1 px-3 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg text-xs font-medium transition-colors",children:"📋 복사"}),e.jsx("button",{onClick:l,className:"flex-1 px-3 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-xs font-medium transition-colors",children:"🗑️ 삭제"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"레이어 순서"}),e.jsxs("div",{className:"grid grid-cols-4 gap-1",children:[e.jsx("button",{onClick:s,className:"px-2 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded text-xs font-medium transition-colors",title:"맨 위로",children:"⬆⬆"}),e.jsx("button",{onClick:r,className:"px-2 py-1 bg-blue-400 hover:bg-blue-500 text-white rounded text-xs font-medium transition-colors",title:"위로",children:"⬆"}),e.jsx("button",{onClick:o,className:"px-2 py-1 bg-purple-400 hover:bg-purple-500 text-white rounded text-xs font-medium transition-colors",title:"아래로",children:"⬇"}),e.jsx("button",{onClick:d,className:"px-2 py-1 bg-purple-500 hover:bg-purple-600 text-white rounded text-xs font-medium transition-colors",title:"맨 아래로",children:"⬇⬇"})]})]})]}),at=({selectedObject:t,colorMode:l,onColorModeChange:s,onColorSelect:r,onUpdateTextObject:o,onUpdateImageObject:d,onDuplicate:x,onDelete:j,onBringToFront:v,onBringForward:g,onSendBackward:m,onSendToBack:n,getCurrentColor:i})=>{var k,b,P;if(!t)return null;const a=i(),h=c=>{if(H(t)){const y=t.textStyle||{color:"#000000",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"};o(t.id,{textStyle:{...y,...c}})}},C=c=>{if(H(t)){const y=t.boxStyle||{backgroundColor:"transparent",backgroundOpacity:1,borderColor:"#000000",borderWidth:0,borderRadius:0};o(t.id,{boxStyle:{...y,...c}})}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"✏️"})," 선택된 객체 편집"]}),H(t)&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"텍스트"}),e.jsx("textarea",{value:t.text,onChange:c=>o(t.id,{text:c.target.value}),onFocus:c=>c.stopPropagation(),onClick:c=>c.stopPropagation(),className:"w-full px-3 py-2 border border-slate-300 rounded-lg text-sm resize-none focus:ring-2 focus:ring-blue-500",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"폰트 크기"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>o(t.id,{fontSize:Math.max(8,t.fontSize-2)}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"▼"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded border",children:[t.fontSize,"px"]}),e.jsx("button",{onClick:()=>o(t.id,{fontSize:Math.min(72,t.fontSize+2)}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"▲"})]})]}),e.jsx(nt,{colorMode:l,currentColor:a,onColorModeChange:s,onColorSelect:r,showTransparent:l==="background"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"텍스트 스타일"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{var c;return h({bold:!((c=t.textStyle)!=null&&c.bold)})},className:`px-3 py-1 rounded-lg text-xs transition-colors ${(k=t.textStyle)!=null&&k.bold?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"굵게"}),e.jsx("button",{onClick:()=>{var c;return h({italic:!((c=t.textStyle)!=null&&c.italic)})},className:`px-3 py-1 rounded-lg text-xs transition-colors ${(b=t.textStyle)!=null&&b.italic?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"기울임"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"텍스트 정렬"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"가로"}),e.jsx("div",{className:"grid grid-cols-3 gap-1",children:["left","center","right"].map(c=>{var y;return e.jsx("button",{onClick:()=>h({horizontalAlign:c}),className:`px-2 py-1 rounded text-xs transition-colors ${((y=t.textStyle)==null?void 0:y.horizontalAlign)===c?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:c==="left"?"◀":c==="center"?"●":"▶"},c)})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"세로"}),e.jsx("div",{className:"grid grid-cols-3 gap-1",children:["top","middle","bottom"].map(c=>{var y;return e.jsx("button",{onClick:()=>h({verticalAlign:c}),className:`px-2 py-1 rounded text-xs transition-colors ${((y=t.textStyle)==null?void 0:y.verticalAlign)===c?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:c==="top"?"▲":c==="middle"?"●":"▼"},c)})})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"테두리 두께"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{var c;return C({borderWidth:Math.max(0,(((c=t.boxStyle)==null?void 0:c.borderWidth)||0)-1)})},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"▼"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded",children:[((P=t.boxStyle)==null?void 0:P.borderWidth)||0,"px"]}),e.jsx("button",{onClick:()=>{var c;return C({borderWidth:Math.min(10,(((c=t.boxStyle)==null?void 0:c.borderWidth)||0)+1)})},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"▲"})]})]})]}),Ve(t)&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:t.maintainAspectRatio||!1,onChange:c=>d(t.id,{maintainAspectRatio:c.target.checked}),className:"rounded"}),e.jsx("span",{children:"비율 유지"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"불투명도"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>d(t.id,{opacity:Math.max(.1,(t.opacity||1)-.1)}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"▼"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded",children:[Math.round((t.opacity||1)*100),"%"]}),e.jsx("button",{onClick:()=>d(t.id,{opacity:Math.min(1,(t.opacity||1)+.1)}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"▲"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"크기"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-600 mb-1 block",children:"너비"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{const c=Math.max(50,t.width-10),y=t.maintainAspectRatio?{width:c,height:c/(t.width/t.height)}:{width:c};d(t.id,y)},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"◀"}),e.jsx("span",{className:"flex-1 text-center text-xs font-mono bg-slate-50 py-1 rounded",children:Math.round(t.width)}),e.jsx("button",{onClick:()=>{const c=t.width+10,y=t.maintainAspectRatio?{width:c,height:c/(t.width/t.height)}:{width:c};d(t.id,y)},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"▶"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-600 mb-1 block",children:"높이"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{const c=Math.max(30,t.height-10),y=t.maintainAspectRatio?{height:c,width:c*(t.width/t.height)}:{height:c};d(t.id,y)},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"▲"}),e.jsx("span",{className:"flex-1 text-center text-xs font-mono bg-slate-50 py-1 rounded",children:Math.round(t.height)}),e.jsx("button",{onClick:()=>{const c=t.height+10,y=t.maintainAspectRatio?{height:c,width:c*(t.width/t.height)}:{height:c};d(t.id,y)},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"▼"})]})]})]})]})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-slate-200",children:e.jsx(lt,{onDuplicate:x,onDelete:j,onBringToFront:v,onBringForward:g,onSendBackward:m,onSendToBack:n})})]})},ot=({textObjects:t,colorMode:l,onColorModeChange:s,onUpdateTextObject:r,clearCellSelection:o})=>{const d=O(m=>Array.from(m.selectedCellIds)),x=O(m=>m.selectedCellIds.size),j=O(m=>m.clearSelection);if(x===0)return null;const v=()=>{let m=72,n=0;console.log("🔍 [DEBUG] 선택된 셀 IDs:",d),console.log("🔍 [DEBUG] 전체 텍스트 객체 수:",t.length);for(const i of d){const a=t.find(h=>h.id===i);console.log(`🔍 [DEBUG] 셀 ${i}:`,a?`폰트크기 ${a.fontSize}, 타입 ${a.cellType}`:"객체 없음"),a&&a.cellType==="cell"&&(m=Math.min(m,a.fontSize||16),n++)}return console.log(`🔍 [DEBUG] 유효한 셀 수: ${n}, 최소 폰트 크기: ${m===72?16:m}`),m===72?16:m},g=["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#FFC0CB","#A52A2A","#808080","#008000","#000080","#800000","#008080","#C0C0C0","#FFFFE0","#F0F8FF"];return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[e.jsx("span",{children:"📊"})," 선택된 엑셀 셀 (",x,"개)"]}),e.jsx("button",{onClick:()=>{j(),o()},className:"text-xs text-slate-500 hover:text-slate-700 bg-slate-100 hover:bg-slate-200 px-2 py-1 rounded transition-colors",children:"선택 해제"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:["폰트 크기 (가장 작은 크기: ",v(),"px 기준)"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:async()=>{const m=v(),n=Math.max(8,m-2);console.log(`🔄 [DEBUG] 폰트 크기 감소 시작: ${d.length}개 셀, ${m}px → ${n}px`);const i=d.map(async(a,h)=>{const C=t.find(k=>k.id===a);if(console.log(`🔄 [DEBUG] 처리 중 ${h+1}/${d.length}: 셀 ${a}`,C?`현재 ${C.fontSize}px`:"객체 없음"),C&&C.cellType==="cell"){const k=await r(a,{fontSize:n});return console.log(`✅ [DEBUG] 셀 ${a} 업데이트 완료: ${n}px`),k}else console.warn(`⚠️ [DEBUG] 셀 ${a}를 찾을 수 없거나 유효하지 않음`)});try{await Promise.all(i.filter(a=>a!==void 0)),console.log(`✅ ${x}개 셀의 폰트 크기를 ${n}px로 일괄 변경 완료`)}catch(a){console.error("❌ 폰트 크기 감소 일괄 변경 실패:",a)}},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs transition-colors",title:`폰트 크기 감소 (${x}개 셀 일괄 변경)`,children:"▼"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded border",children:[v(),"px → 일괄변경"]}),e.jsx("button",{onClick:async()=>{const m=v(),n=Math.min(72,m+2);console.log(`🔄 [DEBUG] 폰트 크기 증가 시작: ${d.length}개 셀, ${m}px → ${n}px`);const i=d.map(async(a,h)=>{const C=t.find(k=>k.id===a);if(console.log(`🔄 [DEBUG] 처리 중 ${h+1}/${d.length}: 셀 ${a}`,C?`현재 ${C.fontSize}px`:"객체 없음"),C&&C.cellType==="cell"){const k=await r(a,{fontSize:n});return console.log(`✅ [DEBUG] 셀 ${a} 업데이트 완료: ${n}px`),k}else console.warn(`⚠️ [DEBUG] 셀 ${a}를 찾을 수 없거나 유효하지 않음`)});try{await Promise.all(i.filter(a=>a!==void 0)),console.log(`✅ ${x}개 셀의 폰트 크기를 ${n}px로 일괄 변경 완료`)}catch(a){console.error("❌ 폰트 크기 증가 일괄 변경 실패:",a)}},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs transition-colors",title:`폰트 크기 증가 (${x}개 셀 일괄 변경)`,children:"▲"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"색상"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 mb-3",children:[e.jsx("button",{onClick:()=>s("text"),className:`px-2 py-2 rounded text-xs transition-colors ${l==="text"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"텍스트"}),e.jsx("button",{onClick:()=>s("background"),className:`px-2 py-2 rounded text-xs transition-colors ${l==="background"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"배경"}),e.jsx("button",{onClick:()=>s("border"),className:`px-2 py-2 rounded text-xs transition-colors ${l==="border"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"테두리"})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[l==="background"&&e.jsx("button",{onClick:async()=>{const m=d.map(async n=>{const i=t.find(a=>a.id===n);if(i&&i.cellType==="cell"){const a=i.boxStyle||{backgroundColor:"transparent",backgroundOpacity:1,borderColor:"#000000",borderWidth:0,borderRadius:0};return r(n,{boxStyle:{...a,backgroundColor:"transparent"}})}});try{await Promise.all(m),console.log(`✅ ${x}개 셀의 배경을 투명으로 일괄 변경 완료`)}catch(n){console.error("❌ 투명 배경 일괄 변경 실패:",n)}},className:"w-8 h-8 rounded border-2 border-gray-300 bg-white flex items-center justify-center hover:bg-gray-50 transition-colors cursor-pointer",title:`투명 (${x}개 셀 일괄 변경)`,children:e.jsx("span",{className:"text-red-500 text-xs",children:"∅"})}),g.map(m=>e.jsx("button",{onClick:async()=>{const n=d.map(async i=>{const a=t.find(h=>h.id===i);if(a&&a.cellType==="cell"){if(l==="text"){const h=a.textStyle||{color:"#000000",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"};return r(i,{textStyle:{...h,color:m}})}else if(l==="background"){const h=a.boxStyle||{backgroundColor:"transparent",backgroundOpacity:1,borderColor:"#000000",borderWidth:0,borderRadius:0};return r(i,{boxStyle:{...h,backgroundColor:m}})}else if(l==="border"){const h=a.boxStyle||{backgroundColor:"transparent",backgroundOpacity:1,borderColor:"#000000",borderWidth:0,borderRadius:0};return r(i,{boxStyle:{...h,borderColor:m,borderWidth:1}})}}});try{await Promise.all(n),console.log(`✅ ${x}개 셀의 ${l==="text"?"텍스트":l==="background"?"배경":"테두리"} 색상을 ${m}로 일괄 변경 완료`)}catch(i){console.error("❌ 색상 일괄 변경 실패:",i)}},className:"w-8 h-8 rounded border border-gray-300 hover:scale-110 transition-transform cursor-pointer",style:{backgroundColor:m},title:`${m} (${x}개 셀 일괄 변경)`},m))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"텍스트 스타일"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{const m=d.map(async n=>{const i=t.find(a=>a.id===n);if(i&&i.cellType==="cell"){const a=i.textStyle||{color:"#000000",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"};return r(n,{textStyle:{...a,bold:!a.bold}})}});try{await Promise.all(m),console.log(`✅ ${x}개 셀의 굵게 스타일 일괄 변경 완료`)}catch(n){console.error("❌ 굵게 스타일 일괄 변경 실패:",n)}},className:"px-3 py-2 bg-slate-100 hover:bg-slate-200 rounded text-xs font-bold transition-colors",title:`굵게 (${x}개 셀 일괄 변경)`,children:"B"}),e.jsx("button",{onClick:async()=>{const m=d.map(async n=>{const i=t.find(a=>a.id===n);if(i&&i.cellType==="cell"){const a=i.textStyle||{color:"#000000",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"};return r(n,{textStyle:{...a,italic:!a.italic}})}});try{await Promise.all(m),console.log(`✅ ${x}개 셀의 기울임 스타일 일괄 변경 완료`)}catch(n){console.error("❌ 기울임 스타일 일괄 변경 실패:",n)}},className:"px-3 py-2 bg-slate-100 hover:bg-slate-200 rounded text-xs italic transition-colors",title:`기울임 (${x}개 셀 일괄 변경)`,children:"I"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"정렬"}),e.jsx("div",{className:"grid grid-cols-3 gap-1 mb-2",children:["left","center","right"].map(m=>e.jsx("button",{onClick:async()=>{const n=d.map(async i=>{const a=t.find(h=>h.id===i);if(a&&a.cellType==="cell"){const h=a.textStyle||{color:"#000000",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"};return r(i,{textStyle:{...h,horizontalAlign:m}})}});try{await Promise.all(n),console.log(`✅ ${x}개 셀의 수평정렬을 ${m}로 일괄 변경 완료`)}catch(i){console.error("❌ 수평정렬 일괄 변경 실패:",i)}},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs transition-colors",title:`${m==="left"?"왼쪽":m==="center"?"가운데":"오른쪽"} 정렬 (${x}개 셀 일괄 변경)`,children:m==="left"?"←":m==="center"?"↔":"→"},m))}),e.jsx("div",{className:"grid grid-cols-3 gap-1",children:["top","middle","bottom"].map(m=>e.jsx("button",{onClick:async()=>{for(const n of d){const i=t.find(a=>a.id===n);if(i&&i.cellType==="cell"){const a=i.textStyle||{color:"#000000",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"};await r(n,{textStyle:{...a,verticalAlign:m}})}}},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs transition-colors",children:m==="top"?"↑":m==="middle"?"↕":"↓"},m))})]})]})]})},rt=({isExpanded:t,onToggle:l,textObjects:s,imageObjects:r,drawObjects:o,floorImage:d,settings:x,initializeFirebaseListeners:j})=>{const v=f.useRef(null),g=()=>{try{const a={textObjects:s,imageObjects:r,drawObjects:o,floorImage:d,settings:x,exportedAt:new Date().toISOString(),version:"1.0"},h=JSON.stringify(a,null,2),C=new Blob([h],{type:"application/json"}),P=`board7-backup-${new Date().toISOString().replace(/[:.]/g,"-").slice(0,19)}.json`,c=document.createElement("a");c.href=URL.createObjectURL(C),c.download=P,c.click(),URL.revokeObjectURL(c.href),alert(`✅ 데이터가 성공적으로 저장되었습니다!
파일명: ${P}`)}catch(a){console.error("데이터 저장 오류:",a),alert("❌ 데이터 저장 중 오류가 발생했습니다.")}},m=()=>{var a;(a=v.current)==null||a.click()},n=a=>{var b;const h=(b=a.target.files)==null?void 0:b[0];if(!h)return;if(!h.name.endsWith(".json")){alert("❌ JSON 파일만 업로드 가능합니다.");return}const C=`⚠️ 경고: 현재 캔버스의 모든 객체와 그리기 요소가 삭제됩니다!

현재 데이터:
• 텍스트 객체: ${s.length}개
• 이미지 객체: ${r.length}개  
• 그리기 요소: ${o.length}개
• 배경 이미지: ${d?"있음":"없음"}

정말로 불러오시겠습니까?`;if(!confirm(C)){a.target.value="";return}const k=new FileReader;k.onload=async P=>{var c,y,R,T;try{const A=(c=P.target)==null?void 0:c.result,E=JSON.parse(A);if(!E.version||!E.exportedAt)throw new Error("올바르지 않은 백업 파일 형식입니다.");await i(E),alert(`✅ 데이터가 성공적으로 불러와졌습니다!

불러온 데이터:
• 텍스트 객체: ${((y=E.textObjects)==null?void 0:y.length)||0}개
• 이미지 객체: ${((R=E.imageObjects)==null?void 0:R.length)||0}개
• 그리기 요소: ${((T=E.drawObjects)==null?void 0:T.length)||0}개
• 배경 이미지: ${E.floorImage?"있음":"없음"}
• 백업 생성일: ${new Date(E.exportedAt).toLocaleString()}`)}catch(A){console.error("데이터 불러오기 오류:",A),alert(`❌ 데이터 불러오기 중 오류가 발생했습니다.
파일이 손상되었거나 올바르지 않은 형식입니다.`)}a.target.value=""},k.readAsText(h)},i=async a=>{var h,C,k;try{await Promise.all([I(M(W,"textObjects"),null),I(M(W,"imageObjects"),null),I(M(W,"drawObjects"),null),I(M(W,"floorImage"),null)]);const b=[];if(((h=a.textObjects)==null?void 0:h.length)>0){const P=a.textObjects.reduce((c,y)=>(c[y.id]=y,c),{});b.push(I(M(W,"textObjects"),P))}if(((C=a.imageObjects)==null?void 0:C.length)>0){const P=a.imageObjects.reduce((c,y)=>(c[y.id]=y,c),{});b.push(I(M(W,"imageObjects"),P))}if(((k=a.drawObjects)==null?void 0:k.length)>0){const P=a.drawObjects.reduce((c,y)=>(c[y.id]=y,c),{});b.push(I(M(W,"drawObjects"),P))}a.floorImage&&b.push(I(M(W,"floorImage"),a.floorImage)),a.settings&&b.push(I(M(W,"settings"),a.settings)),await Promise.all(b),setTimeout(()=>{j()},500)}catch(b){throw console.error("데이터 로드 오류:",b),b}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("button",{onClick:l,className:"w-full p-4 flex items-center justify-between text-sm font-bold text-slate-700 hover:bg-slate-50 rounded-t-xl transition-colors",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"💾"})," 데이터 관리"]}),e.jsx("span",{className:`text-slate-400 transition-transform duration-200 ${t?"rotate-180":""}`,children:"▼"})]}),t&&e.jsxs("div",{className:"p-4 border-t border-slate-200 space-y-4",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 space-y-2",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-600 flex items-center gap-1",children:[e.jsx("span",{children:"📊"})," 현재 데이터 현황"]}),e.jsxs("div",{className:"text-xs text-slate-600 space-y-1",children:[e.jsxs("div",{children:["• 텍스트 객체: ",e.jsxs("span",{className:"font-medium",children:[s.length,"개"]})]}),e.jsxs("div",{children:["• 이미지 객체: ",e.jsxs("span",{className:"font-medium",children:[r.length,"개"]})]}),e.jsxs("div",{children:["• 그리기 요소: ",e.jsxs("span",{className:"font-medium",children:[o.length,"개"]})]}),e.jsxs("div",{children:["• 배경 이미지: ",e.jsx("span",{className:"font-medium",children:d?"있음":"없음"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:g,className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2 text-sm",children:[e.jsx("span",{children:"💾"}),"데이터 저장 (JSON 다운로드)"]}),e.jsxs("button",{onClick:m,className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2 text-sm",children:[e.jsx("span",{children:"📂"}),"데이터 불러오기 (JSON 업로드)"]}),e.jsx("input",{ref:v,type:"file",accept:".json",onChange:n,className:"hidden"})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:[e.jsxs("h5",{className:"text-xs font-bold text-yellow-700 mb-2 flex items-center gap-1",children:[e.jsx("span",{children:"⚠️"})," 주의사항"]}),e.jsxs("div",{className:"text-xs text-yellow-700 space-y-1",children:[e.jsx("div",{children:"• 불러오기 시 현재 모든 데이터가 삭제됩니다"}),e.jsx("div",{children:"• 저장된 JSON 파일은 오프라인에서 보관됩니다"}),e.jsx("div",{children:"• 백업을 정기적으로 생성하는 것을 권장합니다"})]})]})]})]})},it=({isExpanded:t,onToggle:l,safeSettings:s,updateSettings:r,onImageUpload:o})=>{const{updatePassword:d}=G(),[x,j]=f.useState(null),[v,g]=f.useState(""),[m,n]=f.useState(""),i=async h=>{if(v.length!==4||!/^\d{4}$/.test(v)){alert("패스워드는 4자리 숫자여야 합니다.");return}if(v!==m){alert("패스워드 확인이 일치하지 않습니다.");return}try{await d(h,v),alert(`${h==="admin"?"관리자":"뷰어"} 패스워드가 성공적으로 변경되었습니다.`),j(null),g(""),n("")}catch(C){alert(`패스워드 변경 실패: ${C.message||"알 수 없는 오류"}`)}},a=()=>{j(null),g(""),n("")};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("button",{onClick:l,className:"w-full p-4 flex items-center justify-between text-sm font-bold text-slate-700 hover:bg-slate-50 rounded-t-xl transition-colors",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"⚙️"})," 설정"]}),e.jsx("span",{className:`text-slate-400 transition-transform duration-200 ${t?"rotate-180":""}`,children:"▼"})]}),t&&e.jsxs("div",{className:"p-4 border-t border-slate-200 space-y-4",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 space-y-3",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-600 flex items-center gap-1",children:[e.jsx("span",{children:"🔲"})," 그리드"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:s.admin.gridVisible,onChange:h=>r("admin",{gridVisible:h.target.checked}),className:"rounded"}),e.jsx("span",{children:"그리드 표시"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:s.admin.gridSnapEnabled,onChange:h=>r("admin",{gridSnapEnabled:h.target.checked}),className:"rounded"}),e.jsx("span",{children:"그리드에 스냅"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"그리드 크기"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>r("admin",{gridSize:Math.max(8,s.admin.gridSize-4)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"▼"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-white py-1 rounded border",children:[s.admin.gridSize,"px"]}),e.jsx("button",{onClick:()=>r("admin",{gridSize:Math.min(64,s.admin.gridSize+4)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"▲"})]})]})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 space-y-3",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-600 flex items-center gap-1",children:[e.jsx("span",{children:"📍"})," 객체 생성 위치"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"X 좌표"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{const h=Math.max(0,s.admin.objectCreationPosition.x-20);r("admin",{objectCreationPosition:{...s.admin.objectCreationPosition,x:h}})},className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"◀"}),e.jsx("span",{className:"flex-1 text-center text-xs font-mono bg-white py-1 rounded border",children:s.admin.objectCreationPosition.x}),e.jsx("button",{onClick:()=>{const h=s.admin.objectCreationPosition.x+20;r("admin",{objectCreationPosition:{...s.admin.objectCreationPosition,x:h}})},className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"▶"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"Y 좌표"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{const h=Math.max(0,s.admin.objectCreationPosition.y-20);r("admin",{objectCreationPosition:{...s.admin.objectCreationPosition,y:h}})},className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"▲"}),e.jsx("span",{className:"flex-1 text-center text-xs font-mono bg-white py-1 rounded border",children:s.admin.objectCreationPosition.y}),e.jsx("button",{onClick:()=>{const h=s.admin.objectCreationPosition.y+20;r("admin",{objectCreationPosition:{...s.admin.objectCreationPosition,y:h}})},className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"▼"})]})]})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-600 mb-2 flex items-center gap-1",children:[e.jsx("span",{children:"🖼️"})," 배경 이미지"]}),e.jsxs("label",{className:"w-full px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors cursor-pointer text-sm font-medium flex items-center justify-center gap-2",children:[e.jsx("span",{children:"📁"}),e.jsx("span",{children:"이미지 업로드"}),e.jsx("input",{type:"file",accept:"image/*",onChange:o,className:"hidden"})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-600 mb-3 flex items-center gap-1",children:[e.jsx("span",{children:"🔐"})," 패스워드 변경"]}),x?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-xs text-slate-600 font-medium",children:[x==="admin"?"관리자":"뷰어"," 패스워드 변경"]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500 mb-1 block",children:"새 패스워드 (4자리 숫자)"}),e.jsx("input",{type:"password",value:v,onChange:h=>g(h.target.value),maxLength:4,pattern:"\\d{4}",className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"새 패스워드"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500 mb-1 block",children:"패스워드 확인"}),e.jsx("input",{type:"password",value:m,onChange:h=>n(h.target.value),maxLength:4,pattern:"\\d{4}",className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"패스워드 확인"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>i(x),className:"flex-1 px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white text-xs font-medium rounded-lg transition-colors",children:"변경"}),e.jsx("button",{onClick:a,className:"flex-1 px-3 py-2 bg-gray-500 hover:bg-gray-600 text-white text-xs font-medium rounded-lg transition-colors",children:"취소"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>j("admin"),className:"w-full px-3 py-2 bg-red-500 hover:bg-red-600 text-white text-xs font-medium rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx("span",{children:"👑"}),e.jsx("span",{children:"관리자 패스워드 변경"})]}),e.jsxs("button",{onClick:()=>j("view"),className:"w-full px-3 py-2 bg-green-500 hover:bg-green-600 text-white text-xs font-medium rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx("span",{children:"👁️"}),e.jsx("span",{children:"뷰어 패스워드 변경"})]})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 space-y-2",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-600 flex items-center gap-1",children:[e.jsx("span",{children:"🔧"})," 기타"]}),e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:s.admin.autoToolSwitch,onChange:h=>r("admin",{autoToolSwitch:h.target.checked}),className:"rounded"}),e.jsx("span",{children:"객체 생성 후 자동으로 선택 도구로 전환"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"기본 폰트 크기"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>r("admin",{defaultFontSize:Math.max(8,s.admin.defaultFontSize-2)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"▼"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-white py-1 rounded border",children:[s.admin.defaultFontSize,"px"]}),e.jsx("button",{onClick:()=>r("admin",{defaultFontSize:Math.min(72,s.admin.defaultFontSize+2)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"▲"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"기본 박스 크기"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500 mb-1 block",children:"가로"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>r("admin",{defaultBoxWidth:Math.max(50,s.admin.defaultBoxWidth-10)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"◀"}),e.jsxs("span",{className:"flex-1 text-center text-xs font-mono bg-white py-1 rounded border",children:[s.admin.defaultBoxWidth,"px"]}),e.jsx("button",{onClick:()=>r("admin",{defaultBoxWidth:Math.min(500,s.admin.defaultBoxWidth+10)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"▶"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500 mb-1 block",children:"세로"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>r("admin",{defaultBoxHeight:Math.max(30,s.admin.defaultBoxHeight-10)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"▲"}),e.jsxs("span",{className:"flex-1 text-center text-xs font-mono bg-white py-1 rounded border",children:[s.admin.defaultBoxHeight,"px"]}),e.jsx("button",{onClick:()=>r("admin",{defaultBoxHeight:Math.min(200,s.admin.defaultBoxHeight+10)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"▼"})]})]})]})]})]})]})]})},ct=()=>{const[t,l]=f.useState(!1),[s,r]=f.useState(!1),[o,d]=f.useState(!1),[x,j]=f.useState(""),[v,g]=f.useState(!1),[m,n]=f.useState("text"),i=f.useRef(null);return{isSettingsExpanded:t,isExcelPasteExpanded:s,isDataManagementExpanded:o,excelPasteData:x,showPreview:v,colorMode:m,updateTimerRef:i,setIsSettingsExpanded:l,setIsExcelPasteExpanded:r,setIsDataManagementExpanded:d,setExcelPasteData:j,setShowPreview:g,setColorMode:n,toggleSettings:()=>l(!t),toggleExcelPaste:()=>r(!s),toggleDataManagement:()=>d(!o),resetExcelData:()=>{j(""),g(!1)},clearUpdateTimer:()=>{i.current&&(clearTimeout(i.current),i.current=null)}}},dt=({selectedObject:t,colorMode:l,updateTextStyle:s,updateBoxStyle:r})=>{const o=f.useCallback(x=>{if(!(!t||!H(t)))switch(l){case"text":s({color:x});break;case"background":r({backgroundColor:x});break;case"border":r({borderColor:x});break}},[l,t,s,r]),d=ue(t,l);return{colors:be,currentColor:d,handleColorSelect:o,showTransparent:l==="background"}},he=t=>new Promise((l,s)=>{const r=new FileReader;r.onload=o=>{var x;const d=(x=o.target)==null?void 0:x.result;l(d)},r.onerror=()=>{s(new Error("파일 읽기 실패"))},r.readAsDataURL(t)}),xt=t=>new Promise((l,s)=>{const r=new Image;r.onload=()=>{l({width:r.naturalWidth,height:r.naturalHeight})},r.onerror=()=>{s(new Error("이미지 로드 실패"))},r.src=t}),ht=(t="image/*")=>new Promise(l=>{const s=document.createElement("input");s.type="file",s.accept=t,s.onchange=r=>{var d;const o=(d=r.target.files)==null?void 0:d[0];l(o||null)},s.click()}),mt=(t,l,s=200)=>{const r=l/t,o=s*r;return{width:s,height:o}},K=(t,l)=>{const s=new CustomEvent("excel-preview-update",{detail:{data:t,show:l}});window.dispatchEvent(s)},bt=({excelPasteData:t,showPreview:l,safeSettings:s,textObjects:r,addTextObject:o,deleteTextObject:d,onDataChange:x,onPreviewChange:j})=>{const v=ge(t),g=f.useCallback(async()=>{var L;const n=me(t);if(n.length===0){alert("붙여넣을 데이터가 없습니다.");return}const{startPosition:i,cellWidth:a,cellHeight:h,fontSize:C,fontColor:k,backgroundColor:b,maxRows:P=100,maxCols:c=50}=s.admin.excelPasteSettings,y=`excel-input-${Date.now()}`,R=[],T=Math.min(n.length,P),A=n.map(z=>z.length),E=A.length>0?Math.max(...A):0,B=Math.min(E,c);for(let z=0;z<T;z++)for(let D=0;D<B;D++){const U=((L=n[z])==null?void 0:L[D])||"",Z={x:i.x+D*a,y:i.y+z*h,width:a,height:h,text:U,fontSize:C,textStyle:{color:k,bold:!1,italic:!1,horizontalAlign:"center",verticalAlign:"middle",fontFamily:"Arial"},boxStyle:{backgroundColor:b,backgroundOpacity:1,borderColor:"#d1d5db",borderWidth:1,borderRadius:0},permissions:{editable:!0,movable:!1,resizable:!1,deletable:!1},zIndex:Date.now()+z*B+D,locked:!0,visible:!0,opacity:1,hasCheckbox:!1,checkboxChecked:!1,checkboxCheckedColor:"#22c55e",checkboxUncheckedColor:"#f3f4f6",isEditing:!1,lastModified:Date.now(),groupId:y,cellType:"cell",cellPosition:{row:z,col:D}};R.push(Z)}try{for(const z of R)await o(z);alert(`${T}x${B} 셀이 생성되었습니다.`),x(""),j(!1),K("",!1)}catch(z){console.error("엑셀 셀 생성 실패:",z),alert("셀 생성 중 오류가 발생했습니다.")}},[t,s.admin.excelPasteSettings,o,x,j]),m=f.useCallback(async()=>{const n=r.filter(h=>h.groupId&&h.groupId.startsWith("excel-input-"));if(n.length===0){alert("삭제할 엑셀 셀이 없습니다.");return}const i=new Set(n.map(h=>h.groupId)).size,a=`${i}개의 엑셀 그룹 (총 ${n.length}개 셀)을 삭제하시겠습니까?`;if(confirm(a))try{for(const h of n)await d(h.id);alert(`${i}개 그룹 (${n.length}개 셀)이 삭제되었습니다.`)}catch(h){console.error("엑셀 셀 삭제 실패:",h),alert("셀 삭제 중 오류가 발생했습니다.")}},[r,d]);return f.useEffect(()=>{l&&t.trim()?K(t,!0):K("",!1)},[l,t,s.admin.excelPasteSettings]),{dataDimensions:v,handleCreateExcelCells:g,handleDeleteExcelCellGroups:m}},ut=()=>{var ee,te,se,ne,le,ae,oe,re,ie,ce,de,xe;const{textObjects:t,imageObjects:l,drawObjects:s,floorImage:r,addTextObject:o,addImageObject:d,updateTextObject:x,updateImageObject:j,setFloorImage:v,deleteTextObject:g,deleteImageObject:m,settings:n,updateSettings:i,initializeFirebaseListeners:a,isLoading:h}=G(),{currentTool:C,setCurrentTool:k,selectedObjectId:b,setSelectedObjectId:P}=Y(),{isSettingsExpanded:c,isExcelPasteExpanded:y,isDataManagementExpanded:R,excelPasteData:T,showPreview:A,colorMode:E,updateTimerRef:B,setExcelPasteData:L,setShowPreview:z,setColorMode:D,toggleSettings:U,toggleExcelPaste:Z,toggleDataManagement:fe,clearUpdateTimer:q}=ct(),$={admin:{autoToolSwitch:((ee=n==null?void 0:n.admin)==null?void 0:ee.autoToolSwitch)??!0,gridVisible:((te=n==null?void 0:n.admin)==null?void 0:te.gridVisible)??!0,gridSize:((se=n==null?void 0:n.admin)==null?void 0:se.gridSize)??32,gridSnapEnabled:((ne=n==null?void 0:n.admin)==null?void 0:ne.gridSnapEnabled)??!1,defaultFontSize:((le=n==null?void 0:n.admin)==null?void 0:le.defaultFontSize)??16,defaultBoxWidth:((ae=n==null?void 0:n.admin)==null?void 0:ae.defaultBoxWidth)??200,defaultBoxHeight:((oe=n==null?void 0:n.admin)==null?void 0:oe.defaultBoxHeight)??60,objectCreationPosition:((re=n==null?void 0:n.admin)==null?void 0:re.objectCreationPosition)??{x:260,y:950},defaultCheckboxSettings:((ie=n==null?void 0:n.admin)==null?void 0:ie.defaultCheckboxSettings)??{checkedColor:"#22c55e",uncheckedColor:"#f3f4f6",checkedBackgroundColor:"#ffffff",uncheckedBackgroundColor:"#ffffff",checkedBackgroundOpacity:1,uncheckedBackgroundOpacity:1},excelPasteSettings:((ce=n==null?void 0:n.admin)==null?void 0:ce.excelPasteSettings)??{startPosition:{x:100,y:100},cellWidth:120,cellHeight:40,fontSize:14,fontColor:"#000000",backgroundColor:"transparent",maxRows:50,maxCols:50}},view:{virtualKeyboardEnabled:((de=n==null?void 0:n.view)==null?void 0:de.virtualKeyboardEnabled)??!0,touchMode:((xe=n==null?void 0:n.view)==null?void 0:xe.touchMode)??!0}},F=b?t.find(u=>u.id===b)||l.find(u=>u.id===b):null,Q=f.useCallback((u,p)=>{B.current&&clearTimeout(B.current),B.current=setTimeout(()=>{x(u,p)},300)},[x]),je=f.useCallback((u,p)=>{B.current&&clearTimeout(B.current),B.current=setTimeout(()=>{j(u,p)},300)},[j]),ye=f.useCallback(async u=>{if(F&&"text"in F){const p=F.textStyle||{color:"#000000",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"};await x(F.id,{textStyle:{...p,...u}})}},[F,x]),we=f.useCallback(async u=>{if(F&&"text"in F){const p=F.boxStyle||{backgroundColor:"transparent",backgroundOpacity:1,borderColor:"#000000",borderWidth:0,borderRadius:0};await x(F.id,{boxStyle:{...p,...u}})}},[F,x]),{handleColorSelect:ve}=dt({selectedObject:F,colorMode:E,updateTextStyle:ye,updateBoxStyle:we}),Ce=f.useCallback(async u=>await o(u),[o]),{handleCreateExcelCells:Ne,handleDeleteExcelCellGroups:ke}=bt({excelPasteData:T,showPreview:A,safeSettings:$,textObjects:t,addTextObject:Ce,deleteTextObject:g,onDataChange:L,onPreviewChange:z}),Pe=ue(F,E),{getSelectedCount:Se,clearSelection:ze}=O.getState(),$e=Se(),Ee=f.useCallback(async()=>{const{x:u,y:p}=$.admin.objectCreationPosition,w={x:u,y:p,width:$.admin.defaultBoxWidth,height:$.admin.defaultBoxHeight,text:"새 텍스트",fontSize:$.admin.defaultFontSize,textStyle:{color:"#000000",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"},boxStyle:{backgroundColor:"transparent",backgroundOpacity:1,borderColor:"#000000",borderWidth:0,borderRadius:0},permissions:{editable:!0,movable:!0,resizable:!0,deletable:!0},zIndex:Date.now(),locked:!1,visible:!0,opacity:1,hasCheckbox:!1,checkboxChecked:!1,checkboxCheckedColor:"#22c55e",checkboxUncheckedColor:"#f3f4f6",isEditing:!1,lastModified:Date.now()};try{await o(w)}catch(S){console.error("텍스트 객체 생성 실패:",S)}},[o,$]),Fe=f.useCallback(async()=>{const{x:u,y:p}=$.admin.objectCreationPosition,{checkedColor:w,uncheckedColor:S,checkedBackgroundColor:N,uncheckedBackgroundColor:J,checkedBackgroundOpacity:V,uncheckedBackgroundOpacity:X}=$.admin.defaultCheckboxSettings,_={x:u,y:p,width:$.admin.defaultBoxWidth,height:$.admin.defaultBoxHeight,text:"새 체크박스",fontSize:$.admin.defaultFontSize,textStyle:{color:"#000000",bold:!0,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"},boxStyle:{backgroundColor:"transparent",backgroundOpacity:1,borderColor:"#000000",borderWidth:1,borderRadius:8},permissions:{editable:!0,movable:!0,resizable:!0,deletable:!0},zIndex:Date.now(),locked:!1,visible:!0,opacity:1,hasCheckbox:!0,checkboxChecked:!1,checkboxCheckedColor:w,checkboxUncheckedColor:S,checkedBackgroundColor:N,uncheckedBackgroundColor:J,checkedBackgroundOpacity:V,uncheckedBackgroundOpacity:X,isEditing:!1,lastModified:Date.now()};try{await o(_)}catch(He){console.error("체크박스 객체 생성 실패:",He)}},[o,$]),Ae=f.useCallback(async()=>{try{const u=await ht("image/*");if(!u)return;const p=await he(u),{width:w,height:S}=await xt(p),{width:N,height:J}=mt(w,S,200),{x:V,y:X}=$.admin.objectCreationPosition,_={x:V,y:X,width:N,height:J,src:p,permissions:{editable:!0,movable:!0,resizable:!0,deletable:!0},zIndex:Date.now(),locked:!1,visible:!0,opacity:1,maintainAspectRatio:!0,lastModified:Date.now()};await d(_)}catch(u){console.error("이미지 객체 생성 실패:",u)}},[d,$]),Te=f.useCallback(async()=>{if(!b)return;const u=_e(t,l);if(t.find(S=>S.id===b)){await x(b,{zIndex:u+1});return}l.find(S=>S.id===b)&&await j(b,{zIndex:u+1})},[b,t,l,x,j]),Be=f.useCallback(async()=>{if(!b)return;const u=[...t,...l].find(N=>N.id===b);if(!u)return;const p=Ye(u.zIndex||0,t,l);if(p===null)return;if(t.find(N=>N.id===b)){await x(b,{zIndex:p+1});return}l.find(N=>N.id===b)&&await j(b,{zIndex:p+1})},[b,t,l,x,j]),De=f.useCallback(async()=>{if(!b)return;const u=[...t,...l].find(N=>N.id===b);if(!u)return;const p=qe(u.zIndex||0,t,l);if(p===null)return;if(t.find(N=>N.id===b)){await x(b,{zIndex:p-1});return}l.find(N=>N.id===b)&&await j(b,{zIndex:p-1})},[b,t,l,x,j]),Ie=f.useCallback(async()=>{if(!b)return;const u=Ke(t,l),p=Math.max(1,u-1);if(t.find(N=>N.id===b)){await x(b,{zIndex:p});return}l.find(N=>N.id===b)&&await j(b,{zIndex:p})},[b,t,l,x,j]),Me=f.useCallback(async()=>{if(!b)return;const u=t.find(w=>w.id===b);if(u){const w={...u,x:u.x+20,y:u.y+20,isEditing:!1};delete w.id,await o(w);return}const p=l.find(w=>w.id===b);if(p){const w={...p,x:p.x+20,y:p.y+20};delete w.id,await d(w)}},[b,t,l,o,d]),We=f.useCallback(async()=>{var w,S;if(!b)return;const u=t.find(N=>N.id===b);if(u&&((w=u.permissions)!=null&&w.deletable)){await g(b),P(null);return}const p=l.find(N=>N.id===b);p&&((S=p.permissions)!=null&&S.deletable)&&(await m(b),P(null))},[b,t,l,g,m,P]),Re=f.useCallback(async u=>{var w;const p=(w=u.target.files)==null?void 0:w[0];if(p)try{const S=await he(p);await v({path:S})}catch(S){console.error("배경 이미지 업로드 실패:",S)}},[v]),Le=f.useCallback(()=>{z(!A);const u=new CustomEvent("excel-preview-update",{detail:{data:T,show:!A}});window.dispatchEvent(u)},[A,T,z]);return f.useEffect(()=>()=>{q()},[q]),h||!n?e.jsx("div",{className:"w-64 h-full bg-white border-r border-gray-200 p-4 flex items-center justify-center",children:e.jsx("div",{className:"text-gray-500",children:"설정 로드 중..."})}):e.jsxs("div",{className:"h-full flex flex-col overflow-hidden bg-gradient-to-b from-slate-50 to-slate-100",onClick:u=>{u.stopPropagation();const p=u.target;if(!Qe(p)){const w=document.activeElement;w&&et(w)&&w.blur()}},children:[e.jsx("div",{className:"p-4 border-b border-slate-200 bg-gradient-to-r from-pink-200 to-purple-200",children:e.jsxs("h1",{className:"text-lg font-bold text-gray-700 flex items-center gap-2",children:[e.jsx("span",{children:"🛠️"}),"관리자 도구"]})}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(tt,{currentTool:C,onToolSelect:k,onCreateText:Ee,onCreateCheckbox:Fe,onCreateImage:Ae}),e.jsx(st,{isExpanded:y,onToggle:Z,excelPasteData:T,showPreview:A,safeSettings:$,onDataChange:L,onPreviewToggle:Le,onCreateCells:Ne,onDeleteCellGroups:ke,updateSettings:i}),F&&!Xe(F)&&$e===0&&e.jsx(at,{selectedObject:F,colorMode:E,onColorModeChange:D,onColorSelect:ve,onUpdateTextObject:Q,onUpdateImageObject:je,onDuplicate:Me,onDelete:We,onBringToFront:Te,onBringForward:Be,onSendBackward:De,onSendToBack:Ie,getCurrentColor:()=>Pe}),e.jsx(ot,{textObjects:t,colorMode:E,onColorModeChange:D,onUpdateTextObject:Q,clearCellSelection:ze}),e.jsx(rt,{isExpanded:R,onToggle:fe,textObjects:t,imageObjects:l,drawObjects:s,floorImage:r,settings:n,initializeFirebaseListeners:a}),e.jsx(it,{isExpanded:c,onToggle:U,safeSettings:$,updateSettings:i,onImageUpload:Re})]})})]})},pe=Oe.memo(()=>{const{zoom:t,setZoom:l,fitToWindow:s}=Y(),r=f.useCallback(()=>{l(Math.min(t*1.2,5))},[t,l]),o=f.useCallback(()=>{l(Math.max(t/1.2,.05))},[t,l]),d=f.useCallback(()=>{s()},[s]),x=f.useCallback(()=>{l(1)},[l]);return e.jsxs("div",{className:"fixed bottom-4 right-4 flex flex-col gap-2 z-50",children:[e.jsx("button",{onClick:r,className:"w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:shadow-lg transition-shadow flex items-center justify-center text-lg font-semibold",title:"확대 (Ctrl + 휠 위 또는 Ctrl + +)",children:"+"}),e.jsx("button",{onClick:o,className:"w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:shadow-lg transition-shadow flex items-center justify-center text-lg font-semibold",title:"축소 (Ctrl + 휠 아래 또는 Ctrl + -)",children:"-"}),e.jsx("button",{onClick:x,className:"w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:shadow-lg transition-shadow flex items-center justify-center text-xs font-semibold",title:"100% 크기",children:"1:1"}),e.jsx("button",{onClick:d,className:"w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:shadow-lg transition-shadow flex items-center justify-center text-xs font-semibold",title:"창맞춤",children:"⌂"})]})});pe.displayName="ZoomControls";const gt=()=>{const{currentTool:t}=Y(),{penColor:l,penWidth:s,usePerfectFreehand:r,defaultColors:o,setPenColor:d,setPenWidth:x,setUsePerfectFreehand:j}=Ge();if(t!=="pen"&&t!=="eraser")return null;const v=[2,4,6,8,12];return e.jsx("div",{className:"absolute left-4 top-20 bg-white border border-gray-300 rounded-lg shadow-lg p-4 z-50",style:{minWidth:"280px"},children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:t==="pen"?"필기 설정":"지우개 설정"}),t==="pen"&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"색상"}),e.jsx("div",{className:"grid grid-cols-5 gap-1",children:o.map((g,m)=>e.jsx("button",{className:`w-8 h-8 rounded border-2 ${l===g?"border-blue-500 border-4":"border-gray-300"}`,style:{backgroundColor:g},onClick:()=>d(g),title:g},m))})]}),t==="pen"&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"굵기"}),e.jsx("div",{className:"flex gap-2",children:v.map(g=>e.jsxs("button",{className:`px-3 py-2 rounded text-xs ${s===g?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,onClick:()=>x(g),children:[g,"px"]},g))})]}),t==="pen"&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"렌더링 품질"}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r,onChange:g=>j(g.target.checked),className:"rounded"}),e.jsx("span",{className:"text-xs text-gray-700",children:"고품질 렌더링 (Perfect Freehand)"})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:r?"✨ 압력 감지 및 부드러운 곡선 활성화":"📝 기본 선 렌더링 (빠른 성능)"})]})]})})},yt=()=>{const{initializeFirebaseListeners:t,initializePasswords:l}=G();return f.useEffect(()=>((async()=>{await Ze(),t(),await l()})(),()=>{const{cleanupFirebaseListeners:r}=G.getState();r()}),[t]),e.jsxs("div",{className:"w-screen h-screen overflow-hidden flex",children:[e.jsx("div",{className:"w-72 h-full bg-slate-100/95 backdrop-blur-sm shadow-xl border-r border-slate-200",children:e.jsx(ut,{})}),e.jsxs("main",{className:"flex-1 h-full relative",children:[e.jsx(Ue,{isViewPage:!1}),e.jsx(gt,{})]}),e.jsx(pe,{})]})};export{yt as default};
