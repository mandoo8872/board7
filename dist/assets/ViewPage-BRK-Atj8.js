import{r as l,j as i}from"./index-BAIBKV_r.js";import{a as se,u as ee,c as re,C as le}from"./Canvas-BCQAOIRV.js";const ce=()=>{var J,V,Q,Z,M;const{currentTool:C,setCurrentTool:j,fitToWindow:y,setSelectedObjectId:K}=se(),{addTextObject:S,settings:d}=ee(),{penColor:E,penWidth:p,setPenColor:N,setPenWidth:c}=re(),_=["#000000","#ff0000","#0000ff","#ffff00","#ffffff"],L=(()=>{try{const n=localStorage.getItem("viewFloatingToolbar_position"),e=localStorage.getItem("viewFloatingToolbar_size"),t={x:window.innerWidth-200,y:window.innerHeight-150},s={width:180,height:120};return{position:n?JSON.parse(n):t,size:e?JSON.parse(e):s}}catch{return{position:{x:window.innerWidth-200,y:window.innerHeight-150},size:{width:180,height:120}}}})(),[w,T]=l.useState(L.position),[v,U]=l.useState(L.size);l.useEffect(()=>{const n=A(L.position,L.size);(n.x!==L.position.x||n.y!==L.position.y)&&(T(n),f(n,L.size))},[]);const[D,$]=l.useState(!1),[z,R]=l.useState(!1),[k,q]=l.useState({x:0,y:0}),[F,g]=l.useState(!1),r=l.useRef(null),f=(n,e)=>{try{localStorage.setItem("viewFloatingToolbar_position",JSON.stringify(n)),localStorage.setItem("viewFloatingToolbar_size",JSON.stringify(e))}catch(t){console.warn("Failed to save toolbar settings:",t)}},A=(n,e)=>{const s=e.width*.2,o=e.height*.2,a=window.innerWidth-s,h=window.innerHeight-o,u=-e.width+s,x=-e.height+o;return{x:Math.max(u,Math.min(a,n.x)),y:Math.max(x,Math.min(h,n.y))}},I={admin:{objectCreationPosition:((J=d==null?void 0:d.admin)==null?void 0:J.objectCreationPosition)??{x:200,y:200},defaultBoxWidth:((V=d==null?void 0:d.admin)==null?void 0:V.defaultBoxWidth)??200,defaultBoxHeight:((Q=d==null?void 0:d.admin)==null?void 0:Q.defaultBoxHeight)??60,defaultFontSize:((Z=d==null?void 0:d.admin)==null?void 0:Z.defaultFontSize)??18,defaultCheckboxSettings:((M=d==null?void 0:d.admin)==null?void 0:M.defaultCheckboxSettings)??{checkedColor:"#22c55e",uncheckedColor:"#f3f4f6",checkedBackgroundColor:"#22c55e",uncheckedBackgroundColor:"#f3f4f6",checkedBackgroundOpacity:.2,uncheckedBackgroundOpacity:.1}}};l.useEffect(()=>{const n=o=>{var a;if(D){const h={x:o.clientX-k.x,y:o.clientY-k.y},u=A(h,v);T(u)}if(z){const h=(a=r.current)==null?void 0:a.getBoundingClientRect();if(h){const u=Math.max(120,o.clientX-h.left),x=Math.max(80,o.clientY-h.top),P={width:u,height:x},W=A(w,P);U(P),T(W)}}},e=o=>{var a;if(o.preventDefault(),o.touches.length===1){const h=o.touches[0];if(D){const u={x:h.clientX-k.x,y:h.clientY-k.y},x=A(u,v);T(x)}if(z){const u=(a=r.current)==null?void 0:a.getBoundingClientRect();if(u){const x=Math.max(120,h.clientX-u.left),P=Math.max(80,h.clientY-u.top),W={width:x,height:P},X=A(w,W);U(W),T(X)}}}},t=()=>{(D||z)&&f(w,v),$(!1),R(!1)},s=()=>{(D||z)&&f(w,v),$(!1),R(!1)};return(D||z)&&(document.addEventListener("mousemove",n),document.addEventListener("mouseup",t),document.addEventListener("touchmove",e,{passive:!1}),document.addEventListener("touchend",s)),()=>{document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",t),document.removeEventListener("touchmove",e),document.removeEventListener("touchend",s)}},[D,z,k,w,v]),l.useEffect(()=>{const n=()=>{const e=A(w,v);(e.x!==w.x||e.y!==w.y)&&(T(e),f(e,v))};return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[w,v]);const B=n=>{var s;const e=n.target;if(e.closest("button")||e.closest(".resize-handle"))return;n.preventDefault(),n.stopPropagation(),$(!0);try{n.currentTarget.setPointerCapture(n.pointerId)}catch{}const t=(s=r.current)==null?void 0:s.getBoundingClientRect();t&&q({x:n.clientX-t.left,y:n.clientY-t.top})},te=n=>{n.preventDefault(),n.stopPropagation(),R(!0);try{n.currentTarget.setPointerCapture(n.pointerId)}catch{}},Y=n=>{j(n),n!=="pen"&&g(!1)},ne=async()=>{const{x:n,y:e}=I.admin.objectCreationPosition,{checkedColor:t,uncheckedColor:s,checkedBackgroundColor:o,uncheckedBackgroundColor:a,checkedBackgroundOpacity:h,uncheckedBackgroundOpacity:u}=I.admin.defaultCheckboxSettings,x={x:n,y:e,width:I.admin.defaultBoxWidth,height:I.admin.defaultBoxHeight,text:"새 체크박스",hasCheckbox:!0,checkboxChecked:!1,checkboxCheckedColor:t,checkboxUncheckedColor:s,checkedBackgroundColor:o,uncheckedBackgroundColor:a,checkedBackgroundOpacity:h,uncheckedBackgroundOpacity:u,boxStyle:{backgroundColor:"#ffffff",backgroundOpacity:1,borderColor:"#000000",borderWidth:1,borderRadius:8},fontSize:I.admin.defaultFontSize,textStyle:{color:"#000000",fontFamily:"Arial, sans-serif",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle"},permissions:{movable:!0,resizable:!0,deletable:!0},zIndex:Date.now(),locked:!1,visible:!0,opacity:1,isEditing:!0,lastModified:Date.now()};try{const P=await S(x);K(P),setTimeout(()=>{window.dispatchEvent(new CustomEvent("activateVirtualKeyboard",{detail:{objectId:P}}))},100)}catch(P){console.error("❌ 체크박스 생성 실패:",P)}},ie=n=>{N(n),g(!1)},G=n=>{const e=Math.max(1,Math.min(20,p+n));c(e)},oe=Math.min(v.width/180,v.height/120),m=Math.max(24,Math.min(40,32*oe)),b=m+8;return i.jsxs("div",{ref:r,className:"fixed bg-white bg-opacity-95 rounded-lg shadow-2xl border border-gray-300 select-none cursor-move",style:{left:w.x,top:w.y,width:v.width,height:v.height,zIndex:9999,minWidth:120,minHeight:80,touchAction:"none"},onPointerDown:B,onClick:n=>n.stopPropagation(),children:[i.jsxs("div",{className:"p-2 h-full flex flex-col",children:[i.jsxs("div",{className:"flex flex-wrap gap-1 flex-1 content-start",style:{minHeight:b},children:[i.jsx("button",{onClick:n=>{n.stopPropagation(),Y("select")},className:`rounded transition-all duration-200 flex items-center justify-center ${C==="select"?"bg-blue-500 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,style:{width:b,height:b},title:"선택 도구",children:i.jsx("span",{style:{fontSize:m*.6},children:"👆"})}),i.jsx("button",{onClick:n=>{n.stopPropagation(),Y("pen")},className:`rounded transition-all duration-200 flex items-center justify-center ${C==="pen"?"bg-blue-500 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,style:{width:b,height:b},title:"필기 도구",children:i.jsx("span",{style:{fontSize:m*.6},children:"✏️"})}),i.jsx("button",{onClick:n=>{n.stopPropagation(),Y("eraser")},className:`rounded transition-all duration-200 flex items-center justify-center ${C==="eraser"?"bg-blue-500 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,style:{width:b,height:b},title:"지우개",children:i.jsx("span",{style:{fontSize:m*.6},children:"🧽"})}),i.jsx("button",{onClick:n=>{n.stopPropagation(),ne()},className:"rounded transition-all duration-200 flex items-center justify-center bg-green-500 text-white hover:bg-green-600 shadow-md",style:{width:b,height:b},title:"체크박스 추가",children:i.jsx("span",{style:{fontSize:m*.6},children:"☑️"})}),i.jsx("button",{onClick:n=>{n.stopPropagation(),y()},className:"rounded transition-all duration-200 flex items-center justify-center bg-blue-500 text-white hover:bg-blue-600 shadow-md",style:{width:b,height:b},title:"창맞춤",children:i.jsx("span",{style:{fontSize:m*.6},children:"⌂"})}),C==="pen"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:n=>{n.stopPropagation(),g(!F)},className:"rounded border flex items-center justify-center bg-white hover:bg-gray-50",style:{width:b,height:b},title:"색상 선택",children:i.jsx("div",{className:"rounded",style:{backgroundColor:E,width:m*.6,height:m*.6,border:"1px solid #ccc"}})}),i.jsx("button",{onClick:n=>{n.stopPropagation(),G(1)},className:"rounded bg-gray-100 hover:bg-gray-200 flex items-center justify-center",style:{width:b,height:b},title:"굵기 증가",children:i.jsx("span",{style:{fontSize:m*.5},children:"▲"})}),i.jsx("button",{onClick:n=>{n.stopPropagation(),G(-1)},className:"rounded bg-gray-100 hover:bg-gray-200 flex items-center justify-center",style:{width:b,height:b},title:"굵기 감소",children:i.jsx("span",{style:{fontSize:m*.5},children:"▼"})})]})]}),F&&C==="pen"&&i.jsx("div",{className:"mt-2 p-2 bg-gray-50 rounded border-t",children:i.jsx("div",{className:"flex flex-wrap gap-1 justify-center",children:_.map(n=>i.jsx("button",{onClick:e=>{e.stopPropagation(),ie(n)},className:"rounded border-2 hover:scale-110 transition-transform",style:{backgroundColor:n,borderColor:E===n?"#000":"#ccc",width:Math.max(20,m*.6),height:Math.max(20,m*.6)},title:n},n))})})]}),i.jsx("div",{className:"resize-handle absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",style:{touchAction:"none"},onPointerDown:te,onClick:n=>n.stopPropagation(),children:i.jsx("div",{className:"absolute bottom-1 right-1 w-2 h-2 border-r-2 border-b-2 border-gray-400"})})]})},H=(C,j,y="")=>{const K=["ㄱ","ㄲ","ㄴ","ㄷ","ㄸ","ㄹ","ㅁ","ㅂ","ㅃ","ㅅ","ㅆ","ㅇ","ㅈ","ㅉ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"],S=["ㅏ","ㅐ","ㅑ","ㅒ","ㅓ","ㅔ","ㅕ","ㅖ","ㅗ","ㅘ","ㅙ","ㅚ","ㅛ","ㅜ","ㅝ","ㅞ","ㅟ","ㅠ","ㅡ","ㅢ","ㅣ"],d=["","ㄱ","ㄲ","ㄳ","ㄴ","ㄵ","ㄶ","ㄷ","ㄹ","ㄺ","ㄻ","ㄼ","ㄽ","ㄾ","ㄿ","ㅀ","ㅁ","ㅂ","ㅄ","ㅅ","ㅆ","ㅇ","ㅈ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"],E=K.indexOf(C),p=S.indexOf(j),N=d.indexOf(y);if(E>=0&&p>=0&&N>=0){const c=44032+(E*21+p)*28+N;return String.fromCharCode(c)}return C+j+y},de=()=>{const{textObjects:C,updateTextObject:j}=ee(),{selectedObjectId:y}=se(),S=(()=>{try{const e=localStorage.getItem("viewVirtualKeyboard_position"),t=localStorage.getItem("viewVirtualKeyboard_size"),s={x:50,y:window.innerHeight-400},o={width:700,height:350};return{position:e?JSON.parse(e):s,size:t?JSON.parse(t):o}}catch{return{position:{x:50,y:window.innerHeight-400},size:{width:700,height:350}}}})(),[d,E]=l.useState(!1),[p,N]=l.useState(S.position),[c,_]=l.useState(S.size);l.useEffect(()=>{const e=B(S.position,S.size);(e.x!==S.position.x||e.y!==S.position.y)&&(N(e),I(e,S.size))},[]);const[O,L]=l.useState(!1),[w,T]=l.useState(!1),[v,U]=l.useState({x:0,y:0}),[D,$]=l.useState(!0),[z,R]=l.useState(!1),[k,q]=l.useState(!1),[F,g]=l.useState(""),[r,f]=l.useState({initial:"",middle:"",final:"",isAssembling:!1}),A=l.useRef(null),I=(e,t)=>{try{localStorage.setItem("viewVirtualKeyboard_position",JSON.stringify(e)),localStorage.setItem("viewVirtualKeyboard_size",JSON.stringify(t))}catch(s){console.warn("Failed to save keyboard settings:",s)}},B=(e,t)=>{const o=t.width*.2,a=t.height*.2,h=window.innerWidth-o,u=window.innerHeight-a,x=-t.width+o,P=-t.height+a;return{x:Math.max(x,Math.min(h,e.x)),y:Math.max(P,Math.min(u,e.y))}},te={row1:["ㅂ","ㅈ","ㄷ","ㄱ","ㅅ","ㅛ","ㅕ","ㅑ","ㅐ","ㅔ"],row2:["ㅁ","ㄴ","ㅇ","ㄹ","ㅎ","ㅗ","ㅓ","ㅏ","ㅣ"],row3:["ㅋ","ㅌ","ㅊ","ㅍ","ㅠ","ㅜ","ㅡ"],numbers:["1","2","3","4","5","6","7","8","9","0"]},Y={row1:["ㅃ","ㅉ","ㄸ","ㄲ","ㅆ","ㅛ","ㅕ","ㅑ","ㅒ","ㅖ"],row2:["ㅁ","ㄴ","ㅇ","ㄹ","ㅎ","ㅗ","ㅓ","ㅏ","ㅣ"],row3:["ㅋ","ㅌ","ㅊ","ㅍ","ㅠ","ㅜ","ㅡ"],numbers:["!","@","#","$","%","^","&","*","(",")"]},ne={row1:["q","w","e","r","t","y","u","i","o","p"],row2:["a","s","d","f","g","h","j","k","l"],row3:["z","x","c","v","b","n","m"],numbers:["1","2","3","4","5","6","7","8","9","0"]},ie={row1:["Q","W","E","R","T","Y","U","I","O","P"],row2:["A","S","D","F","G","H","J","K","L"],row3:["Z","X","C","V","B","N","M"],numbers:["!","@","#","$","%","^","&","*","(",")"]};l.useEffect(()=>{const e=t=>{var o;f({initial:"",middle:"",final:"",isAssembling:!1});const s=y||((o=t==null?void 0:t.detail)==null?void 0:o.objectId);if(s){const a=C.find(h=>h.id===s);g(a&&a.text||"")}else g("");E(!0)};return window.addEventListener("activateVirtualKeyboard",e),()=>{window.removeEventListener("activateVirtualKeyboard",e)}},[y,C]),l.useEffect(()=>{d&&(y||(E(!1),g(""),f({initial:"",middle:"",final:"",isAssembling:!1})))},[y,d]),l.useEffect(()=>{const e=a=>{var h;if(O){const u={x:a.clientX-v.x,y:a.clientY-v.y},x=B(u,c);N(x)}if(w){const u=(h=A.current)==null?void 0:h.getBoundingClientRect();if(u){const x=Math.max(500,a.clientX-u.left),P=Math.max(300,a.clientY-u.top),W={width:x,height:P},X=B(p,W);_(W),N(X)}}},t=a=>{var h;if(a.preventDefault(),a.touches.length===1){const u=a.touches[0];if(O){const x={x:u.clientX-v.x,y:u.clientY-v.y},P=B(x,c);N(P)}if(w){const x=(h=A.current)==null?void 0:h.getBoundingClientRect();if(x){const P=Math.max(500,u.clientX-x.left),W=Math.max(300,u.clientY-x.top),X={width:P,height:W},ae=B(p,X);_(X),N(ae)}}}},s=()=>{(O||w)&&I(p,c),L(!1),T(!1)},o=()=>{(O||w)&&I(p,c),L(!1),T(!1)};return(O||w)&&(document.addEventListener("mousemove",e),document.addEventListener("mouseup",s),document.addEventListener("touchmove",t,{passive:!1}),document.addEventListener("touchend",o)),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",s),document.removeEventListener("touchmove",t),document.removeEventListener("touchend",o)}},[O,w,v,p,c]),l.useEffect(()=>{const e=()=>{const t=B(p,c);(t.x!==p.x||t.y!==p.y)&&(N(t),I(t,c))};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[p,c]);const G=l.useCallback(e=>{var s;e.preventDefault(),e.stopPropagation(),L(!0);try{e.currentTarget.setPointerCapture(e.pointerId)}catch{}const t=(s=A.current)==null?void 0:s.getBoundingClientRect();t&&U({x:e.clientX-t.left,y:e.clientY-t.top})},[]),oe=l.useCallback(e=>{e.preventDefault(),e.stopPropagation(),T(!0);try{e.currentTarget.setPointerCapture(e.pointerId)}catch{}},[]),m=(e,t)=>{if(e.preventDefault(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),t==="Backspace")g(s=>{if(s.length===0)return s;if(r.isAssembling)if(r.final){f(a=>({...a,final:""}));const o=H(r.initial,r.middle);return s.slice(0,-1)+o}else{if(r.middle)return f(o=>({...o,middle:"",isAssembling:!1})),s.slice(0,-1)+r.initial;if(r.initial)return f({initial:"",middle:"",final:"",isAssembling:!1}),s.slice(0,-1)}else return f({initial:"",middle:"",final:"",isAssembling:!1}),s.slice(0,-1);return s});else if(t==="ClearAll")g(""),f({initial:"",middle:"",final:"",isAssembling:!1});else if(t==="Space")g(s=>s+" "),f({initial:"",middle:"",final:"",isAssembling:!1});else if(t==="Enter"){J();return}else t==="Shift"?z&&!k?q(!0):k?(R(!1),q(!1)):R(!0):t==="한/영"?($(!D),f({initial:"",middle:"",final:"",isAssembling:!1})):(D?b(t):g(s=>s+t),z&&!k&&R(!1))},b=e=>{const t="ㄱㄲㄴㄷㄸㄹㅁㅂㅃㅅㅆㅇㅈㅉㅊㅋㅌㅍㅎ".includes(e),s="ㅏㅑㅓㅕㅗㅛㅜㅠㅡㅣㅐㅔㅒㅖ".includes(e);if(t)if(!r.isAssembling)f({initial:e,middle:"",final:"",isAssembling:!0}),g(o=>o+e);else if(r.initial&&r.middle&&!r.final){f(a=>({...a,final:e}));const o=H(r.initial,r.middle,e);g(a=>a.slice(0,-1)+o)}else if(r.initial&&r.middle&&r.final){const o=H(r.initial,r.middle,r.final);g(a=>a.slice(0,-1)+o+e),f({initial:e,middle:"",final:"",isAssembling:!0})}else{if(r.initial&&r.middle){const o=H(r.initial,r.middle);g(a=>a.slice(0,-1)+o+e)}else g(o=>o+e);f({initial:e,middle:"",final:"",isAssembling:!0})}else if(s)if(r.isAssembling&&r.initial&&!r.middle){f(a=>({...a,middle:e}));const o=H(r.initial,e);g(a=>a.slice(0,-1)+o)}else if(r.initial&&r.middle&&r.final){const o=r.final,a=H(r.initial,r.middle),h=H(o,e);g(u=>u.slice(0,-1)+a+h),f({initial:o,middle:e,final:"",isAssembling:!0})}else g(o=>o+e),f({initial:"",middle:"",final:"",isAssembling:!1});else g(o=>o+e),f({initial:"",middle:"",final:"",isAssembling:!1})},J=l.useCallback(()=>{y&&j(y,{text:F,isEditing:!1}),E(!1),g(""),f({initial:"",middle:"",final:"",isAssembling:!1})},[y,F,j]),V=l.useCallback(()=>{y&&j(y,{isEditing:!1}),E(!1),g(""),f({initial:"",middle:"",final:"",isAssembling:!1})},[y,j]),Q=l.useCallback(()=>{V()},[V]);l.useEffect(()=>{if(!d)return;const e=t=>{t.key==="Escape"&&(t.preventDefault(),V())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[d,V]);const Z=()=>D?z||k?Y:te:z||k?ie:ne,M=e=>{const t="bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors border border-gray-600";let s="text-sm px-2 py-2";return c.width<600?s="text-xs px-1 py-1":c.width>=800&&(s="text-base px-3 py-2"),`${t} ${s}`};if(!d)return null;const n=Z();return i.jsxs("div",{ref:A,"data-virtual-keyboard":"true",className:"fixed bg-gray-800 bg-opacity-95 rounded-lg shadow-2xl border border-gray-600 select-none",style:{left:p.x,top:p.y,width:c.width,height:c.height,zIndex:9999},onClick:e=>{e.stopPropagation();const t=e.target;if(t.tagName==="BUTTON"||t.closest("button")){const o=document.activeElement;o&&(o.hasAttribute("data-canvas-container")||o.tabIndex===0&&o.tagName==="DIV")&&o.blur()}},onPointerDown:e=>e.stopPropagation(),children:[i.jsx("div",{className:"bg-gray-700 px-3 py-2 rounded-t-lg border-b border-gray-600",style:{cursor:O?"grabbing":"grab",touchAction:"none"},onPointerDown:G,onClick:e=>e.stopPropagation(),children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium text-white",children:"가상 키보드"}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:e=>{e.stopPropagation(),$(!D)},className:"text-xs px-2 py-1 bg-blue-600 hover:bg-blue-500 rounded text-white",children:D?"한":"A"}),i.jsx("button",{onClick:e=>{e.stopPropagation(),Q()},className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-500 rounded text-white",children:"✕"})]})]})}),i.jsx("div",{className:"p-2 border-b border-gray-600",onClick:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:e=>{e.stopPropagation(),m(e,"ClearAll")},onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:"px-2 py-1 bg-red-600 hover:bg-red-500 text-white rounded text-xs font-medium transition-colors whitespace-nowrap",title:"전체 삭제",children:"전체삭제"}),i.jsx("div",{className:"flex-1 bg-white text-black p-2 rounded text-sm min-h-[30px] max-h-[60px] overflow-auto",onClick:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),children:F||"여기에 입력된 텍스트가 표시됩니다..."}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("button",{onClick:e=>{e.stopPropagation(),J()},onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white rounded text-xs font-medium transition-colors",children:"입력"}),i.jsx("button",{onClick:e=>{e.stopPropagation(),V()},onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:"px-3 py-1 bg-gray-600 hover:bg-gray-500 text-white rounded text-xs font-medium transition-colors",children:"취소"})]})]})}),i.jsxs("div",{className:"p-2 flex flex-col gap-1 flex-1 overflow-hidden",onClick:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),children:[i.jsxs("div",{className:"flex gap-1 justify-center",children:[n.numbers.map(e=>i.jsx("button",{onClick:t=>m(t,e),onPointerDown:t=>t.stopPropagation(),onMouseDown:t=>t.stopPropagation(),className:M(),style:{minWidth:`${Math.max(30,c.width/15)}px`},children:e},e)),i.jsx("button",{onClick:e=>m(e,"Backspace"),onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:`${M()} bg-red-600 hover:bg-red-500`,style:{minWidth:`${Math.max(50,c.width/10)}px`},children:"⌫"})]}),i.jsx("div",{className:"flex gap-1 justify-center",children:n.row1.map(e=>i.jsx("button",{onClick:t=>m(t,e),onPointerDown:t=>t.stopPropagation(),onMouseDown:t=>t.stopPropagation(),className:M(),style:{minWidth:`${Math.max(30,c.width/12)}px`},children:e},e))}),i.jsx("div",{className:"flex gap-1 justify-center",children:n.row2.map(e=>i.jsx("button",{onClick:t=>m(t,e),onPointerDown:t=>t.stopPropagation(),onMouseDown:t=>t.stopPropagation(),className:M(),style:{minWidth:`${Math.max(30,c.width/11)}px`},children:e},e))}),i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsxs("button",{onClick:e=>m(e,"Shift"),onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:`${M()} ${z||k?"bg-blue-600":""}`,style:{minWidth:`${Math.max(50,c.width/10)}px`},children:["⇧",k?"🔒":""]}),n.row3.map(e=>i.jsx("button",{onClick:t=>m(t,e),onPointerDown:t=>t.stopPropagation(),onMouseDown:t=>t.stopPropagation(),className:M(),style:{minWidth:`${Math.max(30,c.width/12)}px`},children:e},e))]}),i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{onClick:e=>m(e,"한/영"),onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:M(),style:{minWidth:`${Math.max(60,c.width/8)}px`},children:"한/영"}),i.jsx("button",{onClick:e=>m(e,"Space"),onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:M(),style:{minWidth:`${Math.max(200,c.width/3)}px`},children:"스페이스"}),i.jsx("button",{onClick:e=>m(e,"Enter"),onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:`${M()} bg-blue-600 hover:bg-blue-500`,style:{minWidth:`${Math.max(60,c.width/8)}px`},children:"완료"})]})]}),i.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",style:{touchAction:"none"},onPointerDown:oe,onClick:e=>e.stopPropagation(),children:i.jsx("div",{className:"absolute bottom-1 right-1 w-2 h-2 border-r-2 border-b-2 border-gray-400",onClick:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation()})})]})},fe=()=>{var E;const{initializeFirebaseListeners:C,settings:j}=ee(),y=((E=j==null?void 0:j.view)==null?void 0:E.virtualKeyboardEnabled)??!0,[K,S]=l.useState(!0),d=l.useRef(null);return l.useEffect(()=>(C(),()=>{const{cleanupFirebaseListeners:p}=ee.getState();p()}),[C]),l.useEffect(()=>{const p=()=>{d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{S(!1)},1e4)},N=()=>{S(!0),p()},c=()=>{N()};return p(),window.addEventListener("mousemove",c),window.addEventListener("mousedown",c),window.addEventListener("click",c),window.addEventListener("touchstart",c),()=>{d.current&&clearTimeout(d.current),window.removeEventListener("mousemove",c),window.removeEventListener("mousedown",c),window.removeEventListener("click",c),window.removeEventListener("touchstart",c)}},[]),i.jsxs("div",{className:"w-screen h-screen overflow-hidden relative",children:[i.jsx("main",{className:"w-full h-full",children:i.jsx(le,{isViewPage:!0})}),K&&i.jsx(ce,{}),y&&i.jsx(de,{})]})};export{fe as default};
