import{r,j as n}from"./index-DK8LjcLZ.js";import{a as ne,u as q,b as oe,C as se}from"./Canvas-Dh335QiJ.js";const ae=()=>{var X,L,_,U,j;const{currentTool:b,setCurrentTool:y,fitToWindow:p,setSelectedObjectId:B}=ne(),{addTextObject:w,settings:d}=q(),{penColor:P,penWidth:m,setPenColor:N,setPenWidth:c}=oe(),G=["#000000","#ff0000","#0000ff","#ffff00","#ffffff"],D=(()=>{try{const i=localStorage.getItem("viewFloatingToolbar_position"),e=localStorage.getItem("viewFloatingToolbar_size"),t={x:window.innerWidth-200,y:window.innerHeight-150},s={width:180,height:120};return{position:i?JSON.parse(i):t,size:e?JSON.parse(e):s}}catch{return{position:{x:window.innerWidth-200,y:window.innerHeight-150},size:{width:180,height:120}}}})(),[v,O]=r.useState(D.position),[C,Q]=r.useState(D.size);r.useEffect(()=>{const i=M(D.position,D.size);(i.x!==D.position.x||i.y!==D.position.y)&&(O(i),h(i,D.size))},[]);const[z,$]=r.useState(!1),[E,R]=r.useState(!1),[k,Y]=r.useState({x:0,y:0}),[H,u]=r.useState(!1),a=r.useRef(null),h=(i,e)=>{try{localStorage.setItem("viewFloatingToolbar_position",JSON.stringify(i)),localStorage.setItem("viewFloatingToolbar_size",JSON.stringify(e))}catch(t){console.warn("Failed to save toolbar settings:",t)}},M=(i,e)=>{const s=e.width*.2,o=e.height*.2,l=window.innerWidth-s,x=window.innerHeight-o,S=-e.width+s,I=-e.height+o;return{x:Math.max(S,Math.min(l,i.x)),y:Math.max(I,Math.min(x,i.y))}},A={admin:{objectCreationPosition:((X=d==null?void 0:d.admin)==null?void 0:X.objectCreationPosition)??{x:200,y:200},defaultBoxWidth:((L=d==null?void 0:d.admin)==null?void 0:L.defaultBoxWidth)??200,defaultBoxHeight:((_=d==null?void 0:d.admin)==null?void 0:_.defaultBoxHeight)??60,defaultFontSize:((U=d==null?void 0:d.admin)==null?void 0:U.defaultFontSize)??18,defaultCheckboxSettings:((j=d==null?void 0:d.admin)==null?void 0:j.defaultCheckboxSettings)??{checkedColor:"#22c55e",uncheckedColor:"#f3f4f6",checkedBackgroundColor:"#22c55e",uncheckedBackgroundColor:"#f3f4f6",checkedBackgroundOpacity:.2,uncheckedBackgroundOpacity:.1}}};r.useEffect(()=>{if(!z&&!E)return;const i=t=>{var s;if(z){const o={x:t.clientX-k.x,y:t.clientY-k.y},l=M(o,C);O(l)}if(E){const o=(s=a.current)==null?void 0:s.getBoundingClientRect();if(o){const l=Math.max(120,t.clientX-o.left),x=Math.max(80,t.clientY-o.top),S={width:l,height:x},I=M(v,S);Q(S),O(I)}}},e=t=>{if((z||E)&&h(v,C),$(!1),R(!1),a.current)try{a.current.releasePointerCapture(t.pointerId)}catch{}};return document.addEventListener("pointermove",i),document.addEventListener("pointerup",e),()=>{document.removeEventListener("pointermove",i),document.removeEventListener("pointerup",e)}},[z,E,k]),r.useEffect(()=>{const i=()=>{const e=M(v,C);(e.x!==v.x||e.y!==v.y)&&(O(e),h(e,C))};return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[v,C]);const K=i=>{var s;const e=i.target;if(e.closest("button")||e.closest(".resize-handle"))return;i.preventDefault(),i.stopPropagation(),$(!0);try{i.currentTarget.setPointerCapture(i.pointerId)}catch{}const t=(s=a.current)==null?void 0:s.getBoundingClientRect();t&&Y({x:i.clientX-t.left,y:i.clientY-t.top})},Z=i=>{i.preventDefault(),i.stopPropagation(),R(!0);try{i.currentTarget.setPointerCapture(i.pointerId)}catch{}},F=i=>{y(i),i!=="pen"&&u(!1)},ee=async()=>{const{x:i,y:e}=A.admin.objectCreationPosition,{checkedColor:t,uncheckedColor:s,checkedBackgroundColor:o,uncheckedBackgroundColor:l,checkedBackgroundOpacity:x,uncheckedBackgroundOpacity:S}=A.admin.defaultCheckboxSettings,I={x:i,y:e,width:A.admin.defaultBoxWidth,height:A.admin.defaultBoxHeight,text:"새 체크박스",hasCheckbox:!0,checkboxChecked:!1,checkboxCheckedColor:t,checkboxUncheckedColor:s,checkedBackgroundColor:o,uncheckedBackgroundColor:l,checkedBackgroundOpacity:x,uncheckedBackgroundOpacity:S,boxStyle:{backgroundColor:"#ffffff",backgroundOpacity:1,borderColor:"#000000",borderWidth:1,borderRadius:8},fontSize:A.admin.defaultFontSize,textStyle:{color:"#000000",fontFamily:"Arial, sans-serif",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle"},permissions:{movable:!0,resizable:!0,deletable:!0},zIndex:Date.now(),locked:!1,visible:!0,opacity:1,isEditing:!0,lastModified:Date.now()};try{const T=await w(I);B(T),setTimeout(()=>{window.dispatchEvent(new CustomEvent("activateVirtualKeyboard",{detail:{objectId:T}}))},100)}catch(T){console.error("❌ 체크박스 생성 실패:",T)}},te=i=>{N(i),u(!1)},J=i=>{const e=Math.max(1,Math.min(20,m+i));c(e)},ie=Math.min(C.width/180,C.height/120),g=Math.max(24,Math.min(40,32*ie)),f=g+8;return n.jsxs("div",{ref:a,"data-floating-toolbar":"true",className:"fixed bg-white bg-opacity-95 rounded-lg shadow-2xl border border-gray-300 select-none cursor-move",style:{left:v.x,top:v.y,width:C.width,height:C.height,zIndex:9999,minWidth:120,minHeight:80,touchAction:"none"},onPointerDown:K,onClick:i=>i.stopPropagation(),children:[n.jsxs("div",{className:"p-2 h-full flex flex-col",children:[n.jsxs("div",{className:"flex flex-wrap gap-1 flex-1 content-start",style:{minHeight:f},children:[n.jsx("button",{onClick:i=>{i.stopPropagation(),F("select")},className:`rounded transition-all duration-200 flex items-center justify-center ${b==="select"?"bg-blue-500 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,style:{width:f,height:f},title:"선택 도구",children:n.jsx("span",{style:{fontSize:g*.6},children:"👆"})}),n.jsx("button",{onClick:i=>{i.stopPropagation(),F("pen")},className:`rounded transition-all duration-200 flex items-center justify-center ${b==="pen"?"bg-blue-500 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,style:{width:f,height:f},title:"필기 도구",children:n.jsx("span",{style:{fontSize:g*.6},children:"✏️"})}),n.jsx("button",{onClick:i=>{i.stopPropagation(),F("eraser")},className:`rounded transition-all duration-200 flex items-center justify-center ${b==="eraser"?"bg-blue-500 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,style:{width:f,height:f},title:"지우개",children:n.jsx("span",{style:{fontSize:g*.6},children:"🧽"})}),n.jsx("button",{onClick:i=>{i.stopPropagation(),ee()},className:"rounded transition-all duration-200 flex items-center justify-center bg-green-500 text-white hover:bg-green-600 shadow-md",style:{width:f,height:f},title:"체크박스 추가",children:n.jsx("span",{style:{fontSize:g*.6},children:"☑️"})}),n.jsx("button",{onClick:i=>{i.stopPropagation(),p()},className:"rounded transition-all duration-200 flex items-center justify-center bg-blue-500 text-white hover:bg-blue-600 shadow-md",style:{width:f,height:f},title:"창맞춤",children:n.jsx("span",{style:{fontSize:g*.6},children:"⌂"})}),b==="pen"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:i=>{i.stopPropagation(),u(!H)},className:"rounded border flex items-center justify-center bg-white hover:bg-gray-50",style:{width:f,height:f},title:"색상 선택",children:n.jsx("div",{className:"rounded",style:{backgroundColor:P,width:g*.6,height:g*.6,border:"1px solid #ccc"}})}),n.jsx("button",{onClick:i=>{i.stopPropagation(),J(1)},className:"rounded bg-gray-100 hover:bg-gray-200 flex items-center justify-center",style:{width:f,height:f},title:"굵기 증가",children:n.jsx("span",{style:{fontSize:g*.5},children:"▲"})}),n.jsx("button",{onClick:i=>{i.stopPropagation(),J(-1)},className:"rounded bg-gray-100 hover:bg-gray-200 flex items-center justify-center",style:{width:f,height:f},title:"굵기 감소",children:n.jsx("span",{style:{fontSize:g*.5},children:"▼"})})]})]}),H&&b==="pen"&&n.jsx("div",{className:"mt-2 p-2 bg-gray-50 rounded border-t",children:n.jsx("div",{className:"flex flex-wrap gap-1 justify-center",children:G.map(i=>n.jsx("button",{onClick:e=>{e.stopPropagation(),te(i)},className:"rounded border-2 hover:scale-110 transition-transform",style:{backgroundColor:i,borderColor:P===i?"#000":"#ccc",width:Math.max(20,g*.6),height:Math.max(20,g*.6)},title:i},i))})})]}),n.jsx("div",{className:"resize-handle absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",style:{touchAction:"none"},onPointerDown:Z,onClick:i=>i.stopPropagation(),children:n.jsx("div",{className:"absolute bottom-1 right-1 w-2 h-2 border-r-2 border-b-2 border-gray-400"})})]})},W=(b,y,p="")=>{const B=["ㄱ","ㄲ","ㄴ","ㄷ","ㄸ","ㄹ","ㅁ","ㅂ","ㅃ","ㅅ","ㅆ","ㅇ","ㅈ","ㅉ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"],w=["ㅏ","ㅐ","ㅑ","ㅒ","ㅓ","ㅔ","ㅕ","ㅖ","ㅗ","ㅘ","ㅙ","ㅚ","ㅛ","ㅜ","ㅝ","ㅞ","ㅟ","ㅠ","ㅡ","ㅢ","ㅣ"],d=["","ㄱ","ㄲ","ㄳ","ㄴ","ㄵ","ㄶ","ㄷ","ㄹ","ㄺ","ㄻ","ㄼ","ㄽ","ㄾ","ㄿ","ㅀ","ㅁ","ㅂ","ㅄ","ㅅ","ㅆ","ㅇ","ㅈ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"],P=B.indexOf(b),m=w.indexOf(y),N=d.indexOf(p);if(P>=0&&m>=0&&N>=0){const c=44032+(P*21+m)*28+N;return String.fromCharCode(c)}return b+y+p},re=()=>{const{textObjects:b,updateTextObject:y}=q(),{selectedObjectId:p}=ne(),w=(()=>{try{const e=localStorage.getItem("viewVirtualKeyboard_position"),t=localStorage.getItem("viewVirtualKeyboard_size"),s={x:50,y:window.innerHeight-400},o={width:700,height:350};return{position:e?JSON.parse(e):s,size:t?JSON.parse(t):o}}catch{return{position:{x:50,y:window.innerHeight-400},size:{width:700,height:350}}}})(),[d,P]=r.useState(!1),[m,N]=r.useState(w.position),[c,G]=r.useState(w.size);r.useEffect(()=>{const e=K(w.position,w.size);(e.x!==w.position.x||e.y!==w.position.y)&&(N(e),A(e,w.size))},[]);const[V,D]=r.useState(!1),[v,O]=r.useState(!1),[C,Q]=r.useState({x:0,y:0}),[z,$]=r.useState(!0),[E,R]=r.useState(!1),[k,Y]=r.useState(!1),[H,u]=r.useState(""),[a,h]=r.useState({initial:"",middle:"",final:"",isAssembling:!1}),M=r.useRef(null),A=(e,t)=>{try{localStorage.setItem("viewVirtualKeyboard_position",JSON.stringify(e)),localStorage.setItem("viewVirtualKeyboard_size",JSON.stringify(t))}catch(s){console.warn("Failed to save keyboard settings:",s)}},K=(e,t)=>{const o=t.width*.2,l=t.height*.2,x=window.innerWidth-o,S=window.innerHeight-l,I=-t.width+o,T=-t.height+l;return{x:Math.max(I,Math.min(x,e.x)),y:Math.max(T,Math.min(S,e.y))}},Z={row1:["ㅂ","ㅈ","ㄷ","ㄱ","ㅅ","ㅛ","ㅕ","ㅑ","ㅐ","ㅔ"],row2:["ㅁ","ㄴ","ㅇ","ㄹ","ㅎ","ㅗ","ㅓ","ㅏ","ㅣ"],row3:["ㅋ","ㅌ","ㅊ","ㅍ","ㅠ","ㅜ","ㅡ"],numbers:["1","2","3","4","5","6","7","8","9","0"]},F={row1:["ㅃ","ㅉ","ㄸ","ㄲ","ㅆ","ㅛ","ㅕ","ㅑ","ㅒ","ㅖ"],row2:["ㅁ","ㄴ","ㅇ","ㄹ","ㅎ","ㅗ","ㅓ","ㅏ","ㅣ"],row3:["ㅋ","ㅌ","ㅊ","ㅍ","ㅠ","ㅜ","ㅡ"],numbers:["!","@","#","$","%","^","&","*","(",")"]},ee={row1:["q","w","e","r","t","y","u","i","o","p"],row2:["a","s","d","f","g","h","j","k","l"],row3:["z","x","c","v","b","n","m"],numbers:["1","2","3","4","5","6","7","8","9","0"]},te={row1:["Q","W","E","R","T","Y","U","I","O","P"],row2:["A","S","D","F","G","H","J","K","L"],row3:["Z","X","C","V","B","N","M"],numbers:["!","@","#","$","%","^","&","*","(",")"]};r.useEffect(()=>{const e=t=>{var o;h({initial:"",middle:"",final:"",isAssembling:!1});const s=p||((o=t==null?void 0:t.detail)==null?void 0:o.objectId);if(s){const l=b.find(x=>x.id===s);u(l&&l.text||"")}else u("");P(!0)};return window.addEventListener("activateVirtualKeyboard",e),()=>{window.removeEventListener("activateVirtualKeyboard",e)}},[p,b]),r.useEffect(()=>{d&&(p||(P(!1),u(""),h({initial:"",middle:"",final:"",isAssembling:!1})))},[p,d]),r.useEffect(()=>{if(!V&&!v)return;const e=s=>{var o;if(V){const l={x:s.clientX-C.x,y:s.clientY-C.y},x=K(l,c);N(x)}if(v){const l=(o=M.current)==null?void 0:o.getBoundingClientRect();if(l){const x=Math.max(500,s.clientX-l.left),S=Math.max(300,s.clientY-l.top),I={width:x,height:S},T=K(m,I);G(I),N(T)}}},t=s=>{if((V||v)&&A(m,c),D(!1),O(!1),M.current)try{M.current.releasePointerCapture(s.pointerId)}catch{}};return document.addEventListener("pointermove",e),document.addEventListener("pointerup",t),()=>{document.removeEventListener("pointermove",e),document.removeEventListener("pointerup",t)}},[V,v,C]),r.useEffect(()=>{const e=()=>{const t=K(m,c);(t.x!==m.x||t.y!==m.y)&&(N(t),A(t,c))};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[m,c]);const J=r.useCallback(e=>{var s;e.preventDefault(),e.stopPropagation(),D(!0);try{e.currentTarget.setPointerCapture(e.pointerId)}catch{}const t=(s=M.current)==null?void 0:s.getBoundingClientRect();t&&Q({x:e.clientX-t.left,y:e.clientY-t.top})},[]),ie=r.useCallback(e=>{e.preventDefault(),e.stopPropagation(),O(!0);try{e.currentTarget.setPointerCapture(e.pointerId)}catch{}},[]),g=(e,t)=>{if(e.preventDefault(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),t==="Backspace")u(s=>{if(s.length===0)return s;if(a.isAssembling)if(a.final){h(l=>({...l,final:""}));const o=W(a.initial,a.middle);return s.slice(0,-1)+o}else{if(a.middle)return h(o=>({...o,middle:"",isAssembling:!1})),s.slice(0,-1)+a.initial;if(a.initial)return h({initial:"",middle:"",final:"",isAssembling:!1}),s.slice(0,-1)}else return h({initial:"",middle:"",final:"",isAssembling:!1}),s.slice(0,-1);return s});else if(t==="ClearAll")u(""),h({initial:"",middle:"",final:"",isAssembling:!1});else if(t==="Space")u(s=>s+" "),h({initial:"",middle:"",final:"",isAssembling:!1});else if(t==="Enter"){X();return}else t==="Shift"?E&&!k?Y(!0):k?(R(!1),Y(!1)):R(!0):t==="한/영"?($(!z),h({initial:"",middle:"",final:"",isAssembling:!1})):(z?f(t):u(s=>s+t),E&&!k&&R(!1))},f=e=>{const t="ㄱㄲㄴㄷㄸㄹㅁㅂㅃㅅㅆㅇㅈㅉㅊㅋㅌㅍㅎ".includes(e),s="ㅏㅑㅓㅕㅗㅛㅜㅠㅡㅣㅐㅔㅒㅖ".includes(e);if(t)if(!a.isAssembling)h({initial:e,middle:"",final:"",isAssembling:!0}),u(o=>o+e);else if(a.initial&&a.middle&&!a.final){h(l=>({...l,final:e}));const o=W(a.initial,a.middle,e);u(l=>l.slice(0,-1)+o)}else if(a.initial&&a.middle&&a.final){const o=W(a.initial,a.middle,a.final);u(l=>l.slice(0,-1)+o+e),h({initial:e,middle:"",final:"",isAssembling:!0})}else{if(a.initial&&a.middle){const o=W(a.initial,a.middle);u(l=>l.slice(0,-1)+o+e)}else u(o=>o+e);h({initial:e,middle:"",final:"",isAssembling:!0})}else if(s)if(a.isAssembling&&a.initial&&!a.middle){h(l=>({...l,middle:e}));const o=W(a.initial,e);u(l=>l.slice(0,-1)+o)}else if(a.initial&&a.middle&&a.final){const o=a.final,l=W(a.initial,a.middle),x=W(o,e);u(S=>S.slice(0,-1)+l+x),h({initial:o,middle:e,final:"",isAssembling:!0})}else u(o=>o+e),h({initial:"",middle:"",final:"",isAssembling:!1});else u(o=>o+e),h({initial:"",middle:"",final:"",isAssembling:!1})},X=r.useCallback(()=>{p&&y(p,{text:H,isEditing:!1}),P(!1),u(""),h({initial:"",middle:"",final:"",isAssembling:!1})},[p,H,y]),L=r.useCallback(()=>{p&&y(p,{isEditing:!1}),P(!1),u(""),h({initial:"",middle:"",final:"",isAssembling:!1})},[p,y]),_=r.useCallback(()=>{L()},[L]);r.useEffect(()=>{if(!d)return;const e=t=>{t.key==="Escape"&&(t.preventDefault(),L())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[d,L]);const U=()=>z?E||k?F:Z:E||k?te:ee,j=e=>{const t="bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors border border-gray-600";let s="text-sm px-2 py-2";return c.width<600?s="text-xs px-1 py-1":c.width>=800&&(s="text-base px-3 py-2"),`${t} ${s}`};if(!d)return null;const i=U();return n.jsxs("div",{ref:M,"data-virtual-keyboard":"true",className:"fixed bg-gray-800 bg-opacity-95 rounded-lg shadow-2xl border border-gray-600 select-none",style:{left:m.x,top:m.y,width:c.width,height:c.height,zIndex:9999},onClick:e=>{e.stopPropagation();const t=e.target;if(t.tagName==="BUTTON"||t.closest("button")){const o=document.activeElement;o&&(o.hasAttribute("data-canvas-container")||o.tabIndex===0&&o.tagName==="DIV")&&o.blur()}},onPointerDown:e=>e.stopPropagation(),children:[n.jsx("div",{className:"bg-gray-700 px-3 py-2 rounded-t-lg border-b border-gray-600",style:{cursor:V?"grabbing":"grab",touchAction:"none"},onPointerDown:J,onClick:e=>e.stopPropagation(),children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm font-medium text-white",children:"가상 키보드"}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx("button",{onClick:e=>{e.stopPropagation(),$(!z)},className:"text-xs px-2 py-1 bg-blue-600 hover:bg-blue-500 rounded text-white",children:z?"한":"A"}),n.jsx("button",{onClick:e=>{e.stopPropagation(),_()},className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-500 rounded text-white",children:"✕"})]})]})}),n.jsx("div",{className:"p-2 border-b border-gray-600",onClick:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),children:n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:e=>{e.stopPropagation(),g(e,"ClearAll")},onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:"px-2 py-1 bg-red-600 hover:bg-red-500 text-white rounded text-xs font-medium transition-colors whitespace-nowrap",title:"전체 삭제",children:"전체삭제"}),n.jsx("div",{className:"flex-1 bg-white text-black p-2 rounded text-sm min-h-[30px] max-h-[60px] overflow-auto",onClick:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),children:H||"여기에 입력된 텍스트가 표시됩니다..."}),n.jsxs("div",{className:"flex flex-col gap-1",children:[n.jsx("button",{onClick:e=>{e.stopPropagation(),X()},onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:"px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white rounded text-xs font-medium transition-colors",children:"입력"}),n.jsx("button",{onClick:e=>{e.stopPropagation(),L()},onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:"px-3 py-1 bg-gray-600 hover:bg-gray-500 text-white rounded text-xs font-medium transition-colors",children:"취소"})]})]})}),n.jsxs("div",{className:"p-2 flex flex-col gap-1 flex-1 overflow-hidden",onClick:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),children:[n.jsxs("div",{className:"flex gap-1 justify-center",children:[i.numbers.map(e=>n.jsx("button",{onClick:t=>g(t,e),onPointerDown:t=>t.stopPropagation(),onMouseDown:t=>t.stopPropagation(),className:j(),style:{minWidth:`${Math.max(30,c.width/15)}px`},children:e},e)),n.jsx("button",{onClick:e=>g(e,"Backspace"),onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:`${j()} bg-red-600 hover:bg-red-500`,style:{minWidth:`${Math.max(50,c.width/10)}px`},children:"⌫"})]}),n.jsx("div",{className:"flex gap-1 justify-center",children:i.row1.map(e=>n.jsx("button",{onClick:t=>g(t,e),onPointerDown:t=>t.stopPropagation(),onMouseDown:t=>t.stopPropagation(),className:j(),style:{minWidth:`${Math.max(30,c.width/12)}px`},children:e},e))}),n.jsx("div",{className:"flex gap-1 justify-center",children:i.row2.map(e=>n.jsx("button",{onClick:t=>g(t,e),onPointerDown:t=>t.stopPropagation(),onMouseDown:t=>t.stopPropagation(),className:j(),style:{minWidth:`${Math.max(30,c.width/11)}px`},children:e},e))}),n.jsxs("div",{className:"flex gap-1 justify-center",children:[n.jsxs("button",{onClick:e=>g(e,"Shift"),onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:`${j()} ${E||k?"bg-blue-600":""}`,style:{minWidth:`${Math.max(50,c.width/10)}px`},children:["⇧",k?"🔒":""]}),i.row3.map(e=>n.jsx("button",{onClick:t=>g(t,e),onPointerDown:t=>t.stopPropagation(),onMouseDown:t=>t.stopPropagation(),className:j(),style:{minWidth:`${Math.max(30,c.width/12)}px`},children:e},e))]}),n.jsxs("div",{className:"flex gap-1 justify-center",children:[n.jsx("button",{onClick:e=>g(e,"한/영"),onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:j(),style:{minWidth:`${Math.max(60,c.width/8)}px`},children:"한/영"}),n.jsx("button",{onClick:e=>g(e,"Space"),onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:j(),style:{minWidth:`${Math.max(200,c.width/3)}px`},children:"스페이스"}),n.jsx("button",{onClick:e=>g(e,"Enter"),onPointerDown:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:`${j()} bg-blue-600 hover:bg-blue-500`,style:{minWidth:`${Math.max(60,c.width/8)}px`},children:"완료"})]})]}),n.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",style:{touchAction:"none"},onPointerDown:ie,onClick:e=>e.stopPropagation(),children:n.jsx("div",{className:"absolute bottom-1 right-1 w-2 h-2 border-r-2 border-b-2 border-gray-400",onClick:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation()})})]})},de=()=>{var P;const{initializeFirebaseListeners:b,settings:y}=q(),p=((P=y==null?void 0:y.view)==null?void 0:P.virtualKeyboardEnabled)??!0,[B,w]=r.useState(!0),d=r.useRef(null);return r.useEffect(()=>(b(),()=>{const{cleanupFirebaseListeners:m}=q.getState();m()}),[b]),r.useEffect(()=>{const m=()=>{d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{w(!1)},1e4)},N=()=>{w(!0),m()},c=()=>{N()};return m(),window.addEventListener("mousemove",c),window.addEventListener("mousedown",c),window.addEventListener("click",c),window.addEventListener("touchstart",c),()=>{d.current&&clearTimeout(d.current),window.removeEventListener("mousemove",c),window.removeEventListener("mousedown",c),window.removeEventListener("click",c),window.removeEventListener("touchstart",c)}},[]),n.jsxs("div",{className:"w-screen h-screen overflow-hidden relative",children:[n.jsx("main",{className:"w-full h-full",children:n.jsx(se,{isViewPage:!0})}),B&&n.jsx(ae,{}),p&&n.jsx(re,{})]})};export{de as default};
