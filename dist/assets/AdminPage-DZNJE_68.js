import{r as g,R as G,j as e}from"./index-BAIBKV_r.js";import{u as q,a as J,b as Y,c as Re,C as He}from"./Canvas-BCQAOIRV.js";const De=()=>{var ne,ie,oe,re,de,ce,xe,be,he,me,ue,ge;const{textObjects:x,imageObjects:p,addTextObject:k,addImageObject:S,updateTextObject:u,updateImageObject:w,setFloorImage:M,deleteTextObject:B,deleteImageObject:R,settings:c,updateSettings:h,isLoading:je}=q(),{currentTool:ye,setCurrentTool:Q,selectedObjectId:m,setSelectedObjectId:_}=J(),[H,ke]=g.useState(!1),[D,ve]=g.useState(!1),[v,ee]=g.useState(""),[T,U]=g.useState(!1),[y,z]=g.useState("text"),te=["#000000","#ffffff","#cccccc","#ff0000","#00ff00","#0000ff","#ffff00","#ff00ff","#00ffff","#ffa500","#800080"],j=g.useRef(null),n=m?x.find(t=>t.id===m)||p.find(t=>t.id===m):null,a={admin:{autoToolSwitch:((ne=c==null?void 0:c.admin)==null?void 0:ne.autoToolSwitch)??!0,gridVisible:((ie=c==null?void 0:c.admin)==null?void 0:ie.gridVisible)??!0,gridSize:((oe=c==null?void 0:c.admin)==null?void 0:oe.gridSize)??32,gridSnapEnabled:((re=c==null?void 0:c.admin)==null?void 0:re.gridSnapEnabled)??!1,defaultFontSize:((de=c==null?void 0:c.admin)==null?void 0:de.defaultFontSize)??16,defaultBoxWidth:((ce=c==null?void 0:c.admin)==null?void 0:ce.defaultBoxWidth)??200,defaultBoxHeight:((xe=c==null?void 0:c.admin)==null?void 0:xe.defaultBoxHeight)??60,objectCreationPosition:((be=c==null?void 0:c.admin)==null?void 0:be.objectCreationPosition)??{x:260,y:950},defaultCheckboxSettings:((he=c==null?void 0:c.admin)==null?void 0:he.defaultCheckboxSettings)??{checkedColor:"#22c55e",uncheckedColor:"#f3f4f6",checkedBackgroundColor:"#ffffff",uncheckedBackgroundColor:"#ffffff",checkedBackgroundOpacity:1,uncheckedBackgroundOpacity:1},excelPasteSettings:((me=c==null?void 0:c.admin)==null?void 0:me.excelPasteSettings)??{startPosition:{x:100,y:100},cellWidth:120,cellHeight:40,fontSize:14,fontColor:"#000000",backgroundColor:"transparent",maxRows:50,maxCols:50}},view:{virtualKeyboardEnabled:((ue=c==null?void 0:c.view)==null?void 0:ue.virtualKeyboardEnabled)??!0,touchMode:((ge=c==null?void 0:c.view)==null?void 0:ge.touchMode)??!0}},Z=t=>t&&typeof t.hasCheckbox<"u",Ce=t=>t&&typeof t.src<"u",se=g.useCallback(async t=>{if(n&&"text"in n){const d=n.textStyle||{color:"#000000",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"};await u(n.id,{textStyle:{...d,...t}})}},[n,u]),ae=g.useCallback(async t=>{if(n&&"text"in n){const d=n.boxStyle||{backgroundColor:"transparent",backgroundOpacity:1,borderColor:"#000000",borderWidth:0,borderRadius:0};await u(n.id,{boxStyle:{...d,...t}})}},[n,u]),I=g.useCallback(t=>{n&&(j.current&&clearTimeout(j.current),j.current=setTimeout(()=>{se(t)},300))},[n,se]),W=g.useCallback(t=>{n&&(j.current&&clearTimeout(j.current),j.current=setTimeout(()=>{ae(t)},300))},[n,ae]),O=g.useCallback((t,d)=>{j.current&&clearTimeout(j.current),j.current=setTimeout(()=>{w(t,d)},300)},[w]),L=g.useCallback((t,d)=>{j.current&&clearTimeout(j.current),j.current=setTimeout(()=>{u(t,d)},300)},[u]),le=g.useCallback(t=>{if(!(!n||!Z(n)))switch(y){case"text":I({color:t});break;case"background":W({backgroundColor:t});break;case"border":W({borderColor:t});break}},[y,n,I,W]),$=g.useCallback(()=>{var t,d,i;if(!n||!Z(n))return"#000000";switch(y){case"text":return((t=n.textStyle)==null?void 0:t.color)||"#000000";case"background":return((d=n.boxStyle)==null?void 0:d.backgroundColor)||"transparent";case"border":return((i=n.boxStyle)==null?void 0:i.borderColor)||"#000000";default:return"#000000"}},[y,n]);G.useEffect(()=>()=>{j.current&&clearTimeout(j.current)},[]);const Ne=g.useCallback(async()=>{const{x:t,y:d}=a.admin.objectCreationPosition,i={x:t,y:d,width:a.admin.defaultBoxWidth,height:a.admin.defaultBoxHeight,text:"ìƒˆ í…ìŠ¤íŠ¸",fontSize:a.admin.defaultFontSize,textStyle:{color:"#000000",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"},boxStyle:{backgroundColor:"transparent",backgroundOpacity:1,borderColor:"#000000",borderWidth:0,borderRadius:0},permissions:{editable:!0,movable:!0,resizable:!0,deletable:!0},zIndex:Date.now(),locked:!1,visible:!0,opacity:1,hasCheckbox:!1,checkboxChecked:!1,checkboxCheckedColor:"#22c55e",checkboxUncheckedColor:"#f3f4f6",isEditing:!1,lastModified:Date.now()};try{await k(i)}catch(b){console.error("í…ìŠ¤íŠ¸ ê°ì²´ ìƒì„± ì‹¤íŒ¨:",b)}},[k,a.admin.objectCreationPosition,a.admin.defaultFontSize,a.admin.defaultBoxWidth,a.admin.defaultBoxHeight]),we=g.useCallback(async()=>{const{x:t,y:d}=a.admin.objectCreationPosition,{checkedColor:i,uncheckedColor:b,checkedBackgroundColor:l,uncheckedBackgroundColor:r,checkedBackgroundOpacity:s,uncheckedBackgroundOpacity:o}=a.admin.defaultCheckboxSettings,f={x:t,y:d,width:a.admin.defaultBoxWidth,height:a.admin.defaultBoxHeight,text:"ìƒˆ ì²´í¬ë°•ìŠ¤",fontSize:a.admin.defaultFontSize,textStyle:{color:"#000000",bold:!0,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"},boxStyle:{backgroundColor:"transparent",backgroundOpacity:1,borderColor:"#000000",borderWidth:1,borderRadius:8},permissions:{editable:!0,movable:!0,resizable:!0,deletable:!0},zIndex:Date.now(),locked:!1,visible:!0,opacity:1,hasCheckbox:!0,checkboxChecked:!1,checkboxCheckedColor:i,checkboxUncheckedColor:b,checkedBackgroundColor:l,uncheckedBackgroundColor:r,checkedBackgroundOpacity:s,uncheckedBackgroundOpacity:o,isEditing:!1,lastModified:Date.now()};try{await k(f)}catch(N){console.error("ì²´í¬ë°•ìŠ¤ ê°ì²´ ìƒì„± ì‹¤íŒ¨:",N)}},[k,a.admin.objectCreationPosition,a.admin.defaultCheckboxSettings,a.admin.defaultFontSize,a.admin.defaultBoxWidth,a.admin.defaultBoxHeight]),Se=g.useCallback(async()=>{const t=document.createElement("input");t.type="file",t.accept="image/*",t.onchange=async d=>{var b;const i=(b=d.target.files)==null?void 0:b[0];if(i)try{const l=new FileReader;l.onload=async r=>{var E;const s=(E=r.target)==null?void 0:E.result,{x:o,y:f}=a.admin.objectCreationPosition,N=new Image;N.onload=async()=>{const K=200*(N.naturalHeight/N.naturalWidth),F={x:o,y:f,width:200,height:K,src:s,permissions:{editable:!0,movable:!0,resizable:!0,deletable:!0},zIndex:Date.now(),locked:!1,visible:!0,opacity:1,maintainAspectRatio:!0,lastModified:Date.now()};await S(F)},N.onerror=()=>{console.error("ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨"),alert("ì´ë¯¸ì§€ë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")},N.src=s},l.readAsDataURL(i)}catch(l){console.error("ì´ë¯¸ì§€ ê°ì²´ ìƒì„± ì‹¤íŒ¨:",l)}},t.click()},[S,a.admin.objectCreationPosition,a.admin.defaultBoxWidth,a.admin.defaultBoxHeight]),A=g.useCallback(t=>t.trim()?t.split(`
`).filter(i=>i.trim()!=="").map(i=>i.split("	")):[],[]),Pe=g.useCallback(async()=>{const t=x.filter(b=>b.groupId&&b.groupId.startsWith("excel-input-"));if(t.length===0){alert("ì‚­ì œí•  ì—‘ì…€ ì…€ì´ ì—†ìŠµë‹ˆë‹¤.");return}const d=new Set(t.map(b=>b.groupId)).size,i=`${d}ê°œì˜ ì—‘ì…€ ê·¸ë£¹ (ì´ ${t.length}ê°œ ì…€)ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`;if(confirm(i))try{for(const b of t)await B(b.id);alert(`${d}ê°œ ê·¸ë£¹ (${t.length}ê°œ ì…€)ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`)}catch(b){console.error("ì—‘ì…€ ì…€ ì‚­ì œ ì‹¤íŒ¨:",b),alert("ì…€ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},[x,B]),Oe=g.useCallback(async()=>{var pe;const t=A(v);if(t.length===0){alert("ë¶™ì—¬ë„£ì„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");return}const{startPosition:d,cellWidth:i,cellHeight:b,fontSize:l,fontColor:r,backgroundColor:s,maxRows:o=100,maxCols:f=50}=a.admin.excelPasteSettings,N=`excel-input-${Date.now()}`,E=[],V=Math.min(t.length,o),X=t.map(C=>C.length),K=X.length>0?Math.max(...X):0,F=Math.min(K,f);for(let C=0;C<V;C++)for(let P=0;P<F;P++){const $e=((pe=t[C])==null?void 0:pe[P])||"",Ae={x:d.x+P*i,y:d.y+C*b,width:i,height:b,text:$e,fontSize:l,textStyle:{color:r,bold:!1,italic:!1,horizontalAlign:"center",verticalAlign:"middle",fontFamily:"Arial"},boxStyle:{backgroundColor:s,backgroundOpacity:1,borderColor:"#d1d5db",borderWidth:1,borderRadius:0},permissions:{editable:!0,movable:!1,resizable:!1,deletable:!1},zIndex:Date.now()+C*F+P,locked:!0,visible:!0,opacity:1,hasCheckbox:!1,checkboxChecked:!1,checkboxCheckedColor:"#22c55e",checkboxUncheckedColor:"#f3f4f6",isEditing:!1,lastModified:Date.now(),groupId:N,cellType:"cell",cellPosition:{row:C,col:P}};E.push(Ae)}try{for(const P of E)await k(P);alert(`${V}x${F} ì…€ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`),ee(""),U(!1);const C=new CustomEvent("excel-preview-update",{detail:{data:"",show:!1}});window.dispatchEvent(C)}catch(C){console.error("ì—‘ì…€ ì…€ ìƒì„± ì‹¤íŒ¨:",C),alert("ì…€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},[v,A,k,a.admin.excelPasteSettings]);G.useEffect(()=>{if(T&&v.trim()){const t=new CustomEvent("excel-preview-update",{detail:{data:v,show:!0}});window.dispatchEvent(t)}else{const t=new CustomEvent("excel-preview-update",{detail:{data:"",show:!1}});window.dispatchEvent(t)}},[T,v,a.admin.excelPasteSettings.startPosition,a.admin.excelPasteSettings.cellWidth,a.admin.excelPasteSettings.cellHeight]);const ze=t=>{var i;const d=(i=t.target.files)==null?void 0:i[0];if(d){const b=new FileReader;b.onload=async l=>{var s;const r=(s=l.target)==null?void 0:s.result;await M({path:r})},b.readAsDataURL(d)}},Ie=async()=>{if(!m)return;const t=x.find(i=>i.id===m);if(t){const i={...t,x:t.x+20,y:t.y+20,isEditing:!1};delete i.id,await k(i);return}const d=p.find(i=>i.id===m);if(d){const i={...d,x:d.x+20,y:d.y+20};delete i.id,await S(i);return}},Me=async()=>{var i,b;if(!m)return;const t=x.find(l=>l.id===m);if(t&&((i=t.permissions)!=null&&i.deletable)){await B(m),_(null);return}const d=p.find(l=>l.id===m);if(d&&((b=d.permissions)!=null&&b.deletable)){await R(m),_(null);return}},Be=async()=>{if(!m)return;const t=[...x,...p],d=Math.max(...t.map(l=>l.zIndex||0));if(x.find(l=>l.id===m)){await u(m,{zIndex:d+1});return}if(p.find(l=>l.id===m)){await w(m,{zIndex:d+1});return}},Te=async()=>{if(!m)return;const t=[...x,...p],d=t.find(s=>s.id===m);if(!d)return;const i=t.filter(s=>(s.zIndex||0)>(d.zIndex||0));if(i.length===0)return;const b=Math.min(...i.map(s=>s.zIndex||0));if(x.find(s=>s.id===m)){await u(m,{zIndex:b+1});return}if(p.find(s=>s.id===m)){await w(m,{zIndex:b+1});return}},We=async()=>{if(!m)return;const t=[...x,...p],d=t.find(s=>s.id===m);if(!d)return;const i=t.filter(s=>(s.zIndex||0)<(d.zIndex||0));if(i.length===0)return;const b=Math.max(...i.map(s=>s.zIndex||0));if(x.find(s=>s.id===m)){await u(m,{zIndex:b-1});return}if(p.find(s=>s.id===m)){await w(m,{zIndex:b-1});return}},Ee=async()=>{if(!m)return;const t=[...x,...p],d=Math.min(...t.map(r=>r.zIndex||0)),i=Math.max(1,d-1);if(x.find(r=>r.id===m)){await u(m,{zIndex:i});return}if(p.find(r=>r.id===m)){await w(m,{zIndex:i});return}},Fe=[{id:"select",label:"ì„ íƒ",icon:"ðŸ‘†"},{id:"text",label:"í…ìŠ¤íŠ¸",icon:"ðŸ“"},{id:"checkbox",label:"ì²´í¬",icon:"â˜‘ï¸"},{id:"image",label:"ì´ë¯¸ì§€",icon:"ðŸ–¼ï¸"},{id:"pen",label:"í•„ê¸°",icon:"âœï¸"},{id:"eraser",label:"ì§€ìš°ê°œ",icon:"ðŸ§½"}];return je||!c?e.jsx("div",{className:"w-64 h-full bg-white border-r border-gray-200 p-4 flex items-center justify-center",children:e.jsx("div",{className:"text-gray-500",children:"ì„¤ì • ë¡œë“œ ì¤‘..."})}):e.jsxs("div",{className:"h-full flex flex-col overflow-hidden bg-gradient-to-b from-slate-50 to-slate-100",onClick:t=>{t.stopPropagation();const d=t.target;if(!(d.tagName==="INPUT"||d.tagName==="TEXTAREA"||d.isContentEditable||d.closest("input, textarea, [contenteditable]"))){const b=document.activeElement;b&&(b.hasAttribute("data-canvas-container")||b.tabIndex===0&&b.tagName==="DIV")&&b.blur()}},children:[e.jsx("div",{className:"p-4 border-b border-slate-200 bg-gradient-to-r from-pink-200 to-purple-200",children:e.jsxs("h1",{className:"text-lg font-bold text-gray-700 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ› ï¸"}),"ê´€ë¦¬ìž ë„êµ¬"]})}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"âš¡"})," ë©”ì¸ ë„êµ¬"]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Fe.map(t=>e.jsxs("button",{onClick:()=>{t.id==="select"?Q("select"):t.id==="text"?Ne():t.id==="checkbox"?we():t.id==="image"?Se():(t.id==="pen"||t.id==="eraser")&&Q(t.id)},className:`p-3 rounded-lg flex flex-col items-center gap-1 transition-all duration-200 border-2
                ${ye===t.id?"bg-blue-500 text-white border-blue-600 shadow-lg scale-105":"bg-slate-50 hover:bg-slate-100 text-slate-700 border-slate-200 hover:border-slate-300"}`,children:[e.jsx("span",{className:"text-2xl",children:t.icon}),e.jsx("span",{className:"text-xs font-medium",children:t.label})]},t.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("button",{onClick:()=>ve(!D),className:"w-full p-4 flex items-center justify-between text-sm font-bold text-slate-700 hover:bg-slate-50 rounded-t-xl transition-colors",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ“Š"})," ì—‘ì…€ ë°ì´í„° ìž…ë ¥"]}),e.jsx("span",{className:`text-slate-400 transition-transform duration-200 ${D?"rotate-180":""}`,children:"â–¼"})]}),D&&e.jsxs("div",{className:"p-4 border-t border-slate-200 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"ë°ì´í„° ë¶™ì—¬ë„£ê¸°"}),e.jsx("textarea",{value:v,onChange:t=>{ee(t.target.value),U(!!t.target.value.trim());const d=new CustomEvent("excel-preview-update",{detail:{data:t.target.value,show:!!t.target.value.trim()}});window.dispatchEvent(d)},onFocus:t=>{t.stopPropagation()},onClick:t=>{t.stopPropagation()},placeholder:"ì—‘ì…€ì—ì„œ ë³µì‚¬í•œ ë°ì´í„°ë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”...",className:"w-full px-3 py-2 border border-slate-300 rounded-lg text-xs resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:v?`${A(v).length}í–‰ Ã— ${Math.max(...A(v).map(t=>t.length))}ì—´`:"ë°ì´í„° ì—†ìŒ"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"X ì¢Œí‘œ"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>h("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,startPosition:{...a.admin.excelPasteSettings.startPosition,x:Math.max(0,a.admin.excelPasteSettings.startPosition.x-10)}}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs font-mono",children:"â—€"}),e.jsx("input",{type:"number",value:a.admin.excelPasteSettings.startPosition.x,onChange:t=>h("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,startPosition:{...a.admin.excelPasteSettings.startPosition,x:parseInt(t.target.value)||0}}}),onFocus:t=>t.stopPropagation(),onClick:t=>t.stopPropagation(),className:"w-16 px-1 py-1 border border-slate-300 rounded text-xs text-center"}),e.jsx("button",{onClick:()=>h("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,startPosition:{...a.admin.excelPasteSettings.startPosition,x:a.admin.excelPasteSettings.startPosition.x+10}}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs font-mono",children:"â–¶"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"Y ì¢Œí‘œ"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>h("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,startPosition:{...a.admin.excelPasteSettings.startPosition,y:Math.max(0,a.admin.excelPasteSettings.startPosition.y-10)}}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs font-mono",children:"â–²"}),e.jsx("input",{type:"number",value:a.admin.excelPasteSettings.startPosition.y,onChange:t=>h("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,startPosition:{...a.admin.excelPasteSettings.startPosition,y:parseInt(t.target.value)||0}}}),onFocus:t=>t.stopPropagation(),onClick:t=>t.stopPropagation(),className:"w-16 px-1 py-1 border border-slate-300 rounded text-xs text-center"}),e.jsx("button",{onClick:()=>h("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,startPosition:{...a.admin.excelPasteSettings.startPosition,y:a.admin.excelPasteSettings.startPosition.y+10}}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs font-mono",children:"â–¼"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"ì…€ ë„ˆë¹„"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>h("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,cellWidth:Math.max(20,a.admin.excelPasteSettings.cellWidth-1)}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â—€"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded",children:[a.admin.excelPasteSettings.cellWidth,"px"]}),e.jsx("button",{onClick:()=>h("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,cellWidth:Math.min(300,a.admin.excelPasteSettings.cellWidth+1)}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–¶"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"ì…€ ë†’ì´"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>h("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,cellHeight:Math.max(20,a.admin.excelPasteSettings.cellHeight-1)}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–²"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded",children:[a.admin.excelPasteSettings.cellHeight,"px"]}),e.jsx("button",{onClick:()=>h("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,cellHeight:Math.min(100,a.admin.excelPasteSettings.cellHeight+1)}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–¼"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"í°íŠ¸ í¬ê¸°"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>h("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,fontSize:Math.max(8,a.admin.excelPasteSettings.fontSize-1)}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–¼"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded",children:[a.admin.excelPasteSettings.fontSize,"px"]}),e.jsx("button",{onClick:()=>h("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,fontSize:Math.min(24,a.admin.excelPasteSettings.fontSize+1)}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–²"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"í°íŠ¸ ìƒ‰ìƒ"}),e.jsx("input",{type:"color",value:a.admin.excelPasteSettings.fontColor,onChange:t=>h("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,fontColor:t.target.value}}),onFocus:t=>t.stopPropagation(),onClick:t=>t.stopPropagation(),className:"w-full h-8 rounded border border-slate-300"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"ë°°ê²½ ìƒ‰ìƒ"}),e.jsx("div",{className:"grid grid-cols-5 gap-1",children:[{color:"transparent",label:"íˆ¬ëª…",className:"bg-white border-2 border-dashed border-gray-300"},{color:"#ffffff",label:"í°ìƒ‰",className:"bg-white border border-gray-300"},{color:"#f3f4f6",label:"íšŒìƒ‰",className:"bg-gray-100"},{color:"#fee2e2",label:"ë¹¨ê°•",className:"bg-red-100"},{color:"#fef3c7",label:"ë…¸ëž‘",className:"bg-yellow-100"},{color:"#d1fae5",label:"ì´ˆë¡",className:"bg-green-100"},{color:"#dbeafe",label:"íŒŒëž‘",className:"bg-blue-100"},{color:"#e0e7ff",label:"ì¸ë””ê³ ",className:"bg-indigo-100"},{color:"#f3e8ff",label:"ë³´ë¼",className:"bg-purple-100"},{color:"#fce7f3",label:"í•‘í¬",className:"bg-pink-100"}].map(({color:t,label:d,className:i})=>e.jsx("button",{onClick:()=>h("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,backgroundColor:t}}),className:`w-8 h-8 ${i} ${a.admin.excelPasteSettings.backgroundColor===t?"ring-2 ring-blue-500":"hover:ring-1 hover:ring-gray-400"} transition-all rounded`,title:d,children:t==="transparent"&&e.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-400",children:"Ã—"})},t))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:Oe,disabled:!v.trim(),className:"flex-1 px-4 py-2 bg-green-500 hover:bg-green-600 disabled:bg-gray-300 text-white rounded-lg text-sm font-medium transition-colors",children:"ðŸ“‹ ì…€ ìƒì„±"}),e.jsxs("button",{onClick:()=>{U(!T);const t=new CustomEvent("excel-preview-update",{detail:{data:v,show:!T}});window.dispatchEvent(t)},disabled:!v.trim(),className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white rounded-lg text-sm font-medium transition-colors",children:["ðŸ‘ï¸ ",T?"ìˆ¨ê¹€":"ë¯¸ë¦¬ë³´ê¸°"]})]}),e.jsx("button",{onClick:Pe,className:"w-full px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm font-medium transition-colors",title:"ìƒì„±ëœ ëª¨ë“  ì—‘ì…€ ì…€ ê·¸ë£¹ì„ ì‚­ì œí•©ë‹ˆë‹¤",children:"ðŸ—‘ï¸ ì—‘ì…€ ì…€ ê·¸ë£¹ ì‚­ì œ"})]})]})]}),n&&(()=>{var b,l,r;const t="cellType"in n&&n.cellType==="cell",{getSelectedCount:d}=Y.getState(),i=d();return t||i>0?null:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"âœï¸"})," ì„ íƒëœ ê°ì²´ íŽ¸ì§‘"]}),Z(n)&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"í…ìŠ¤íŠ¸"}),e.jsx("textarea",{value:n.text,onChange:s=>L(n.id,{text:s.target.value}),onFocus:s=>s.stopPropagation(),onClick:s=>s.stopPropagation(),className:"w-full px-3 py-2 border border-slate-300 rounded-lg text-sm resize-none focus:ring-2 focus:ring-blue-500",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"í°íŠ¸ í¬ê¸°"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>L(n.id,{fontSize:Math.max(8,n.fontSize-2)}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–¼"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded border",children:[n.fontSize,"px"]}),e.jsx("button",{onClick:()=>L(n.id,{fontSize:Math.min(72,n.fontSize+2)}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–²"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"ìƒ‰ìƒ"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 mb-3",children:[e.jsx("button",{onClick:()=>z("text"),className:`px-2 py-2 rounded text-xs transition-colors ${y==="text"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"í…ìŠ¤íŠ¸"}),e.jsx("button",{onClick:()=>z("background"),className:`px-2 py-2 rounded text-xs transition-colors ${y==="background"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"ë°°ê²½"}),e.jsx("button",{onClick:()=>z("border"),className:`px-2 py-2 rounded text-xs transition-colors ${y==="border"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"í…Œë‘ë¦¬"})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[y==="background"&&e.jsx("button",{onClick:()=>le("transparent"),className:`w-8 h-8 rounded border-2 transition-all ${$()==="transparent"?"border-blue-500 border-2 shadow-md":"border-slate-300 hover:border-slate-400"}`,style:{backgroundColor:"white",backgroundImage:"linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(-45deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(-45deg, transparent 75%, #ccc 75%)",backgroundSize:"8px 8px",backgroundPosition:"0 0, 0 4px, 4px -4px, -4px 0px"},title:"íˆ¬ëª…"}),te.map((s,o)=>{const f=$()===s;return e.jsx("button",{onClick:()=>le(s),className:`w-8 h-8 rounded border-2 transition-all ${f?"border-blue-500 border-2 shadow-md":"border-slate-300 hover:border-slate-400"}`,style:{backgroundColor:s},title:s},o)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{var s;return I({bold:!((s=n.textStyle)!=null&&s.bold)})},className:`px-3 py-1 rounded-lg text-xs transition-colors ${(b=n.textStyle)!=null&&b.bold?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"êµµê²Œ"}),e.jsx("button",{onClick:()=>{var s;return I({italic:!((s=n.textStyle)!=null&&s.italic)})},className:`px-3 py-1 rounded-lg text-xs transition-colors ${(l=n.textStyle)!=null&&l.italic?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"ê¸°ìš¸ìž„"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"í…ìŠ¤íŠ¸ ì •ë ¬"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"ê°€ë¡œ"}),e.jsx("div",{className:"grid grid-cols-3 gap-1",children:["left","center","right"].map(s=>{var o;return e.jsx("button",{onClick:()=>I({horizontalAlign:s}),className:`px-2 py-1 rounded text-xs transition-colors ${((o=n.textStyle)==null?void 0:o.horizontalAlign)===s?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:s==="left"?"â—€":s==="center"?"â—":"â–¶"},s)})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"ì„¸ë¡œ"}),e.jsx("div",{className:"grid grid-cols-3 gap-1",children:["top","middle","bottom"].map(s=>{var o;return e.jsx("button",{onClick:()=>I({verticalAlign:s}),className:`px-2 py-1 rounded text-xs transition-colors ${((o=n.textStyle)==null?void 0:o.verticalAlign)===s?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:s==="top"?"â–²":s==="middle"?"â—":"â–¼"},s)})})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"í…Œë‘ë¦¬ ë‘ê»˜"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{var s;return W({borderWidth:Math.max(0,(((s=n.boxStyle)==null?void 0:s.borderWidth)||0)-1)})},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–¼"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded",children:[((r=n.boxStyle)==null?void 0:r.borderWidth)||0,"px"]}),e.jsx("button",{onClick:()=>{var s;return W({borderWidth:Math.min(10,(((s=n.boxStyle)==null?void 0:s.borderWidth)||0)+1)})},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–²"})]})]})]}),Ce(n)&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:n.maintainAspectRatio||!1,onChange:s=>O(n.id,{maintainAspectRatio:s.target.checked}),className:"rounded"}),e.jsx("span",{children:"ë¹„ìœ¨ ìœ ì§€"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"ë¶ˆíˆ¬ëª…ë„"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>O(n.id,{opacity:Math.max(.1,(n.opacity||1)-.1)}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–¼"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded",children:[Math.round((n.opacity||1)*100),"%"]}),e.jsx("button",{onClick:()=>O(n.id,{opacity:Math.min(1,(n.opacity||1)+.1)}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–²"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"í¬ê¸°"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-600 mb-1 block",children:"ë„ˆë¹„"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{const s=Math.max(50,n.width-10),o=n.maintainAspectRatio?{width:s,height:s/(n.width/n.height)}:{width:s};O(n.id,o)},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â—€"}),e.jsx("span",{className:"flex-1 text-center text-xs font-mono bg-slate-50 py-1 rounded",children:Math.round(n.width)}),e.jsx("button",{onClick:()=>{const s=n.width+10,o=n.maintainAspectRatio?{width:s,height:s/(n.width/n.height)}:{width:s};O(n.id,o)},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–¶"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-600 mb-1 block",children:"ë†’ì´"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{const s=Math.max(30,n.height-10),o=n.maintainAspectRatio?{height:s,width:s*(n.width/n.height)}:{height:s};O(n.id,o)},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–²"}),e.jsx("span",{className:"flex-1 text-center text-xs font-mono bg-slate-50 py-1 rounded",children:Math.round(n.height)}),e.jsx("button",{onClick:()=>{const s=n.height+10,o=n.maintainAspectRatio?{height:s,width:s*(n.width/n.height)}:{height:s};O(n.id,o)},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–¼"})]})]})]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4 pt-3 border-t border-slate-200",children:[e.jsx("button",{onClick:Ie,className:"flex-1 px-3 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg text-xs font-medium transition-colors",children:"ðŸ“‹ ë³µì‚¬"}),e.jsx("button",{onClick:Me,className:"flex-1 px-3 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-xs font-medium transition-colors",children:"ðŸ—‘ï¸ ì‚­ì œ"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-1 mt-2",children:[e.jsx("button",{onClick:Be,className:"px-2 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded text-xs font-medium transition-colors",title:"ë§¨ ìœ„ë¡œ",children:"â¬†â¬†"}),e.jsx("button",{onClick:Te,className:"px-2 py-1 bg-blue-400 hover:bg-blue-500 text-white rounded text-xs font-medium transition-colors",title:"ìœ„ë¡œ",children:"â¬†"}),e.jsx("button",{onClick:We,className:"px-2 py-1 bg-purple-400 hover:bg-purple-500 text-white rounded text-xs font-medium transition-colors",title:"ì•„ëž˜ë¡œ",children:"â¬‡"}),e.jsx("button",{onClick:Ee,className:"px-2 py-1 bg-purple-500 hover:bg-purple-600 text-white rounded text-xs font-medium transition-colors",title:"ë§¨ ì•„ëž˜ë¡œ",children:"â¬‡â¬‡"})]})]})})(),(()=>{const{getSelectedCells:t,getSelectedCount:d}=Y.getState(),i=t(),b=d();return b>0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ“Š"})," ì„ íƒëœ ì—‘ì…€ ì…€ (",b,"ê°œ)"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"í°íŠ¸ í¬ê¸°"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:async()=>{let l=72;for(const s of i){const o=x.find(f=>f.id===s);o&&o.cellType==="cell"&&(l=Math.min(l,o.fontSize))}const r=Math.max(8,l-2);for(const s of i){const o=x.find(f=>f.id===s);o&&o.cellType==="cell"&&await u(s,{fontSize:r})}},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–¼"}),e.jsx("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded border",children:"ì¼ê´„ ë³€ê²½"}),e.jsx("button",{onClick:async()=>{let l=72;for(const s of i){const o=x.find(f=>f.id===s);o&&o.cellType==="cell"&&(l=Math.min(l,o.fontSize))}const r=Math.min(72,l+2);for(const s of i){const o=x.find(f=>f.id===s);o&&o.cellType==="cell"&&await u(s,{fontSize:r})}},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–²"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"ìƒ‰ìƒ"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 mb-3",children:[e.jsx("button",{onClick:()=>z("text"),className:`px-2 py-2 rounded text-xs transition-colors ${y==="text"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"í…ìŠ¤íŠ¸"}),e.jsx("button",{onClick:()=>z("background"),className:`px-2 py-2 rounded text-xs transition-colors ${y==="background"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"ë°°ê²½"}),e.jsx("button",{onClick:()=>z("border"),className:`px-2 py-2 rounded text-xs transition-colors ${y==="border"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"í…Œë‘ë¦¬"})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[y==="background"&&e.jsx("button",{onClick:async()=>{for(const l of i){const r=x.find(s=>s.id===l);r&&r.cellType==="cell"&&await u(l,{boxStyle:{...r.boxStyle,backgroundColor:"transparent"}})}},className:`w-8 h-8 rounded border-2 transition-all ${$()==="transparent"?"border-blue-500 border-2 shadow-md":"border-slate-300 hover:border-slate-400"}`,style:{backgroundColor:"white",backgroundImage:"linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(-45deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(-45deg, transparent 75%, #ccc 75%)",backgroundSize:"8px 8px",backgroundPosition:"0 0, 0 4px, 4px -4px, -4px 0px"},title:"íˆ¬ëª…"}),te.map((l,r)=>{const s=$()===l;return e.jsx("button",{onClick:async()=>{for(const o of i){const f=x.find(N=>N.id===o);if(f&&f.cellType==="cell")switch(y){case"text":await u(o,{textStyle:{...f.textStyle,color:l}});break;case"background":await u(o,{boxStyle:{...f.boxStyle,backgroundColor:l}});break;case"border":await u(o,{boxStyle:{...f.boxStyle,borderColor:l}});break}}},className:`w-8 h-8 rounded border-2 transition-all ${s?"border-blue-500 border-2 shadow-md":"border-slate-300 hover:border-slate-400"}`,style:{backgroundColor:l},title:l},r)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{var l;for(const r of i){const s=x.find(o=>o.id===r);if(s&&s.cellType==="cell"){const o=((l=s.textStyle)==null?void 0:l.bold)||!1;await u(r,{textStyle:{...s.textStyle,bold:!o}})}}},className:`px-3 py-1 rounded-lg text-xs transition-colors ${(()=>{var r;const l=x.find(s=>s.id===i[0]);return(r=l==null?void 0:l.textStyle)!=null&&r.bold?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"})()}`,children:"êµµê²Œ"}),e.jsx("button",{onClick:async()=>{var l;for(const r of i){const s=x.find(o=>o.id===r);if(s&&s.cellType==="cell"){const o=((l=s.textStyle)==null?void 0:l.italic)||!1;await u(r,{textStyle:{...s.textStyle,italic:!o}})}}},className:`px-3 py-1 rounded-lg text-xs transition-colors ${(()=>{var r;const l=x.find(s=>s.id===i[0]);return(r=l==null?void 0:l.textStyle)!=null&&r.italic?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"})()}`,children:"ê¸°ìš¸ìž„"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"í…ìŠ¤íŠ¸ ì •ë ¬"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"ê°€ë¡œ"}),e.jsx("div",{className:"grid grid-cols-3 gap-1",children:["left","center","right"].map(l=>e.jsx("button",{onClick:async()=>{for(const r of i){const s=x.find(o=>o.id===r);s&&s.cellType==="cell"&&await u(r,{textStyle:{...s.textStyle,horizontalAlign:l}})}},className:`px-2 py-1 rounded text-xs transition-colors ${(()=>{var s;const r=x.find(o=>o.id===i[0]);return((s=r==null?void 0:r.textStyle)==null?void 0:s.horizontalAlign)===l?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"})()}`,children:l==="left"?"â—€":l==="center"?"â—":"â–¶"},l))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"ì„¸ë¡œ"}),e.jsx("div",{className:"grid grid-cols-3 gap-1",children:["top","middle","bottom"].map(l=>e.jsx("button",{onClick:async()=>{for(const r of i){const s=x.find(o=>o.id===r);s&&s.cellType==="cell"&&await u(r,{textStyle:{...s.textStyle,verticalAlign:l}})}},className:`px-2 py-1 rounded text-xs transition-colors ${(()=>{var s;const r=x.find(o=>o.id===i[0]);return((s=r==null?void 0:r.textStyle)==null?void 0:s.verticalAlign)===l?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"})()}`,children:l==="top"?"â–²":l==="middle"?"â—":"â–¼"},l))})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"í…Œë‘ë¦¬ ë‘ê»˜"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:async()=>{var l;for(const r of i){const s=x.find(o=>o.id===r);if(s&&s.cellType==="cell"){const o=((l=s.boxStyle)==null?void 0:l.borderWidth)||0;await u(r,{boxStyle:{...s.boxStyle,borderWidth:Math.max(0,o-1)}})}}},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–¼"}),e.jsx("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded border",children:"ì¼ê´„ ë³€ê²½"}),e.jsx("button",{onClick:async()=>{var l;for(const r of i){const s=x.find(o=>o.id===r);if(s&&s.cellType==="cell"){const o=((l=s.boxStyle)==null?void 0:l.borderWidth)||0;await u(r,{boxStyle:{...s.boxStyle,borderWidth:Math.min(10,o+1)}})}}},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–²"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-3 border-t border-slate-200",children:[e.jsx("button",{onClick:async()=>{for(const l of i){const r=x.find(s=>s.id===l);r&&r.cellType==="cell"&&await u(l,{text:""})}console.log(`${b}ê°œ ì…€ì˜ í…ìŠ¤íŠ¸ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`)},className:"flex-1 px-3 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg text-xs font-medium transition-colors",children:"ðŸ—‘ï¸ í…ìŠ¤íŠ¸ ì‚­ì œ"}),e.jsx("button",{onClick:()=>{const{clearSelection:l}=Y.getState();l()},className:"flex-1 px-3 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg text-xs font-medium transition-colors",children:"âŒ ì„ íƒ í•´ì œ"})]})]})]}):null})(),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("button",{onClick:()=>ke(!H),className:"w-full p-4 flex items-center justify-between text-sm font-bold text-slate-700 hover:bg-slate-50 rounded-t-xl transition-colors",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"âš™ï¸"})," ì„¤ì •"]}),e.jsx("span",{className:`text-slate-400 transition-transform duration-200 ${H?"rotate-180":""}`,children:"â–¼"})]}),H&&e.jsxs("div",{className:"p-4 border-t border-slate-200 space-y-4",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 space-y-3",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-600 flex items-center gap-1",children:[e.jsx("span",{children:"ðŸ”²"})," ê·¸ë¦¬ë“œ"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:a.admin.gridVisible,onChange:t=>h("admin",{gridVisible:t.target.checked}),className:"rounded"}),e.jsx("span",{children:"ê·¸ë¦¬ë“œ í‘œì‹œ"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:a.admin.gridSnapEnabled,onChange:t=>h("admin",{gridSnapEnabled:t.target.checked}),className:"rounded"}),e.jsx("span",{children:"ê·¸ë¦¬ë“œì— ìŠ¤ëƒ…"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"ê·¸ë¦¬ë“œ í¬ê¸°"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>h("admin",{gridSize:Math.max(8,a.admin.gridSize-4)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–¼"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-white py-1 rounded border",children:[a.admin.gridSize,"px"]}),e.jsx("button",{onClick:()=>h("admin",{gridSize:Math.min(64,a.admin.gridSize+4)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–²"})]})]})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 space-y-3",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-600 flex items-center gap-1",children:[e.jsx("span",{children:"ðŸ“"})," ê°ì²´ ìƒì„± ìœ„ì¹˜"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"X ì¢Œí‘œ"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{const t=Math.max(0,a.admin.objectCreationPosition.x-20);h("admin",{objectCreationPosition:{...a.admin.objectCreationPosition,x:t}})},className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â—€"}),e.jsx("span",{className:"flex-1 text-center text-xs font-mono bg-white py-1 rounded border",children:a.admin.objectCreationPosition.x}),e.jsx("button",{onClick:()=>{const t=a.admin.objectCreationPosition.x+20;h("admin",{objectCreationPosition:{...a.admin.objectCreationPosition,x:t}})},className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–¶"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"Y ì¢Œí‘œ"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{const t=Math.max(0,a.admin.objectCreationPosition.y-20);h("admin",{objectCreationPosition:{...a.admin.objectCreationPosition,y:t}})},className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–²"}),e.jsx("span",{className:"flex-1 text-center text-xs font-mono bg-white py-1 rounded border",children:a.admin.objectCreationPosition.y}),e.jsx("button",{onClick:()=>{const t=a.admin.objectCreationPosition.y+20;h("admin",{objectCreationPosition:{...a.admin.objectCreationPosition,y:t}})},className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–¼"})]})]})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 space-y-3",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-600 flex items-center gap-1",children:[e.jsx("span",{children:"â˜‘ï¸"})," ì²´í¬ë°•ìŠ¤ ê¸°ë³¸ê°’"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-600 mb-1 block",children:"ì²´í¬ ìƒ‰ìƒ"}),e.jsx("input",{type:"color",value:a.admin.defaultCheckboxSettings.checkedColor,onChange:t=>h("admin",{defaultCheckboxSettings:{...a.admin.defaultCheckboxSettings,checkedColor:t.target.value}}),onFocus:t=>t.stopPropagation(),onClick:t=>t.stopPropagation(),className:"w-full h-8 rounded border border-slate-300"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-600 mb-1 block",children:"ë¯¸ì²´í¬ ìƒ‰ìƒ"}),e.jsx("input",{type:"color",value:a.admin.defaultCheckboxSettings.uncheckedColor,onChange:t=>h("admin",{defaultCheckboxSettings:{...a.admin.defaultCheckboxSettings,uncheckedColor:t.target.value}}),onFocus:t=>t.stopPropagation(),onClick:t=>t.stopPropagation(),className:"w-full h-8 rounded border border-slate-300"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-600 mb-1 block",children:"ì²´í¬ ë°°ê²½"}),e.jsx("input",{type:"color",value:a.admin.defaultCheckboxSettings.checkedBackgroundColor,onChange:t=>h("admin",{defaultCheckboxSettings:{...a.admin.defaultCheckboxSettings,checkedBackgroundColor:t.target.value}}),onFocus:t=>t.stopPropagation(),onClick:t=>t.stopPropagation(),className:"w-full h-8 rounded border border-slate-300"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-600 mb-1 block",children:"ë¯¸ì²´í¬ ë°°ê²½"}),e.jsx("input",{type:"color",value:a.admin.defaultCheckboxSettings.uncheckedBackgroundColor,onChange:t=>h("admin",{defaultCheckboxSettings:{...a.admin.defaultCheckboxSettings,uncheckedBackgroundColor:t.target.value}}),onFocus:t=>t.stopPropagation(),onClick:t=>t.stopPropagation(),className:"w-full h-8 rounded border border-slate-300"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-600 mb-1 block",children:"ì²´í¬ íˆ¬ëª…ë„"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>h("admin",{defaultCheckboxSettings:{...a.admin.defaultCheckboxSettings,checkedBackgroundOpacity:Math.max(0,a.admin.defaultCheckboxSettings.checkedBackgroundOpacity-.1)}}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–¼"}),e.jsxs("span",{className:"flex-1 text-center text-xs font-mono bg-white py-1 rounded border",children:[Math.round(a.admin.defaultCheckboxSettings.checkedBackgroundOpacity*100),"%"]}),e.jsx("button",{onClick:()=>h("admin",{defaultCheckboxSettings:{...a.admin.defaultCheckboxSettings,checkedBackgroundOpacity:Math.min(1,a.admin.defaultCheckboxSettings.checkedBackgroundOpacity+.1)}}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–²"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-600 mb-1 block",children:"ë¯¸ì²´í¬ íˆ¬ëª…ë„"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>h("admin",{defaultCheckboxSettings:{...a.admin.defaultCheckboxSettings,uncheckedBackgroundOpacity:Math.max(0,a.admin.defaultCheckboxSettings.uncheckedBackgroundOpacity-.1)}}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–¼"}),e.jsxs("span",{className:"flex-1 text-center text-xs font-mono bg-white py-1 rounded border",children:[Math.round(a.admin.defaultCheckboxSettings.uncheckedBackgroundOpacity*100),"%"]}),e.jsx("button",{onClick:()=>h("admin",{defaultCheckboxSettings:{...a.admin.defaultCheckboxSettings,uncheckedBackgroundOpacity:Math.min(1,a.admin.defaultCheckboxSettings.uncheckedBackgroundOpacity+.1)}}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–²"})]})]})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-600 mb-2 flex items-center gap-1",children:[e.jsx("span",{children:"ðŸ–¼ï¸"})," ë°°ê²½ ì´ë¯¸ì§€"]}),e.jsxs("label",{className:"w-full px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors cursor-pointer text-sm font-medium flex items-center justify-center gap-2",children:[e.jsx("span",{children:"ðŸ“"}),e.jsx("span",{children:"ì´ë¯¸ì§€ ì—…ë¡œë“œ"}),e.jsx("input",{type:"file",accept:"image/*",onChange:ze,className:"hidden"})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 space-y-2",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-600 flex items-center gap-1",children:[e.jsx("span",{children:"ðŸ”§"})," ê¸°íƒ€"]}),e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:a.admin.autoToolSwitch,onChange:t=>h("admin",{autoToolSwitch:t.target.checked}),className:"rounded"}),e.jsx("span",{children:"ê°ì²´ ìƒì„± í›„ ìžë™ìœ¼ë¡œ ì„ íƒ ë„êµ¬ë¡œ ì „í™˜"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"ê¸°ë³¸ í°íŠ¸ í¬ê¸°"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>h("admin",{defaultFontSize:Math.max(8,a.admin.defaultFontSize-2)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–¼"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-white py-1 rounded border",children:[a.admin.defaultFontSize,"px"]}),e.jsx("button",{onClick:()=>h("admin",{defaultFontSize:Math.min(72,a.admin.defaultFontSize+2)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–²"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"ê¸°ë³¸ ë°•ìŠ¤ í¬ê¸°"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500 mb-1 block",children:"ê°€ë¡œ"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>h("admin",{defaultBoxWidth:Math.max(50,a.admin.defaultBoxWidth-10)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â—€"}),e.jsxs("span",{className:"flex-1 text-center text-xs font-mono bg-white py-1 rounded border",children:[a.admin.defaultBoxWidth,"px"]}),e.jsx("button",{onClick:()=>h("admin",{defaultBoxWidth:Math.min(500,a.admin.defaultBoxWidth+10)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–¶"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500 mb-1 block",children:"ì„¸ë¡œ"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>h("admin",{defaultBoxHeight:Math.max(30,a.admin.defaultBoxHeight-10)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–²"}),e.jsxs("span",{className:"flex-1 text-center text-xs font-mono bg-white py-1 rounded border",children:[a.admin.defaultBoxHeight,"px"]}),e.jsx("button",{onClick:()=>h("admin",{defaultBoxHeight:Math.min(200,a.admin.defaultBoxHeight+10)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–¼"})]})]})]})]})]})]})]})]})})]})},fe=G.memo(()=>{const{zoom:x,setZoom:p,fitToWindow:k}=J(),S=g.useCallback(()=>{p(Math.min(x*1.2,5))},[x,p]),u=g.useCallback(()=>{p(Math.max(x/1.2,.05))},[x,p]),w=g.useCallback(()=>{k()},[k]),M=g.useCallback(()=>{p(1)},[p]);return e.jsxs("div",{className:"fixed bottom-4 right-4 flex flex-col gap-2 z-50",children:[e.jsx("button",{onClick:S,className:"w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:shadow-lg transition-shadow flex items-center justify-center text-lg font-semibold",title:"í™•ëŒ€ (Ctrl + íœ  ìœ„ ë˜ëŠ” Ctrl + +)",children:"+"}),e.jsx("button",{onClick:u,className:"w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:shadow-lg transition-shadow flex items-center justify-center text-lg font-semibold",title:"ì¶•ì†Œ (Ctrl + íœ  ì•„ëž˜ ë˜ëŠ” Ctrl + -)",children:"-"}),e.jsx("button",{onClick:M,className:"w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:shadow-lg transition-shadow flex items-center justify-center text-xs font-semibold",title:"100% í¬ê¸°",children:"1:1"}),e.jsx("button",{onClick:w,className:"w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:shadow-lg transition-shadow flex items-center justify-center text-xs font-semibold",title:"ì°½ë§žì¶¤",children:"âŒ‚"})]})});fe.displayName="ZoomControls";const Ue=()=>{const{currentTool:x}=J(),{penColor:p,penWidth:k,usePerfectFreehand:S,defaultColors:u,setPenColor:w,setPenWidth:M,setUsePerfectFreehand:B}=Re();if(x!=="pen"&&x!=="eraser")return null;const R=[2,4,6,8,12];return e.jsx("div",{className:"absolute left-4 top-20 bg-white border border-gray-300 rounded-lg shadow-lg p-4 z-50",style:{minWidth:"280px"},children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:x==="pen"?"í•„ê¸° ì„¤ì •":"ì§€ìš°ê°œ ì„¤ì •"}),x==="pen"&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"ìƒ‰ìƒ"}),e.jsx("div",{className:"grid grid-cols-5 gap-1",children:u.map((c,h)=>e.jsx("button",{className:`w-8 h-8 rounded border-2 ${p===c?"border-blue-500 border-4":"border-gray-300"}`,style:{backgroundColor:c},onClick:()=>w(c),title:c},h))})]}),x==="pen"&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"êµµê¸°"}),e.jsx("div",{className:"flex gap-2",children:R.map(c=>e.jsxs("button",{className:`px-3 py-2 rounded text-xs ${k===c?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,onClick:()=>M(c),children:[c,"px"]},c))})]}),x==="pen"&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"ë Œë”ë§ í’ˆì§ˆ"}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S,onChange:c=>B(c.target.checked),className:"rounded"}),e.jsx("span",{className:"text-xs text-gray-700",children:"ê³ í’ˆì§ˆ ë Œë”ë§ (Perfect Freehand)"})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:S?"âœ¨ ì••ë ¥ ê°ì§€ ë° ë¶€ë“œëŸ¬ìš´ ê³¡ì„  í™œì„±í™”":"ðŸ“ ê¸°ë³¸ ì„  ë Œë”ë§ (ë¹ ë¥¸ ì„±ëŠ¥)"})]})]})})},Ve=()=>{const{initializeFirebaseListeners:x}=q();return g.useEffect(()=>(x(),()=>{const{cleanupFirebaseListeners:p}=q.getState();p()}),[x]),e.jsxs("div",{className:"w-screen h-screen overflow-hidden flex",children:[e.jsx("div",{className:"w-72 h-full bg-slate-100/95 backdrop-blur-sm shadow-xl border-r border-slate-200",children:e.jsx(De,{})}),e.jsxs("main",{className:"flex-1 h-full relative",children:[e.jsx(He,{isViewPage:!1}),e.jsx(Ue,{})]}),e.jsx(fe,{})]})};export{Ve as default};
