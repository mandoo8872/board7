import{j as e,r as j,R as Oe}from"./index-DU8nZSvM.js";import{u as he,s as D,r as W,d as R,a as _,b as K,c as Ze,C as Je,e as Ve}from"./Canvas-DnPuSHfj.js";const me=t=>t.trim()?t.split(`
`).filter(s=>s.trim()!=="").map(s=>s.split("	")):[],be=["#000000","#ffffff","#cccccc","#ff0000","#00ff00","#0000ff","#ffff00","#ff00ff","#00ffff","#ffa500","#800080"],Ge=[{id:"select",label:"ì„ íƒ",icon:"ðŸ‘†"},{id:"text",label:"í…ìŠ¤íŠ¸",icon:"ðŸ“"},{id:"checkbox",label:"ì²´í¬",icon:"â˜‘ï¸"},{id:"image",label:"ì´ë¯¸ì§€",icon:"ðŸ–¼ï¸"},{id:"pen",label:"í•„ê¸°",icon:"âœï¸"},{id:"eraser",label:"ì§€ìš°ê°œ",icon:"ðŸ§½"}],H=t=>t&&typeof t.hasCheckbox<"u",Ue=t=>t&&typeof t.src<"u",Xe=t=>t&&"cellType"in t&&t.cellType==="cell",ue=(t,l)=>{var s,o,a;if(!t||!H(t))return"#000000";switch(l){case"text":return((s=t.textStyle)==null?void 0:s.color)||"#000000";case"background":return((o=t.boxStyle)==null?void 0:o.backgroundColor)||"transparent";case"border":return((a=t.boxStyle)==null?void 0:a.borderColor)||"#000000";default:return"#000000"}},_e=(t,l)=>{const s=[...t,...l];return Math.max(...s.map(o=>o.zIndex||0))},Ke=(t,l)=>{const s=[...t,...l];return Math.min(...s.map(o=>o.zIndex||0))},Ye=(t,l,s)=>{const a=[...l,...s].filter(c=>(c.zIndex||0)>t);return a.length===0?null:Math.min(...a.map(c=>c.zIndex||0))},qe=(t,l,s)=>{const a=[...l,...s].filter(c=>(c.zIndex||0)<t);return a.length===0?null:Math.max(...a.map(c=>c.zIndex||0))},ge=t=>{const l=me(t);if(l.length===0)return{rows:0,cols:0};const s=l.length,o=Math.max(...l.map(a=>a.length));return{rows:s,cols:o}},Qe=t=>t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable||t.closest("input, textarea, [contenteditable]")!==null,et=t=>t.hasAttribute("data-canvas-container")||t.tabIndex===0&&t.tagName==="DIV",tt=({currentTool:t,onToolSelect:l,onCreateText:s,onCreateCheckbox:o,onCreateImage:a})=>{const c=h=>{switch(h){case"select":l("select");break;case"text":s();break;case"checkbox":o();break;case"image":a();break;case"pen":case"eraser":l(h);break}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"âš¡"})," ë©”ì¸ ë„êµ¬"]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Ge.map(h=>e.jsxs("button",{onClick:()=>c(h.id),className:`p-3 rounded-lg flex flex-col items-center gap-1 transition-all duration-200 border-2
              ${t===h.id?"bg-blue-500 text-white border-blue-600 shadow-lg scale-105":"bg-slate-50 hover:bg-slate-100 text-slate-700 border-slate-200 hover:border-slate-300"}`,children:[e.jsx("span",{className:"text-2xl",children:h.icon}),e.jsx("span",{className:"text-xs font-medium",children:h.label})]},h.id))})]})},st=({isExpanded:t,onToggle:l,excelPasteData:s,showPreview:o,safeSettings:a,onDataChange:c,onPreviewToggle:h,onCreateCells:g,onDeleteCellGroups:N,updateSettings:p})=>{const m=ge(s),n=r=>{c(r);const d=new CustomEvent("excel-preview-update",{detail:{data:r,show:!!r.trim()}});window.dispatchEvent(d)};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("button",{onClick:l,className:"w-full p-4 flex items-center justify-between text-sm font-bold text-slate-700 hover:bg-slate-50 rounded-t-xl transition-colors",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ“Š"})," ì—‘ì…€ ë°ì´í„° ìž…ë ¥"]}),e.jsx("span",{className:`text-slate-400 transition-transform duration-200 ${t?"rotate-180":""}`,children:"â–¼"})]}),t&&e.jsxs("div",{className:"p-4 border-t border-slate-200 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"ë°ì´í„° ë¶™ì—¬ë„£ê¸°"}),e.jsx("textarea",{value:s,onChange:r=>n(r.target.value),onFocus:r=>r.stopPropagation(),onClick:r=>r.stopPropagation(),placeholder:"ì—‘ì…€ì—ì„œ ë³µì‚¬í•œ ë°ì´í„°ë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”...",className:"w-full px-3 py-2 border border-slate-300 rounded-lg text-xs resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:s?`${m.rows}í–‰ Ã— ${m.cols}ì—´`:"ë°ì´í„° ì—†ìŒ"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"X ì¢Œí‘œ"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>p("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,startPosition:{...a.admin.excelPasteSettings.startPosition,x:Math.max(0,a.admin.excelPasteSettings.startPosition.x-10)}}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs font-mono",children:"â—€"}),e.jsx("input",{type:"number",value:a.admin.excelPasteSettings.startPosition.x,onChange:r=>p("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,startPosition:{...a.admin.excelPasteSettings.startPosition,x:parseInt(r.target.value)||0}}}),onFocus:r=>r.stopPropagation(),onClick:r=>r.stopPropagation(),className:"w-16 px-1 py-1 border border-slate-300 rounded text-xs text-center"}),e.jsx("button",{onClick:()=>p("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,startPosition:{...a.admin.excelPasteSettings.startPosition,x:a.admin.excelPasteSettings.startPosition.x+10}}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs font-mono",children:"â–¶"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"Y ì¢Œí‘œ"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>p("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,startPosition:{...a.admin.excelPasteSettings.startPosition,y:Math.max(0,a.admin.excelPasteSettings.startPosition.y-10)}}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs font-mono",children:"â–²"}),e.jsx("input",{type:"number",value:a.admin.excelPasteSettings.startPosition.y,onChange:r=>p("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,startPosition:{...a.admin.excelPasteSettings.startPosition,y:parseInt(r.target.value)||0}}}),onFocus:r=>r.stopPropagation(),onClick:r=>r.stopPropagation(),className:"w-16 px-1 py-1 border border-slate-300 rounded text-xs text-center"}),e.jsx("button",{onClick:()=>p("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,startPosition:{...a.admin.excelPasteSettings.startPosition,y:a.admin.excelPasteSettings.startPosition.y+10}}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs font-mono",children:"â–¼"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"ì…€ ë„ˆë¹„"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>p("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,cellWidth:Math.max(20,a.admin.excelPasteSettings.cellWidth-1)}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â—€"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded",children:[a.admin.excelPasteSettings.cellWidth,"px"]}),e.jsx("button",{onClick:()=>p("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,cellWidth:Math.min(300,a.admin.excelPasteSettings.cellWidth+1)}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–¶"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"ì…€ ë†’ì´"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>p("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,cellHeight:Math.max(20,a.admin.excelPasteSettings.cellHeight-1)}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–²"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded",children:[a.admin.excelPasteSettings.cellHeight,"px"]}),e.jsx("button",{onClick:()=>p("admin",{excelPasteSettings:{...a.admin.excelPasteSettings,cellHeight:Math.min(100,a.admin.excelPasteSettings.cellHeight+1)}}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–¼"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:g,disabled:!s.trim(),className:"flex-1 px-4 py-2 bg-green-500 hover:bg-green-600 disabled:bg-gray-300 text-white rounded-lg text-sm font-medium transition-colors",children:"ðŸ“‹ ì…€ ìƒì„±"}),e.jsxs("button",{onClick:h,disabled:!s.trim(),className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white rounded-lg text-sm font-medium transition-colors",children:["ðŸ‘ï¸ ",o?"ìˆ¨ê¹€":"ë¯¸ë¦¬ë³´ê¸°"]})]}),e.jsx("button",{onClick:N,className:"w-full px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm font-medium transition-colors",title:"ìƒì„±ëœ ëª¨ë“  ì—‘ì…€ ì…€ ê·¸ë£¹ì„ ì‚­ì œí•©ë‹ˆë‹¤",children:"ðŸ—‘ï¸ ì—‘ì…€ ì…€ ê·¸ë£¹ ì‚­ì œ"})]})]})]})},lt=({colorMode:t,currentColor:l,onColorModeChange:s,onColorSelect:o,showTransparent:a=!1})=>e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"ìƒ‰ìƒ"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 mb-3",children:[e.jsx("button",{onClick:()=>s("text"),className:`px-2 py-2 rounded text-xs transition-colors ${t==="text"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"í…ìŠ¤íŠ¸"}),e.jsx("button",{onClick:()=>s("background"),className:`px-2 py-2 rounded text-xs transition-colors ${t==="background"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"ë°°ê²½"}),e.jsx("button",{onClick:()=>s("border"),className:`px-2 py-2 rounded text-xs transition-colors ${t==="border"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"í…Œë‘ë¦¬"})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[a&&e.jsx("button",{onClick:()=>o("transparent"),className:`w-8 h-8 rounded border-2 transition-all ${l==="transparent"?"border-blue-500 border-2 shadow-md":"border-slate-300 hover:border-slate-400"}`,style:{backgroundColor:"white",backgroundImage:"linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(-45deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(-45deg, transparent 75%, #ccc 75%)",backgroundSize:"8px 8px",backgroundPosition:"0 0, 0 4px, 4px -4px, -4px 0px"},title:"íˆ¬ëª…"}),be.map((c,h)=>{const g=l===c;return e.jsx("button",{onClick:()=>o(c),className:`w-8 h-8 rounded border-2 transition-all ${g?"border-blue-500 border-2 shadow-md":"border-slate-300 hover:border-slate-400"}`,style:{backgroundColor:c},title:c},h)})]})]}),at=({onDuplicate:t,onDelete:l,onBringToFront:s,onBringForward:o,onSendBackward:a,onSendToBack:c})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:t,className:"flex-1 px-3 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg text-xs font-medium transition-colors",children:"ðŸ“‹ ë³µì‚¬"}),e.jsx("button",{onClick:l,className:"flex-1 px-3 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-xs font-medium transition-colors",children:"ðŸ—‘ï¸ ì‚­ì œ"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"ë ˆì´ì–´ ìˆœì„œ"}),e.jsxs("div",{className:"grid grid-cols-4 gap-1",children:[e.jsx("button",{onClick:s,className:"px-2 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded text-xs font-medium transition-colors",title:"ë§¨ ìœ„ë¡œ",children:"â¬†â¬†"}),e.jsx("button",{onClick:o,className:"px-2 py-1 bg-blue-400 hover:bg-blue-500 text-white rounded text-xs font-medium transition-colors",title:"ìœ„ë¡œ",children:"â¬†"}),e.jsx("button",{onClick:a,className:"px-2 py-1 bg-purple-400 hover:bg-purple-500 text-white rounded text-xs font-medium transition-colors",title:"ì•„ëž˜ë¡œ",children:"â¬‡"}),e.jsx("button",{onClick:c,className:"px-2 py-1 bg-purple-500 hover:bg-purple-600 text-white rounded text-xs font-medium transition-colors",title:"ë§¨ ì•„ëž˜ë¡œ",children:"â¬‡â¬‡"})]})]})]}),nt=({selectedObject:t,colorMode:l,onColorModeChange:s,onColorSelect:o,onUpdateTextObject:a,onUpdateImageObject:c,onDuplicate:h,onDelete:g,onBringToFront:N,onBringForward:p,onSendBackward:m,onSendToBack:n,getCurrentColor:r})=>{var E,x,C;if(!t)return null;const d=r(),f=i=>{if(H(t)){const y=t.textStyle||{color:"#000000",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"};a(t.id,{textStyle:{...y,...i}})}},I=i=>{if(H(t)){const y=t.boxStyle||{backgroundColor:"transparent",backgroundOpacity:1,borderColor:"#000000",borderWidth:0,borderRadius:0};a(t.id,{boxStyle:{...y,...i}})}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"âœï¸"})," ì„ íƒëœ ê°ì²´ íŽ¸ì§‘"]}),H(t)&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"í…ìŠ¤íŠ¸"}),e.jsx("textarea",{value:t.text,onChange:i=>a(t.id,{text:i.target.value}),onFocus:i=>i.stopPropagation(),onClick:i=>i.stopPropagation(),className:"w-full px-3 py-2 border border-slate-300 rounded-lg text-sm resize-none focus:ring-2 focus:ring-blue-500",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"í°íŠ¸ í¬ê¸°"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>a(t.id,{fontSize:Math.max(8,t.fontSize-2)}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–¼"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded border",children:[t.fontSize,"px"]}),e.jsx("button",{onClick:()=>a(t.id,{fontSize:Math.min(72,t.fontSize+2)}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–²"})]})]}),e.jsx(lt,{colorMode:l,currentColor:d,onColorModeChange:s,onColorSelect:o,showTransparent:l==="background"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{var i;return f({bold:!((i=t.textStyle)!=null&&i.bold)})},className:`px-3 py-1 rounded-lg text-xs transition-colors ${(E=t.textStyle)!=null&&E.bold?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"êµµê²Œ"}),e.jsx("button",{onClick:()=>{var i;return f({italic:!((i=t.textStyle)!=null&&i.italic)})},className:`px-3 py-1 rounded-lg text-xs transition-colors ${(x=t.textStyle)!=null&&x.italic?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"ê¸°ìš¸ìž„"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"í…ìŠ¤íŠ¸ ì •ë ¬"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"ê°€ë¡œ"}),e.jsx("div",{className:"grid grid-cols-3 gap-1",children:["left","center","right"].map(i=>{var y;return e.jsx("button",{onClick:()=>f({horizontalAlign:i}),className:`px-2 py-1 rounded text-xs transition-colors ${((y=t.textStyle)==null?void 0:y.horizontalAlign)===i?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:i==="left"?"â—€":i==="center"?"â—":"â–¶"},i)})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"ì„¸ë¡œ"}),e.jsx("div",{className:"grid grid-cols-3 gap-1",children:["top","middle","bottom"].map(i=>{var y;return e.jsx("button",{onClick:()=>f({verticalAlign:i}),className:`px-2 py-1 rounded text-xs transition-colors ${((y=t.textStyle)==null?void 0:y.verticalAlign)===i?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:i==="top"?"â–²":i==="middle"?"â—":"â–¼"},i)})})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"í…Œë‘ë¦¬ ë‘ê»˜"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{var i;return I({borderWidth:Math.max(0,(((i=t.boxStyle)==null?void 0:i.borderWidth)||0)-1)})},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–¼"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded",children:[((C=t.boxStyle)==null?void 0:C.borderWidth)||0,"px"]}),e.jsx("button",{onClick:()=>{var i;return I({borderWidth:Math.min(10,(((i=t.boxStyle)==null?void 0:i.borderWidth)||0)+1)})},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–²"})]})]})]}),Ue(t)&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:t.maintainAspectRatio||!1,onChange:i=>c(t.id,{maintainAspectRatio:i.target.checked}),className:"rounded"}),e.jsx("span",{children:"ë¹„ìœ¨ ìœ ì§€"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"ë¶ˆíˆ¬ëª…ë„"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>c(t.id,{opacity:Math.max(.1,(t.opacity||1)-.1)}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–¼"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded",children:[Math.round((t.opacity||1)*100),"%"]}),e.jsx("button",{onClick:()=>c(t.id,{opacity:Math.min(1,(t.opacity||1)+.1)}),className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–²"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"í¬ê¸°"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-600 mb-1 block",children:"ë„ˆë¹„"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{const i=Math.max(50,t.width-10),y=t.maintainAspectRatio?{width:i,height:i/(t.width/t.height)}:{width:i};c(t.id,y)},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â—€"}),e.jsx("span",{className:"flex-1 text-center text-xs font-mono bg-slate-50 py-1 rounded",children:Math.round(t.width)}),e.jsx("button",{onClick:()=>{const i=t.width+10,y=t.maintainAspectRatio?{width:i,height:i/(t.width/t.height)}:{width:i};c(t.id,y)},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–¶"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-600 mb-1 block",children:"ë†’ì´"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{const i=Math.max(30,t.height-10),y=t.maintainAspectRatio?{height:i,width:i*(t.width/t.height)}:{height:i};c(t.id,y)},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–²"}),e.jsx("span",{className:"flex-1 text-center text-xs font-mono bg-slate-50 py-1 rounded",children:Math.round(t.height)}),e.jsx("button",{onClick:()=>{const i=t.height+10,y=t.maintainAspectRatio?{height:i,width:i*(t.width/t.height)}:{height:i};c(t.id,y)},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–¼"})]})]})]})]})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-slate-200",children:e.jsx(at,{onDuplicate:h,onDelete:g,onBringToFront:N,onBringForward:p,onSendBackward:m,onSendToBack:n})})]})},ot=({textObjects:t,colorMode:l,onColorModeChange:s,onUpdateTextObject:o,clearCellSelection:a})=>{const{getSelectedCells:c,getSelectedCount:h}=he.getState(),g=c(),N=h();if(N===0)return null;const p=["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#FFC0CB","#A52A2A","#808080","#008000","#000080","#800000","#008080","#C0C0C0","#FFFFE0","#F0F8FF"];return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ“Š"})," ì„ íƒëœ ì—‘ì…€ ì…€ (",N,"ê°œ)"]}),e.jsx("button",{onClick:a,className:"text-xs text-slate-500 hover:text-slate-700 bg-slate-100 hover:bg-slate-200 px-2 py-1 rounded transition-colors",children:"ì„ íƒ í•´ì œ"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"í°íŠ¸ í¬ê¸°"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:async()=>{let m=72;for(const r of g){const d=t.find(f=>f.id===r);d&&d.cellType==="cell"&&(m=Math.min(m,d.fontSize))}const n=Math.max(8,m-2);for(const r of g){const d=t.find(f=>f.id===r);d&&d.cellType==="cell"&&await o(r,{fontSize:n})}},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–¼"}),e.jsx("span",{className:"flex-1 text-center text-sm font-mono bg-slate-50 py-1 rounded border",children:"ì¼ê´„ ë³€ê²½"}),e.jsx("button",{onClick:async()=>{let m=8;for(const r of g){const d=t.find(f=>f.id===r);d&&d.cellType==="cell"&&(m=Math.min(m,d.fontSize))}const n=Math.min(72,m+2);for(const r of g){const d=t.find(f=>f.id===r);d&&d.cellType==="cell"&&await o(r,{fontSize:n})}},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs",children:"â–²"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"ìƒ‰ìƒ"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 mb-3",children:[e.jsx("button",{onClick:()=>s("text"),className:`px-2 py-2 rounded text-xs transition-colors ${l==="text"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"í…ìŠ¤íŠ¸"}),e.jsx("button",{onClick:()=>s("background"),className:`px-2 py-2 rounded text-xs transition-colors ${l==="background"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"ë°°ê²½"}),e.jsx("button",{onClick:()=>s("border"),className:`px-2 py-2 rounded text-xs transition-colors ${l==="border"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-700"}`,children:"í…Œë‘ë¦¬"})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[l==="background"&&e.jsx("button",{onClick:async()=>{for(const m of g){const n=t.find(r=>r.id===m);if(n&&n.cellType==="cell"){const r=n.boxStyle||{backgroundColor:"transparent",backgroundOpacity:1,borderColor:"#000000",borderWidth:0,borderRadius:0};await o(m,{boxStyle:{...r,backgroundColor:"transparent"}})}}},className:"w-8 h-8 rounded border-2 border-gray-300 bg-white flex items-center justify-center hover:bg-gray-50 transition-colors",title:"íˆ¬ëª…",children:e.jsx("span",{className:"text-red-500 text-xs",children:"âˆ…"})}),p.map(m=>e.jsx("button",{onClick:async()=>{for(const n of g){const r=t.find(d=>d.id===n);if(r&&r.cellType==="cell"){if(l==="text"){const d=r.textStyle||{color:"#000000",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"};await o(n,{textStyle:{...d,color:m}})}else if(l==="background"){const d=r.boxStyle||{backgroundColor:"transparent",backgroundOpacity:1,borderColor:"#000000",borderWidth:0,borderRadius:0};await o(n,{boxStyle:{...d,backgroundColor:m}})}else if(l==="border"){const d=r.boxStyle||{backgroundColor:"transparent",backgroundOpacity:1,borderColor:"#000000",borderWidth:0,borderRadius:0};await o(n,{boxStyle:{...d,borderColor:m,borderWidth:1}})}}}},className:"w-8 h-8 rounded border border-gray-300 hover:scale-110 transition-transform",style:{backgroundColor:m},title:m},m))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{for(const m of g){const n=t.find(r=>r.id===m);if(n&&n.cellType==="cell"){const r=n.textStyle||{color:"#000000",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"};await o(m,{textStyle:{...r,bold:!r.bold}})}}},className:"px-3 py-2 bg-slate-100 hover:bg-slate-200 rounded text-xs font-bold transition-colors",children:"B"}),e.jsx("button",{onClick:async()=>{for(const m of g){const n=t.find(r=>r.id===m);if(n&&n.cellType==="cell"){const r=n.textStyle||{color:"#000000",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"};await o(m,{textStyle:{...r,italic:!r.italic}})}}},className:"px-3 py-2 bg-slate-100 hover:bg-slate-200 rounded text-xs italic transition-colors",children:"I"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"ì •ë ¬"}),e.jsx("div",{className:"grid grid-cols-3 gap-1 mb-2",children:["left","center","right"].map(m=>e.jsx("button",{onClick:async()=>{for(const n of g){const r=t.find(d=>d.id===n);if(r&&r.cellType==="cell"){const d=r.textStyle||{color:"#000000",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"};await o(n,{textStyle:{...d,horizontalAlign:m}})}}},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs transition-colors",children:m==="left"?"â†":m==="center"?"â†”":"â†’"},m))}),e.jsx("div",{className:"grid grid-cols-3 gap-1",children:["top","middle","bottom"].map(m=>e.jsx("button",{onClick:async()=>{for(const n of g){const r=t.find(d=>d.id===n);if(r&&r.cellType==="cell"){const d=r.textStyle||{color:"#000000",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"};await o(n,{textStyle:{...d,verticalAlign:m}})}}},className:"px-2 py-1 bg-slate-100 hover:bg-slate-200 rounded text-xs transition-colors",children:m==="top"?"â†‘":m==="middle"?"â†•":"â†“"},m))})]})]})]})},rt=({isExpanded:t,onToggle:l,textObjects:s,imageObjects:o,drawObjects:a,floorImage:c,settings:h,initializeFirebaseListeners:g})=>{const N=j.useRef(null),p=()=>{try{const d={textObjects:s,imageObjects:o,drawObjects:a,floorImage:c,settings:h,exportedAt:new Date().toISOString(),version:"1.0"},f=JSON.stringify(d,null,2),I=new Blob([f],{type:"application/json"}),C=`board7-backup-${new Date().toISOString().replace(/[:.]/g,"-").slice(0,19)}.json`,i=document.createElement("a");i.href=URL.createObjectURL(I),i.download=C,i.click(),URL.revokeObjectURL(i.href),alert(`âœ… ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤!
íŒŒì¼ëª…: ${C}`)}catch(d){console.error("ë°ì´í„° ì €ìž¥ ì˜¤ë¥˜:",d),alert("âŒ ë°ì´í„° ì €ìž¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},m=()=>{var d;(d=N.current)==null||d.click()},n=d=>{var x;const f=(x=d.target.files)==null?void 0:x[0];if(!f)return;if(!f.name.endsWith(".json")){alert("âŒ JSON íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.");return}const I=`âš ï¸ ê²½ê³ : í˜„ìž¬ ìº”ë²„ìŠ¤ì˜ ëª¨ë“  ê°ì²´ì™€ ê·¸ë¦¬ê¸° ìš”ì†Œê°€ ì‚­ì œë©ë‹ˆë‹¤!

í˜„ìž¬ ë°ì´í„°:
â€¢ í…ìŠ¤íŠ¸ ê°ì²´: ${s.length}ê°œ
â€¢ ì´ë¯¸ì§€ ê°ì²´: ${o.length}ê°œ  
â€¢ ê·¸ë¦¬ê¸° ìš”ì†Œ: ${a.length}ê°œ
â€¢ ë°°ê²½ ì´ë¯¸ì§€: ${c?"ìžˆìŒ":"ì—†ìŒ"}

ì •ë§ë¡œ ë¶ˆëŸ¬ì˜¤ì‹œê² ìŠµë‹ˆê¹Œ?`;if(!confirm(I)){d.target.value="";return}const E=new FileReader;E.onload=async C=>{var i,y,$,A;try{const T=(i=C.target)==null?void 0:i.result,z=JSON.parse(T);if(!z.version||!z.exportedAt)throw new Error("ì˜¬ë°”ë¥´ì§€ ì•Šì€ ë°±ì—… íŒŒì¼ í˜•ì‹ìž…ë‹ˆë‹¤.");await r(z),alert(`âœ… ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™€ì¡ŒìŠµë‹ˆë‹¤!

ë¶ˆëŸ¬ì˜¨ ë°ì´í„°:
â€¢ í…ìŠ¤íŠ¸ ê°ì²´: ${((y=z.textObjects)==null?void 0:y.length)||0}ê°œ
â€¢ ì´ë¯¸ì§€ ê°ì²´: ${(($=z.imageObjects)==null?void 0:$.length)||0}ê°œ
â€¢ ê·¸ë¦¬ê¸° ìš”ì†Œ: ${((A=z.drawObjects)==null?void 0:A.length)||0}ê°œ
â€¢ ë°°ê²½ ì´ë¯¸ì§€: ${z.floorImage?"ìžˆìŒ":"ì—†ìŒ"}
â€¢ ë°±ì—… ìƒì„±ì¼: ${new Date(z.exportedAt).toLocaleString()}`)}catch(T){console.error("ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:",T),alert(`âŒ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.
íŒŒì¼ì´ ì†ìƒë˜ì—ˆê±°ë‚˜ ì˜¬ë°”ë¥´ì§€ ì•Šì€ í˜•ì‹ìž…ë‹ˆë‹¤.`)}d.target.value=""},E.readAsText(f)},r=async d=>{var f,I,E;try{await Promise.all([D(W(R,"textObjects"),null),D(W(R,"imageObjects"),null),D(W(R,"drawObjects"),null),D(W(R,"floorImage"),null)]);const x=[];if(((f=d.textObjects)==null?void 0:f.length)>0){const C=d.textObjects.reduce((i,y)=>(i[y.id]=y,i),{});x.push(D(W(R,"textObjects"),C))}if(((I=d.imageObjects)==null?void 0:I.length)>0){const C=d.imageObjects.reduce((i,y)=>(i[y.id]=y,i),{});x.push(D(W(R,"imageObjects"),C))}if(((E=d.drawObjects)==null?void 0:E.length)>0){const C=d.drawObjects.reduce((i,y)=>(i[y.id]=y,i),{});x.push(D(W(R,"drawObjects"),C))}d.floorImage&&x.push(D(W(R,"floorImage"),d.floorImage)),d.settings&&x.push(D(W(R,"settings"),d.settings)),await Promise.all(x),setTimeout(()=>{g()},500)}catch(x){throw console.error("ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:",x),x}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("button",{onClick:l,className:"w-full p-4 flex items-center justify-between text-sm font-bold text-slate-700 hover:bg-slate-50 rounded-t-xl transition-colors",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ’¾"})," ë°ì´í„° ê´€ë¦¬"]}),e.jsx("span",{className:`text-slate-400 transition-transform duration-200 ${t?"rotate-180":""}`,children:"â–¼"})]}),t&&e.jsxs("div",{className:"p-4 border-t border-slate-200 space-y-4",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 space-y-2",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-600 flex items-center gap-1",children:[e.jsx("span",{children:"ðŸ“Š"})," í˜„ìž¬ ë°ì´í„° í˜„í™©"]}),e.jsxs("div",{className:"text-xs text-slate-600 space-y-1",children:[e.jsxs("div",{children:["â€¢ í…ìŠ¤íŠ¸ ê°ì²´: ",e.jsxs("span",{className:"font-medium",children:[s.length,"ê°œ"]})]}),e.jsxs("div",{children:["â€¢ ì´ë¯¸ì§€ ê°ì²´: ",e.jsxs("span",{className:"font-medium",children:[o.length,"ê°œ"]})]}),e.jsxs("div",{children:["â€¢ ê·¸ë¦¬ê¸° ìš”ì†Œ: ",e.jsxs("span",{className:"font-medium",children:[a.length,"ê°œ"]})]}),e.jsxs("div",{children:["â€¢ ë°°ê²½ ì´ë¯¸ì§€: ",e.jsx("span",{className:"font-medium",children:c?"ìžˆìŒ":"ì—†ìŒ"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:p,className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2 text-sm",children:[e.jsx("span",{children:"ðŸ’¾"}),"ë°ì´í„° ì €ìž¥ (JSON ë‹¤ìš´ë¡œë“œ)"]}),e.jsxs("button",{onClick:m,className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2 text-sm",children:[e.jsx("span",{children:"ðŸ“‚"}),"ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° (JSON ì—…ë¡œë“œ)"]}),e.jsx("input",{ref:N,type:"file",accept:".json",onChange:n,className:"hidden"})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:[e.jsxs("h5",{className:"text-xs font-bold text-yellow-700 mb-2 flex items-center gap-1",children:[e.jsx("span",{children:"âš ï¸"})," ì£¼ì˜ì‚¬í•­"]}),e.jsxs("div",{className:"text-xs text-yellow-700 space-y-1",children:[e.jsx("div",{children:"â€¢ ë¶ˆëŸ¬ì˜¤ê¸° ì‹œ í˜„ìž¬ ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤"}),e.jsx("div",{children:"â€¢ ì €ìž¥ëœ JSON íŒŒì¼ì€ ì˜¤í”„ë¼ì¸ì—ì„œ ë³´ê´€ë©ë‹ˆë‹¤"}),e.jsx("div",{children:"â€¢ ë°±ì—…ì„ ì •ê¸°ì ìœ¼ë¡œ ìƒì„±í•˜ëŠ” ê²ƒì„ ê¶Œìž¥í•©ë‹ˆë‹¤"})]})]})]})]})},it=({isExpanded:t,onToggle:l,safeSettings:s,updateSettings:o,onImageUpload:a})=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("button",{onClick:l,className:"w-full p-4 flex items-center justify-between text-sm font-bold text-slate-700 hover:bg-slate-50 rounded-t-xl transition-colors",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"âš™ï¸"})," ì„¤ì •"]}),e.jsx("span",{className:`text-slate-400 transition-transform duration-200 ${t?"rotate-180":""}`,children:"â–¼"})]}),t&&e.jsxs("div",{className:"p-4 border-t border-slate-200 space-y-4",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 space-y-3",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-600 flex items-center gap-1",children:[e.jsx("span",{children:"ðŸ”²"})," ê·¸ë¦¬ë“œ"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:s.admin.gridVisible,onChange:c=>o("admin",{gridVisible:c.target.checked}),className:"rounded"}),e.jsx("span",{children:"ê·¸ë¦¬ë“œ í‘œì‹œ"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:s.admin.gridSnapEnabled,onChange:c=>o("admin",{gridSnapEnabled:c.target.checked}),className:"rounded"}),e.jsx("span",{children:"ê·¸ë¦¬ë“œì— ìŠ¤ëƒ…"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"ê·¸ë¦¬ë“œ í¬ê¸°"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>o("admin",{gridSize:Math.max(8,s.admin.gridSize-4)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–¼"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-white py-1 rounded border",children:[s.admin.gridSize,"px"]}),e.jsx("button",{onClick:()=>o("admin",{gridSize:Math.min(64,s.admin.gridSize+4)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–²"})]})]})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 space-y-3",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-600 flex items-center gap-1",children:[e.jsx("span",{children:"ðŸ“"})," ê°ì²´ ìƒì„± ìœ„ì¹˜"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"X ì¢Œí‘œ"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{const c=Math.max(0,s.admin.objectCreationPosition.x-20);o("admin",{objectCreationPosition:{...s.admin.objectCreationPosition,x:c}})},className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â—€"}),e.jsx("span",{className:"flex-1 text-center text-xs font-mono bg-white py-1 rounded border",children:s.admin.objectCreationPosition.x}),e.jsx("button",{onClick:()=>{const c=s.admin.objectCreationPosition.x+20;o("admin",{objectCreationPosition:{...s.admin.objectCreationPosition,x:c}})},className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–¶"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"Y ì¢Œí‘œ"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{const c=Math.max(0,s.admin.objectCreationPosition.y-20);o("admin",{objectCreationPosition:{...s.admin.objectCreationPosition,y:c}})},className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–²"}),e.jsx("span",{className:"flex-1 text-center text-xs font-mono bg-white py-1 rounded border",children:s.admin.objectCreationPosition.y}),e.jsx("button",{onClick:()=>{const c=s.admin.objectCreationPosition.y+20;o("admin",{objectCreationPosition:{...s.admin.objectCreationPosition,y:c}})},className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–¼"})]})]})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-600 mb-2 flex items-center gap-1",children:[e.jsx("span",{children:"ðŸ–¼ï¸"})," ë°°ê²½ ì´ë¯¸ì§€"]}),e.jsxs("label",{className:"w-full px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors cursor-pointer text-sm font-medium flex items-center justify-center gap-2",children:[e.jsx("span",{children:"ðŸ“"}),e.jsx("span",{children:"ì´ë¯¸ì§€ ì—…ë¡œë“œ"}),e.jsx("input",{type:"file",accept:"image/*",onChange:a,className:"hidden"})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 space-y-2",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-600 flex items-center gap-1",children:[e.jsx("span",{children:"ðŸ”§"})," ê¸°íƒ€"]}),e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:s.admin.autoToolSwitch,onChange:c=>o("admin",{autoToolSwitch:c.target.checked}),className:"rounded"}),e.jsx("span",{children:"ê°ì²´ ìƒì„± í›„ ìžë™ìœ¼ë¡œ ì„ íƒ ë„êµ¬ë¡œ ì „í™˜"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-1 block",children:"ê¸°ë³¸ í°íŠ¸ í¬ê¸°"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>o("admin",{defaultFontSize:Math.max(8,s.admin.defaultFontSize-2)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–¼"}),e.jsxs("span",{className:"flex-1 text-center text-sm font-mono bg-white py-1 rounded border",children:[s.admin.defaultFontSize,"px"]}),e.jsx("button",{onClick:()=>o("admin",{defaultFontSize:Math.min(72,s.admin.defaultFontSize+2)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–²"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-600 mb-2 block",children:"ê¸°ë³¸ ë°•ìŠ¤ í¬ê¸°"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500 mb-1 block",children:"ê°€ë¡œ"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>o("admin",{defaultBoxWidth:Math.max(50,s.admin.defaultBoxWidth-10)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â—€"}),e.jsxs("span",{className:"flex-1 text-center text-xs font-mono bg-white py-1 rounded border",children:[s.admin.defaultBoxWidth,"px"]}),e.jsx("button",{onClick:()=>o("admin",{defaultBoxWidth:Math.min(500,s.admin.defaultBoxWidth+10)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–¶"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500 mb-1 block",children:"ì„¸ë¡œ"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>o("admin",{defaultBoxHeight:Math.max(30,s.admin.defaultBoxHeight-10)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–²"}),e.jsxs("span",{className:"flex-1 text-center text-xs font-mono bg-white py-1 rounded border",children:[s.admin.defaultBoxHeight,"px"]}),e.jsx("button",{onClick:()=>o("admin",{defaultBoxHeight:Math.min(200,s.admin.defaultBoxHeight+10)}),className:"px-2 py-1 bg-white hover:bg-slate-100 rounded text-xs border",children:"â–¼"})]})]})]})]})]})]})]}),ct=()=>{const[t,l]=j.useState(!1),[s,o]=j.useState(!1),[a,c]=j.useState(!1),[h,g]=j.useState(""),[N,p]=j.useState(!1),[m,n]=j.useState("text"),r=j.useRef(null);return{isSettingsExpanded:t,isExcelPasteExpanded:s,isDataManagementExpanded:a,excelPasteData:h,showPreview:N,colorMode:m,updateTimerRef:r,setIsSettingsExpanded:l,setIsExcelPasteExpanded:o,setIsDataManagementExpanded:c,setExcelPasteData:g,setShowPreview:p,setColorMode:n,toggleSettings:()=>l(!t),toggleExcelPaste:()=>o(!s),toggleDataManagement:()=>c(!a),resetExcelData:()=>{g(""),p(!1)},clearUpdateTimer:()=>{r.current&&(clearTimeout(r.current),r.current=null)}}},dt=({selectedObject:t,colorMode:l,updateTextStyle:s,updateBoxStyle:o})=>{const a=j.useCallback(h=>{if(!(!t||!H(t)))switch(l){case"text":s({color:h});break;case"background":o({backgroundColor:h});break;case"border":o({borderColor:h});break}},[l,t,s,o]),c=ue(t,l);return{colors:be,currentColor:c,handleColorSelect:a,showTransparent:l==="background"}},xe=t=>new Promise((l,s)=>{const o=new FileReader;o.onload=a=>{var h;const c=(h=a.target)==null?void 0:h.result;l(c)},o.onerror=()=>{s(new Error("íŒŒì¼ ì½ê¸° ì‹¤íŒ¨"))},o.readAsDataURL(t)}),xt=t=>new Promise((l,s)=>{const o=new Image;o.onload=()=>{l({width:o.naturalWidth,height:o.naturalHeight})},o.onerror=()=>{s(new Error("ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨"))},o.src=t}),ht=(t="image/*")=>new Promise(l=>{const s=document.createElement("input");s.type="file",s.accept=t,s.onchange=o=>{var c;const a=(c=o.target.files)==null?void 0:c[0];l(a||null)},s.click()}),mt=(t,l,s=200)=>{const o=l/t,a=s*o;return{width:s,height:a}},X=(t,l)=>{const s=new CustomEvent("excel-preview-update",{detail:{data:t,show:l}});window.dispatchEvent(s)},bt=({excelPasteData:t,showPreview:l,safeSettings:s,textObjects:o,addTextObject:a,deleteTextObject:c,onDataChange:h,onPreviewChange:g})=>{const N=ge(t),p=j.useCallback(async()=>{var L;const n=me(t);if(n.length===0){alert("ë¶™ì—¬ë„£ì„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");return}const{startPosition:r,cellWidth:d,cellHeight:f,fontSize:I,fontColor:E,backgroundColor:x,maxRows:C=100,maxCols:i=50}=s.admin.excelPasteSettings,y=`excel-input-${Date.now()}`,$=[],A=Math.min(n.length,C),T=n.map(S=>S.length),z=T.length>0?Math.max(...T):0,M=Math.min(z,i);for(let S=0;S<A;S++)for(let B=0;B<M;B++){const O=((L=n[S])==null?void 0:L[B])||"",Z={x:r.x+B*d,y:r.y+S*f,width:d,height:f,text:O,fontSize:I,textStyle:{color:E,bold:!1,italic:!1,horizontalAlign:"center",verticalAlign:"middle",fontFamily:"Arial"},boxStyle:{backgroundColor:x,backgroundOpacity:1,borderColor:"#d1d5db",borderWidth:1,borderRadius:0},permissions:{editable:!0,movable:!1,resizable:!1,deletable:!1},zIndex:Date.now()+S*M+B,locked:!0,visible:!0,opacity:1,hasCheckbox:!1,checkboxChecked:!1,checkboxCheckedColor:"#22c55e",checkboxUncheckedColor:"#f3f4f6",isEditing:!1,lastModified:Date.now(),groupId:y,cellType:"cell",cellPosition:{row:S,col:B}};$.push(Z)}try{for(const S of $)await a(S);alert(`${A}x${M} ì…€ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`),h(""),g(!1),X("",!1)}catch(S){console.error("ì—‘ì…€ ì…€ ìƒì„± ì‹¤íŒ¨:",S),alert("ì…€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},[t,s.admin.excelPasteSettings,a,h,g]),m=j.useCallback(async()=>{const n=o.filter(f=>f.groupId&&f.groupId.startsWith("excel-input-"));if(n.length===0){alert("ì‚­ì œí•  ì—‘ì…€ ì…€ì´ ì—†ìŠµë‹ˆë‹¤.");return}const r=new Set(n.map(f=>f.groupId)).size,d=`${r}ê°œì˜ ì—‘ì…€ ê·¸ë£¹ (ì´ ${n.length}ê°œ ì…€)ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`;if(confirm(d))try{for(const f of n)await c(f.id);alert(`${r}ê°œ ê·¸ë£¹ (${n.length}ê°œ ì…€)ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`)}catch(f){console.error("ì—‘ì…€ ì…€ ì‚­ì œ ì‹¤íŒ¨:",f),alert("ì…€ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}},[o,c]);return j.useEffect(()=>{l&&t.trim()?X(t,!0):X("",!1)},[l,t,s.admin.excelPasteSettings]),{dataDimensions:N,handleCreateExcelCells:p,handleDeleteExcelCellGroups:m}},ut=()=>{var Q,ee,te,se,le,ae,ne,oe,re,ie,ce,de;const{textObjects:t,imageObjects:l,drawObjects:s,floorImage:o,addTextObject:a,addImageObject:c,updateTextObject:h,updateImageObject:g,setFloorImage:N,deleteTextObject:p,deleteImageObject:m,settings:n,updateSettings:r,initializeFirebaseListeners:d,isLoading:f}=_(),{currentTool:I,setCurrentTool:E,selectedObjectId:x,setSelectedObjectId:C}=K(),{isSettingsExpanded:i,isExcelPasteExpanded:y,isDataManagementExpanded:$,excelPasteData:A,showPreview:T,colorMode:z,updateTimerRef:M,setExcelPasteData:L,setShowPreview:S,setColorMode:B,toggleSettings:O,toggleExcelPaste:Z,toggleDataManagement:fe,clearUpdateTimer:Y}=ct(),P={admin:{autoToolSwitch:((Q=n==null?void 0:n.admin)==null?void 0:Q.autoToolSwitch)??!0,gridVisible:((ee=n==null?void 0:n.admin)==null?void 0:ee.gridVisible)??!0,gridSize:((te=n==null?void 0:n.admin)==null?void 0:te.gridSize)??32,gridSnapEnabled:((se=n==null?void 0:n.admin)==null?void 0:se.gridSnapEnabled)??!1,defaultFontSize:((le=n==null?void 0:n.admin)==null?void 0:le.defaultFontSize)??16,defaultBoxWidth:((ae=n==null?void 0:n.admin)==null?void 0:ae.defaultBoxWidth)??200,defaultBoxHeight:((ne=n==null?void 0:n.admin)==null?void 0:ne.defaultBoxHeight)??60,objectCreationPosition:((oe=n==null?void 0:n.admin)==null?void 0:oe.objectCreationPosition)??{x:260,y:950},defaultCheckboxSettings:((re=n==null?void 0:n.admin)==null?void 0:re.defaultCheckboxSettings)??{checkedColor:"#22c55e",uncheckedColor:"#f3f4f6",checkedBackgroundColor:"#ffffff",uncheckedBackgroundColor:"#ffffff",checkedBackgroundOpacity:1,uncheckedBackgroundOpacity:1},excelPasteSettings:((ie=n==null?void 0:n.admin)==null?void 0:ie.excelPasteSettings)??{startPosition:{x:100,y:100},cellWidth:120,cellHeight:40,fontSize:14,fontColor:"#000000",backgroundColor:"transparent",maxRows:50,maxCols:50}},view:{virtualKeyboardEnabled:((ce=n==null?void 0:n.view)==null?void 0:ce.virtualKeyboardEnabled)??!0,touchMode:((de=n==null?void 0:n.view)==null?void 0:de.touchMode)??!0}},F=x?t.find(b=>b.id===x)||l.find(b=>b.id===x):null,q=j.useCallback((b,u)=>{M.current&&clearTimeout(M.current),M.current=setTimeout(()=>{h(b,u)},300)},[h]),je=j.useCallback((b,u)=>{M.current&&clearTimeout(M.current),M.current=setTimeout(()=>{g(b,u)},300)},[g]),ye=j.useCallback(async b=>{if(F&&"text"in F){const u=F.textStyle||{color:"#000000",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"};await h(F.id,{textStyle:{...u,...b}})}},[F,h]),we=j.useCallback(async b=>{if(F&&"text"in F){const u=F.boxStyle||{backgroundColor:"transparent",backgroundOpacity:1,borderColor:"#000000",borderWidth:0,borderRadius:0};await h(F.id,{boxStyle:{...u,...b}})}},[F,h]),{handleColorSelect:ve}=dt({selectedObject:F,colorMode:z,updateTextStyle:ye,updateBoxStyle:we}),Ce=j.useCallback(async b=>await a(b),[a]),{handleCreateExcelCells:ke,handleDeleteExcelCellGroups:Ne}=bt({excelPasteData:A,showPreview:T,safeSettings:P,textObjects:t,addTextObject:Ce,deleteTextObject:p,onDataChange:L,onPreviewChange:S}),Se=ue(F,z),{getSelectedCount:Pe,clearSelection:ze}=he.getState(),Fe=Pe(),Ie=j.useCallback(async()=>{const{x:b,y:u}=P.admin.objectCreationPosition,w={x:b,y:u,width:P.admin.defaultBoxWidth,height:P.admin.defaultBoxHeight,text:"ìƒˆ í…ìŠ¤íŠ¸",fontSize:P.admin.defaultFontSize,textStyle:{color:"#000000",bold:!1,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"},boxStyle:{backgroundColor:"transparent",backgroundOpacity:1,borderColor:"#000000",borderWidth:0,borderRadius:0},permissions:{editable:!0,movable:!0,resizable:!0,deletable:!0},zIndex:Date.now(),locked:!1,visible:!0,opacity:1,hasCheckbox:!1,checkboxChecked:!1,checkboxCheckedColor:"#22c55e",checkboxUncheckedColor:"#f3f4f6",isEditing:!1,lastModified:Date.now()};try{await a(w)}catch(k){console.error("í…ìŠ¤íŠ¸ ê°ì²´ ìƒì„± ì‹¤íŒ¨:",k)}},[a,P]),Ee=j.useCallback(async()=>{const{x:b,y:u}=P.admin.objectCreationPosition,{checkedColor:w,uncheckedColor:k,checkedBackgroundColor:v,uncheckedBackgroundColor:J,checkedBackgroundOpacity:V,uncheckedBackgroundOpacity:G}=P.admin.defaultCheckboxSettings,U={x:b,y:u,width:P.admin.defaultBoxWidth,height:P.admin.defaultBoxHeight,text:"ìƒˆ ì²´í¬ë°•ìŠ¤",fontSize:P.admin.defaultFontSize,textStyle:{color:"#000000",bold:!0,italic:!1,horizontalAlign:"left",verticalAlign:"middle",fontFamily:"Arial"},boxStyle:{backgroundColor:"transparent",backgroundOpacity:1,borderColor:"#000000",borderWidth:1,borderRadius:8},permissions:{editable:!0,movable:!0,resizable:!0,deletable:!0},zIndex:Date.now(),locked:!1,visible:!0,opacity:1,hasCheckbox:!0,checkboxChecked:!1,checkboxCheckedColor:w,checkboxUncheckedColor:k,checkedBackgroundColor:v,uncheckedBackgroundColor:J,checkedBackgroundOpacity:V,uncheckedBackgroundOpacity:G,isEditing:!1,lastModified:Date.now()};try{await a(U)}catch(He){console.error("ì²´í¬ë°•ìŠ¤ ê°ì²´ ìƒì„± ì‹¤íŒ¨:",He)}},[a,P]),Te=j.useCallback(async()=>{try{const b=await ht("image/*");if(!b)return;const u=await xe(b),{width:w,height:k}=await xt(u),{width:v,height:J}=mt(w,k,200),{x:V,y:G}=P.admin.objectCreationPosition,U={x:V,y:G,width:v,height:J,src:u,permissions:{editable:!0,movable:!0,resizable:!0,deletable:!0},zIndex:Date.now(),locked:!1,visible:!0,opacity:1,maintainAspectRatio:!0,lastModified:Date.now()};await c(U)}catch(b){console.error("ì´ë¯¸ì§€ ê°ì²´ ìƒì„± ì‹¤íŒ¨:",b)}},[c,P]),Ae=j.useCallback(async()=>{if(!x)return;const b=_e(t,l);if(t.find(k=>k.id===x)){await h(x,{zIndex:b+1});return}l.find(k=>k.id===x)&&await g(x,{zIndex:b+1})},[x,t,l,h,g]),Me=j.useCallback(async()=>{if(!x)return;const b=[...t,...l].find(v=>v.id===x);if(!b)return;const u=Ye(b.zIndex||0,t,l);if(u===null)return;if(t.find(v=>v.id===x)){await h(x,{zIndex:u+1});return}l.find(v=>v.id===x)&&await g(x,{zIndex:u+1})},[x,t,l,h,g]),Be=j.useCallback(async()=>{if(!x)return;const b=[...t,...l].find(v=>v.id===x);if(!b)return;const u=qe(b.zIndex||0,t,l);if(u===null)return;if(t.find(v=>v.id===x)){await h(x,{zIndex:u-1});return}l.find(v=>v.id===x)&&await g(x,{zIndex:u-1})},[x,t,l,h,g]),De=j.useCallback(async()=>{if(!x)return;const b=Ke(t,l),u=Math.max(1,b-1);if(t.find(v=>v.id===x)){await h(x,{zIndex:u});return}l.find(v=>v.id===x)&&await g(x,{zIndex:u})},[x,t,l,h,g]),We=j.useCallback(async()=>{if(!x)return;const b=t.find(w=>w.id===x);if(b){const w={...b,x:b.x+20,y:b.y+20,isEditing:!1};delete w.id,await a(w);return}const u=l.find(w=>w.id===x);if(u){const w={...u,x:u.x+20,y:u.y+20};delete w.id,await c(w)}},[x,t,l,a,c]),Re=j.useCallback(async()=>{var w,k;if(!x)return;const b=t.find(v=>v.id===x);if(b&&((w=b.permissions)!=null&&w.deletable)){await p(x),C(null);return}const u=l.find(v=>v.id===x);u&&((k=u.permissions)!=null&&k.deletable)&&(await m(x),C(null))},[x,t,l,p,m,C]),$e=j.useCallback(async b=>{var w;const u=(w=b.target.files)==null?void 0:w[0];if(u)try{const k=await xe(u);await N({path:k})}catch(k){console.error("ë°°ê²½ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹¤íŒ¨:",k)}},[N]),Le=j.useCallback(()=>{S(!T);const b=new CustomEvent("excel-preview-update",{detail:{data:A,show:!T}});window.dispatchEvent(b)},[T,A,S]);return j.useEffect(()=>()=>{Y()},[Y]),f||!n?e.jsx("div",{className:"w-64 h-full bg-white border-r border-gray-200 p-4 flex items-center justify-center",children:e.jsx("div",{className:"text-gray-500",children:"ì„¤ì • ë¡œë“œ ì¤‘..."})}):e.jsxs("div",{className:"h-full flex flex-col overflow-hidden bg-gradient-to-b from-slate-50 to-slate-100",onClick:b=>{b.stopPropagation();const u=b.target;if(!Qe(u)){const w=document.activeElement;w&&et(w)&&w.blur()}},children:[e.jsx("div",{className:"p-4 border-b border-slate-200 bg-gradient-to-r from-pink-200 to-purple-200",children:e.jsxs("h1",{className:"text-lg font-bold text-gray-700 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ› ï¸"}),"ê´€ë¦¬ìž ë„êµ¬"]})}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(tt,{currentTool:I,onToolSelect:E,onCreateText:Ie,onCreateCheckbox:Ee,onCreateImage:Te}),e.jsx(st,{isExpanded:y,onToggle:Z,excelPasteData:A,showPreview:T,safeSettings:P,onDataChange:L,onPreviewToggle:Le,onCreateCells:ke,onDeleteCellGroups:Ne,updateSettings:r}),F&&!Xe(F)&&Fe===0&&e.jsx(nt,{selectedObject:F,colorMode:z,onColorModeChange:B,onColorSelect:ve,onUpdateTextObject:q,onUpdateImageObject:je,onDuplicate:We,onDelete:Re,onBringToFront:Ae,onBringForward:Me,onSendBackward:Be,onSendToBack:De,getCurrentColor:()=>Se}),e.jsx(ot,{textObjects:t,colorMode:z,onColorModeChange:B,onUpdateTextObject:q,clearCellSelection:ze}),e.jsx(rt,{isExpanded:$,onToggle:fe,textObjects:t,imageObjects:l,drawObjects:s,floorImage:o,settings:n,initializeFirebaseListeners:d}),e.jsx(it,{isExpanded:i,onToggle:O,safeSettings:P,updateSettings:r,onImageUpload:$e})]})})]})},pe=Oe.memo(()=>{const{zoom:t,setZoom:l,fitToWindow:s}=K(),o=j.useCallback(()=>{l(Math.min(t*1.2,5))},[t,l]),a=j.useCallback(()=>{l(Math.max(t/1.2,.05))},[t,l]),c=j.useCallback(()=>{s()},[s]),h=j.useCallback(()=>{l(1)},[l]);return e.jsxs("div",{className:"fixed bottom-4 right-4 flex flex-col gap-2 z-50",children:[e.jsx("button",{onClick:o,className:"w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:shadow-lg transition-shadow flex items-center justify-center text-lg font-semibold",title:"í™•ëŒ€ (Ctrl + íœ  ìœ„ ë˜ëŠ” Ctrl + +)",children:"+"}),e.jsx("button",{onClick:a,className:"w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:shadow-lg transition-shadow flex items-center justify-center text-lg font-semibold",title:"ì¶•ì†Œ (Ctrl + íœ  ì•„ëž˜ ë˜ëŠ” Ctrl + -)",children:"-"}),e.jsx("button",{onClick:h,className:"w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:shadow-lg transition-shadow flex items-center justify-center text-xs font-semibold",title:"100% í¬ê¸°",children:"1:1"}),e.jsx("button",{onClick:c,className:"w-10 h-10 bg-white border border-gray-300 rounded-lg shadow-md hover:shadow-lg transition-shadow flex items-center justify-center text-xs font-semibold",title:"ì°½ë§žì¶¤",children:"âŒ‚"})]})});pe.displayName="ZoomControls";const gt=()=>{const{currentTool:t}=K(),{penColor:l,penWidth:s,usePerfectFreehand:o,defaultColors:a,setPenColor:c,setPenWidth:h,setUsePerfectFreehand:g}=Ze();if(t!=="pen"&&t!=="eraser")return null;const N=[2,4,6,8,12];return e.jsx("div",{className:"absolute left-4 top-20 bg-white border border-gray-300 rounded-lg shadow-lg p-4 z-50",style:{minWidth:"280px"},children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:t==="pen"?"í•„ê¸° ì„¤ì •":"ì§€ìš°ê°œ ì„¤ì •"}),t==="pen"&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"ìƒ‰ìƒ"}),e.jsx("div",{className:"grid grid-cols-5 gap-1",children:a.map((p,m)=>e.jsx("button",{className:`w-8 h-8 rounded border-2 ${l===p?"border-blue-500 border-4":"border-gray-300"}`,style:{backgroundColor:p},onClick:()=>c(p),title:p},m))})]}),t==="pen"&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"êµµê¸°"}),e.jsx("div",{className:"flex gap-2",children:N.map(p=>e.jsxs("button",{className:`px-3 py-2 rounded text-xs ${s===p?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,onClick:()=>h(p),children:[p,"px"]},p))})]}),t==="pen"&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"ë Œë”ë§ í’ˆì§ˆ"}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:p=>g(p.target.checked),className:"rounded"}),e.jsx("span",{className:"text-xs text-gray-700",children:"ê³ í’ˆì§ˆ ë Œë”ë§ (Perfect Freehand)"})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:o?"âœ¨ ì••ë ¥ ê°ì§€ ë° ë¶€ë“œëŸ¬ìš´ ê³¡ì„  í™œì„±í™”":"ðŸ“ ê¸°ë³¸ ì„  ë Œë”ë§ (ë¹ ë¥¸ ì„±ëŠ¥)"})]})]})})},jt=()=>{const{initializeFirebaseListeners:t}=_();return j.useEffect(()=>((async()=>{await Ve(),t()})(),()=>{const{cleanupFirebaseListeners:s}=_.getState();s()}),[t]),e.jsxs("div",{className:"w-screen h-screen overflow-hidden flex",children:[e.jsx("div",{className:"w-72 h-full bg-slate-100/95 backdrop-blur-sm shadow-xl border-r border-slate-200",children:e.jsx(ut,{})}),e.jsxs("main",{className:"flex-1 h-full relative",children:[e.jsx(Je,{isViewPage:!1}),e.jsx(gt,{})]}),e.jsx(pe,{})]})};export{jt as default};
