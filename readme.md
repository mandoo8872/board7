## 📄 Board7 기획서

### 🎯 프로젝트 개요

* IR 기반 키오스크 및 관리자용 공유 보드 시스템
* 필기, 객체 삽입, 상태 확인, 역할 기반 접근 권한 포함
* Firebase 연동 및 로컬 백업/복원 구조

---

### 🧱 기본 구조

#### 📁 객체 레이어 구조

* `BaseLayer`: 사각형, 텍스트, 이미지, 체크박스 등 상호작용 객체
* `DrawLayer`: 자유 필기 (IR 펜 기반 stroke 객체)
* `FixedGridLayer`: 고정셀 텍스트 표현용 테이블 (엑셀 텍스트 입력에 의해 구성)

#### 🎨 배경 이미지

* 기본 고정 이미지: `floor.png`
* 모든 보드에 동일한 배경 이미지 사용
* 툴바에서 이미지 업로드 버튼을 통해 배경 이미지 변경 가능
* 사용자 정의 배경 설정은 관리자에게만 허용

---

### 🧩 객체 유형 및 속성

#### 📌 공통 속성 (모든 Base 객체)

* `id`: 고유 식별자
* `type`: 객체 타입 (`box`, `text`, `image`, `checkbox-text`, `grid-cell` 등)
* `x`, `y`, `width`, `height`
* `zIndex`: 레이어 순서
* `locked`: 이동 금지 여부
* `resizable`: 크기 조절 가능 여부
* `deletable`: 삭제 가능 여부
* `selected`: 선택 여부 (뷰어는 항상 false)
* `updatedAt`, `updatedBy`: 변경 이력 (선택적 구현)

#### 🔹 텍스트 객체 (`text`)

* `text`: 문자열
* `fontSize`, `textAlign`
* `textColor`, `textOpacity`
* `backgroundColor`, `backgroundOpacity` (텍스트와 배경 분리 적용)

#### 🔸 체크박스 텍스트 객체 (`checkbox-text`)

* `checked`: true/false (상태 변경시 즉시 Firebase 반영)
* 체크시: 배경색 붉은색, 투명도 50%
* 체크 UI는 텍스트 앞쪽 40x40px 고정
* 인라인에서 클릭 시 체크/해제 및 전체 객체 선택 모두 지원
* ✅ ViewPage에서도 해당 객체는 `selected = false` 상태 유지 → 체크만 가능
* ✅ 체크 UI는 별도 이벤트(`onPointerDown`, `onClick`)로 캡처되어야 하며, 다른 객체 선택과 충돌 없이 동작해야 함
* ✅ 터치/IR 환경에서도 인라인 체크/해제가 가능하도록 `touchstart`, `pointerdown` 등 이벤트 사용
* ✅ 체크 후에는 `/objects/{id}/checked` 경로로만 최소 Firebase 갱신 처리

#### 🖼 이미지 객체 (`image`)

* `src`: URL 또는 base64
* 드래그 삽입, Ctrl+V 붙여넣기 가능

#### ▫️ 사각형 객체 (`box`)

* 단순 시각화 용도 (배경색, 투명도 조절)

#### 🧾 고정셀 객체 (`grid-cell`)

* 엑셀 텍스트 입력으로 생성되는 셀형 텍스트 객체
* `text`, `row`, `col`, `rowSpan`, `colSpan` 포함 가능
* 배경 위 위치는 캔버스 기준 절대 좌표에 맞춰 고정됨
* ✅ 인라인 편집 가능
* ✅ 객체로 간주하여 속성 패널에서 스타일 지정 가능

---

### 🧾 복사/붙여넣기

* **텍스트** 클립보드 → 텍스트 박스로 붙여넣기
* **이미지** 클립보드 → image 객체로 삽입 (같은 레이어 처리)
* **툴바 내 엑셀 입력창** → 줄바꿈 및 탭으로 구분된 텍스트를 파싱하여 `grid-cell` 객체들로 배치

  * `\n`: 행 구분, `\t`: 열 구분
  * 캔버스 내 고정 좌표에 표 형식으로 삽입

---

### 🔍 화면 확대/축소 정책

#### 📍 Admin Page

* 기본 렌더: 창에 맞춤 (비율 고정, 4K 세로 기준)
* 툴바 내 확대/축소 버튼 추가 (`+`, `-`)
* 확대 시 전체 영역 보기 위한 스크롤 자동 생성

#### 📍 View Page

* 고정 렌더: 항상 창틀에 맞춤 (4k 세로 비율 고정, 패딩/여백 없음)
* 동적 비율 적용: 캔버스 전체를 항상 화면에 맞춤
* 확대/축소 기능 없음

#### 📍 ViewCam

* 사용하지 않음
* 캔버스 자체가 4K 세로로 고정되어 전체 보기 대응됨

---

### 💾 저장/복원 정책

* **JSON 내보내기**: 수동 또는 주기적 로컬 저장 가능
* **JSON 불러오기**: 기존 DB 삭제 후 원복
* 복원 시 모달로 경고: `정말 복원하시겠습니까? 현재 화면은 삭제됩니다`

---

### ↩️ Undo/Redo 정책

* 객체 변경 기준으로 50회까지 기록
* 삭제/위치/사이즈/속성 등 모든 변화를 대상으로 함

---

### 👥 역할 및 권한 정책

#### Admin Page

* 모든 권한 허용 (생성, 수정, 삭제, 위치 변경, 속성 설정 등)

#### View Page

* 관리자 설정 객체별 권한 범위 내에서만 동작
* 이동, 삭제, 크기 변경은 각각 객체 속성에 따라 가능
* IR 터치 대응 플로팅 메뉴 제공:

  * 연필/지우개 선택
  * 색상 선택
  * 선 두께 조정
  * 플로팅 메뉴 자체 투명도 조정
  * ➕ T/T 버튼 추가 → 클릭 시 텍스트 입력창 확장 → checkbox-text 객체 생성 가능 (ViewPage 내 동적 객체 추가 전용)

---

### 🔄 연동 정책

* 모든 상호작용(이동, 수정 등)은 \*\*사용자 액션 종료 시점(drag-off 등)\*\*에만 DB 반영
* 실시간 저장은 최소화하여 트래픽 최적화

---

### 🧱 아키텍처 및 배포 전략

* Git 브랜치 분리: `main` (운영), `dev` (개발)
* Firebase 환경: `.env.production`, `.env.development` 분리
* Vercel 자동 배포는 `main`만 연결, `dev`는 로컬 테스트 전용
* 브랜치 병합 시 `npm install` 필수
